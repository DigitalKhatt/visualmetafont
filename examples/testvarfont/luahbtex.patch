Index: source/aclocal.m4
===================================================================
--- source/aclocal.m4	(revision 7398)
+++ source/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/auxdir/auxsub/aclocal.m4
===================================================================
--- source/auxdir/auxsub/aclocal.m4	(revision 7398)
+++ source/auxdir/auxsub/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -439,7 +439,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/auxdir/auxsub/configure
===================================================================
--- source/auxdir/auxsub/configure	(revision 7398)
+++ source/auxdir/auxsub/configure	(working copy)
@@ -1921,7 +1921,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/auxdir/auxsub/Makefile.in
===================================================================
--- source/auxdir/auxsub/Makefile.in	(revision 7398)
+++ source/auxdir/auxsub/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -138,8 +138,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -383,7 +381,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/configure
===================================================================
--- source/configure	(revision 7398)
+++ source/configure	(working copy)
@@ -785,22 +785,6 @@
 enable_multiplatform
 enable_cxx_runtime_hack
 enable_libtool_hack
-enable_autosp
-enable_axodraw2
-enable_devnag
-enable_lacheck
-enable_m_tx
-enable_pmx
-enable_ps2eps
-enable_t1utils
-enable_texdoctk
-enable_tpic2pdftex
-enable_vlna
-enable_xindy
-enable_xindy_rules
-enable_xindy_docs
-with_clisp_runtime
-enable_xpdfopen
 enable_web2c
 with_banner_add
 with_editor
@@ -848,81 +832,15 @@
 enable_unitermwin
 enable_web_progs
 enable_synctex
-enable_afm2pl
-enable_bibtex_x
-enable_bibtex8
-enable_bibtexu
-enable_chktex
-enable_cjkutils
-enable_detex
-enable_dtl
-enable_dvi2tty
-enable_dvidvi
-enable_dviljk
-enable_dviout_util
-enable_dvipdfm_x
-enable_dvipng
-enable_debug
-enable_timing
-with_gs
-enable_dvipos
-enable_dvipsk
-enable_dvisvgm
-enable_gregorio
-enable_gsftopk
-enable_lcdf_typetools
-enable_cfftot1
-enable_mmafm
-enable_mmpfb
-enable_otfinfo
-enable_otftotfm
-enable_t1dotlessj
-enable_t1lint
-enable_t1rawafm
-enable_t1reencode
-enable_t1testpage
-enable_ttftotype42
-enable_updmap
-enable_makeindexk
-enable_makejvf
-enable_mendexk
-enable_musixtnt
-enable_ps2pk
-enable_psutils
-enable_seetexk
-enable_tex4htk
-enable_ttf2pk2
-enable_ttfdump
-enable_upmendex
-enable_xdvik
-with_xdvi_x_toolkit
 enable_texlive
 enable_linked_scripts
 with_system_harfbuzz
-with_system_icu
-with_system_teckit
 with_system_graphite2
 with_system_zziplib
-with_system_mpfr
-with_mpfr_includes
-with_mpfr_libdir
-with_system_gmp
-with_gmp_includes
-with_gmp_libdir
-with_system_cairo
-with_system_pixman
-with_system_gd
-with_gd_includes
-with_gd_libdir
-with_system_freetype2
 with_system_libpng
-with_system_libpaper
-with_libpaper_includes
-with_libpaper_libdir
 with_system_zlib
 with_zlib_includes
 with_zlib_libdir
-with_system_ptexenc
 with_system_kpathsea
 enable_mktexmf_default
 enable_mktexpk_default
@@ -1593,21 +1511,6 @@
                           lib/PLATFORM
   --enable-cxx-runtime-hack  link C++ runtime statically
   --enable-libtool-hack   ignore libtool dependency_libs
-  --disable-autosp        do not build the autosp package
-  --disable-axodraw2      do not build the axodraw2 package
-  --disable-devnag        do not build the devnag package
-  --disable-lacheck       do not build the lacheck package
-  --disable-m-tx          do not build the m-tx package
-  --disable-pmx           do not build the pmx package
-  --disable-ps2eps        do not build the ps2eps package
-  --disable-t1utils       do not build the t1utils package
-  --disable-texdoctk      do not build the texdoctk package
-  --disable-tpic2pdftex   do not build the tpic2pdftex package
-  --disable-vlna          do not build the vlna package
-  --enable-xindy          build the xindy package
-  --enable-xindy-rules      build and install make-rules package
-  --enable-xindy-docs       build and install documentation
-  --disable-xpdfopen      do not build the xpdfopen package
   --disable-web2c         do not build the web2c (TeX & Co.) package
   --enable-auto-core        cause TeX&MF to dump core, given a certain
                             filename
@@ -1655,57 +1558,6 @@
   --enable-unitermwin         include Uniterm window support
   --disable-web-progs       do not build WEB programs bibtex ... weave
   --disable-synctex         do not build the SyncTeX library and tool
-  --disable-afm2pl        do not build the afm2pl package
-  --disable-bibtex-x      do not build the bibtex-x package
-  --disable-bibtex8         do not build the bibtex8 program
-  --disable-bibtexu         do not build the bibtexu program
-  --disable-chktex        do not build the chktex package
-  --disable-cjkutils      do not build the cjkutils package
-  --disable-detex         do not build the detex package
-  --disable-dtl           do not build the dtl package
-  --disable-dvi2tty       do not build the dvi2tty package
-  --disable-dvidvi        do not build the dvidvi package
-  --disable-dviljk        do not build the dviljk package
-  --disable-dviout-util   do not build the dviout-util package
-  --disable-dvipdfm-x     do not build the dvipdfm-x package
-  --disable-dvipng        do not build the dvipng package
-  --disable-debug           Compile without debug (-d) option
-  --enable-timing           Output execution time of dvipng
-  --disable-dvipos        do not build the dvipos package
-  --disable-dvipsk        do not build the dvipsk package
-  --disable-dvisvgm       do not build the dvisvgm package
-  --disable-gregorio      do not build the gregorio package
-  --disable-gsftopk       do not build the gsftopk package
-  --disable-lcdf-typetools
-                          do not build the lcdf-typetools package
-  --disable-cfftot1         do not build the cfftot1 program
-  --disable-mmafm           do not build the mmafm program
-  --disable-mmpfb           do not build the mmpfb program
-  --disable-otfinfo         do not build the otfinfo program
-  --disable-otftotfm        do not build the otftotfm program
-  --disable-t1dotlessj      do not build the t1dotlessj program
-  --disable-t1lint          do not build the t1lint program
-  --disable-t1rawafm        do not build the t1rawafm program
-  --disable-t1reencode      do not build the t1reencode program
-  --disable-t1testpage      do not build the t1testpage program
-  --disable-ttftotype42     do not build the ttftotype42 program
-  --disable-auto-cfftot1    disable running cfftot1 from otftotfm
-  --disable-auto-t1dotlessj disable running t1dotlessj from otftotfm
-  --disable-auto-ttftotype42
-                            disable running ttftotype42 from otftotfm
-  --disable-auto-updmap     disable running updmap from otftotfm
-  --disable-makeindexk    do not build the makeindexk package
-  --disable-makejvf       do not build the makejvf package
-  --disable-mendexk       do not build the mendexk package
-  --disable-musixtnt      do not build the musixtnt package
-  --disable-ps2pk         do not build the ps2pk package
-  --disable-psutils       do not build the psutils package
-  --disable-seetexk       do not build the seetexk package
-  --disable-tex4htk       do not build the tex4htk package
-  --disable-ttf2pk2       do not build the ttf2pk2 package
-  --disable-ttfdump       do not build the ttfdump package
-  --disable-upmendex      do not build the upmendex package
-  --disable-xdvik         do not build the xdvik package
   --disable-texlive       do not build the texlive (TeX Live scripts) package
   --disable-linked-scripts  do not install the linked scripts
   --disable-mktexmf-default   do not run mktexmf if MF source missing
@@ -1737,57 +1589,22 @@
 Optional Packages:
   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
   --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
-  --with-clisp-runtime=PATH
-                          pathname of clisp runtime to install for `xindy',
-                          `default' to derive from clisp, or `system' to use
-                          installed version
   --with-banner-add=STR   add STR to version string appended to banner lines
   --with-editor=CMD       invoke CMD from the `e' option [vi +%d '%s'] or
                           [texworks --position=%d "%s"]
   --with-mf-x-toolkit     use X toolkit for METAFONT
-  --with-gs=/PATH/TO/gs   Hard-wire the location of GhostScript
-  --with-xdvi-x-toolkit=KIT
-                          Use toolkit KIT (xaw/motif/xaw3d/neXtaw) for xdvi
-                          [default: Xaw]
   --with-system-harfbuzz  use installed harfbuzz headers and library (requires
                           pkg-config)
-  --with-system-icu       use installed ICU headers and libraries (requires
-                          pkg-config or icu-config)
-  --with-system-teckit    use installed teckit headers and library (requires
-                          pkg-config)
   --with-system-graphite2 use installed graphite2 headers and library
                           (requires pkg-config)
   --with-system-zziplib   use installed zziplib headers and library (requires
                           pkg-config)
-  --with-system-mpfr      use installed mpfr headers and library
-  --with-mpfr-includes=DIR
-                          mpfr headers installed in DIR
-  --with-mpfr-libdir=DIR  mpfr library installed in DIR
-  --with-system-gmp       use installed gmp headers and library
-  --with-gmp-includes=DIR gmp headers installed in DIR
-  --with-gmp-libdir=DIR   gmp library installed in DIR
-  --with-system-cairo     use installed cairo headers and library (requires
-                          pkg-config)
-  --with-system-pixman    use installed pixman headers and library (requires
-                          pkg-config)
-  --with-system-gd        use installed gd headers and library
-  --with-gd-includes=DIR  gd headers installed in DIR
-  --with-gd-libdir=DIR    gd library installed in DIR
-  --with-system-freetype2 use installed freetype2 headers and library
-                          (requires freetype-config)
   --with-system-libpng    use installed libpng headers and library (requires
                           pkg-config)
-  --with-system-libpaper  use installed libpaper headers and library
-  --with-libpaper-includes=DIR
-                          libpaper headers installed in DIR
-  --with-libpaper-libdir=DIR
-                          libpaper library installed in DIR
   --with-system-zlib      use installed zlib headers and library
   --with-zlib-includes=DIR
                           zlib headers installed in DIR
   --with-zlib-libdir=DIR  zlib library installed in DIR
-  --with-system-ptexenc   use installed ptexenc headers and library (requires
-                          pkg-config)
   --with-system-kpathsea  use installed kpathsea headers and library (requires
                           pkg-config)
   --with-pic[=PKGS]       try to use only PIC/non-PIC objects [default=use
@@ -4199,294 +4016,7 @@
 esac ;;
 esac
 
-## utils/autosp/ac/withenable.ac: configure.ac fragment for Tl subdir
-## configure options and TL libraries required for autosp.
-# Check whether --enable-autosp was given.
-if test "${enable_autosp+set}" = set; then :
-  enableval=$enable_autosp;
-fi
-case $enable_autosp in #(
-  yes|no) :
-     ;; #(
-  *) :
 
-   enable_autosp=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-autosp=$enable_autosp'" >&5
-$as_echo "$as_me: Assuming \`--enable-autosp=$enable_autosp'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-autosp=$enable_autosp'"
-    ;;
-esac
-
-## utils/axodraw2/ac/withenable.ac: configure.ac fragment for TL subdir
-## configure options and TL libraries for axodraw2.
-# Check whether --enable-axodraw2 was given.
-if test "${enable_axodraw2+set}" = set; then :
-  enableval=$enable_axodraw2;
-fi
-case $enable_axodraw2 in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_axodraw2=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-axodraw2=$enable_axodraw2'" >&5
-$as_echo "$as_me: Assuming \`--enable-axodraw2=$enable_axodraw2'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-axodraw2=$enable_axodraw2'"
-    ;;
-esac
-
-## utils/devnag/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/devnag/
-## configure options and TL libraries required for devnag
-# Check whether --enable-devnag was given.
-if test "${enable_devnag+set}" = set; then :
-  enableval=$enable_devnag;
-fi
-case $enable_devnag in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_devnag=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-devnag=$enable_devnag'" >&5
-$as_echo "$as_me: Assuming \`--enable-devnag=$enable_devnag'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-devnag=$enable_devnag'"
-    ;;
-esac
-
-## utils/lacheck/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/lacheck/
-## configure options and TL libraries required for lacheck
-# Check whether --enable-lacheck was given.
-if test "${enable_lacheck+set}" = set; then :
-  enableval=$enable_lacheck;
-fi
-case $enable_lacheck in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_lacheck=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-lacheck=$enable_lacheck'" >&5
-$as_echo "$as_me: Assuming \`--enable-lacheck=$enable_lacheck'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-lacheck=$enable_lacheck'"
-    ;;
-esac
-
-## utils/m-tx/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/m-tx/
-## configure options and TL libraries required for mtx
-# Check whether --enable-m-tx was given.
-if test "${enable_m_tx+set}" = set; then :
-  enableval=$enable_m_tx;
-fi
-case $enable_m_tx in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_m_tx=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-m-tx=$enable_m_tx'" >&5
-$as_echo "$as_me: Assuming \`--enable-m-tx=$enable_m_tx'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-m-tx=$enable_m_tx'"
-    ;;
-esac
-
-## utils/pmx/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/pmx/
-## configure options and TL libraries required for pmx
-# Check whether --enable-pmx was given.
-if test "${enable_pmx+set}" = set; then :
-  enableval=$enable_pmx;
-fi
-case $enable_pmx in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_pmx=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-pmx=$enable_pmx'" >&5
-$as_echo "$as_me: Assuming \`--enable-pmx=$enable_pmx'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-pmx=$enable_pmx'"
-    ;;
-esac
-
-## utils/ps2eps/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/ps2eps/
-## configure options and TL libraries required for ps2eps
-# Check whether --enable-ps2eps was given.
-if test "${enable_ps2eps+set}" = set; then :
-  enableval=$enable_ps2eps;
-fi
-case $enable_ps2eps in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_ps2eps=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-ps2eps=$enable_ps2eps'" >&5
-$as_echo "$as_me: Assuming \`--enable-ps2eps=$enable_ps2eps'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-ps2eps=$enable_ps2eps'"
-    ;;
-esac
-
-## utils/t1utils/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/t1utils/
-## configure options and TL libraries required for t1utils
-# Check whether --enable-t1utils was given.
-if test "${enable_t1utils+set}" = set; then :
-  enableval=$enable_t1utils;
-fi
-case $enable_t1utils in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_t1utils=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-t1utils=$enable_t1utils'" >&5
-$as_echo "$as_me: Assuming \`--enable-t1utils=$enable_t1utils'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-t1utils=$enable_t1utils'"
-    ;;
-esac
-
-## utils/texdoctk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/texdoctk/
-## configure options and TL libraries required for texdoctk
-# Check whether --enable-texdoctk was given.
-if test "${enable_texdoctk+set}" = set; then :
-  enableval=$enable_texdoctk;
-fi
-case $enable_texdoctk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_texdoctk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-texdoctk=$enable_texdoctk'" >&5
-$as_echo "$as_me: Assuming \`--enable-texdoctk=$enable_texdoctk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-texdoctk=$enable_texdoctk'"
-    ;;
-esac
-
-## utils/tpic2pdftex/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/tpic2pdftex/
-## configure options and TL libraries required for tpic2pdftex
-# Check whether --enable-tpic2pdftex was given.
-if test "${enable_tpic2pdftex+set}" = set; then :
-  enableval=$enable_tpic2pdftex;
-fi
-case $enable_tpic2pdftex in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_tpic2pdftex=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-tpic2pdftex=$enable_tpic2pdftex'" >&5
-$as_echo "$as_me: Assuming \`--enable-tpic2pdftex=$enable_tpic2pdftex'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-tpic2pdftex=$enable_tpic2pdftex'"
-    ;;
-esac
-
-## utils/vlna/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/vlna/
-## configure options and TL libraries required for vlna
-# Check whether --enable-vlna was given.
-if test "${enable_vlna+set}" = set; then :
-  enableval=$enable_vlna;
-fi
-case $enable_vlna in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_vlna=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-vlna=$enable_vlna'" >&5
-$as_echo "$as_me: Assuming \`--enable-vlna=$enable_vlna'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-vlna=$enable_vlna'"
-    ;;
-esac
-
-## utils/xindy/ac/withenable.ac: configure.ac fragment for TL subdir
-## configure options and TL libraries required for xindy.
-# Check whether --enable-xindy was given.
-if test "${enable_xindy+set}" = set; then :
-  enableval=$enable_xindy;
-fi
-case $enable_xindy in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_xindy=no
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-xindy=$enable_xindy'" >&5
-$as_echo "$as_me: Assuming \`--enable-xindy=$enable_xindy'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-xindy=$enable_xindy'"
-    ;;
-esac
-
-## utils/xindy/ac/xindy.ac: configure.ac fragment for the TeX Live subdirectory utils/xindy/
-## configure options for xindy
-# Check whether --enable-xindy-rules was given.
-if test "${enable_xindy_rules+set}" = set; then :
-  enableval=$enable_xindy_rules;
-fi
-# Check whether --enable-xindy-docs was given.
-if test "${enable_xindy_docs+set}" = set; then :
-  enableval=$enable_xindy_docs;
-fi
-
-# Check whether --with-clisp-runtime was given.
-if test "${with_clisp_runtime+set}" = set; then :
-  withval=$with_clisp_runtime;
-fi
-
-## utils/xindy/ac/clisp.ac: configure.ac fragment for the TeX Live subdirectory utils/xindy/
-## configure checks for xindy and clisp
-case $with_clisp_runtime in #(
-  default) :
-     ;; #(
-  system) :
-    if test "x$enable_native_texlive_build" = xyes; then :
-  as_fn_error $? "you can not use the installed clisp for a native TeX Live build" "$LINENO" 5
-fi ;; #(
-  "") :
-    if test "x$enable_native_texlive_build" = xyes; then :
-  with_clisp_runtime=default
-else
-  with_clisp_runtime=system
-fi
-               { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--with-clisp-runtime=$with_clisp_runtime'" >&5
-$as_echo "$as_me: Assuming \`--with-clisp-runtime=$with_clisp_runtime'" >&6;}
-               ac_configure_args="$ac_configure_args '--with-clisp-runtime=$with_clisp_runtime'" ;; #(
-  *) :
-    if test ! -f "$with_clisp_runtime"; then :
-  as_fn_error $? "no such file: \"$with_clisp_runtime\"" "$LINENO" 5
-fi ;;
-esac
-
-## utils/xpdfopen/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory utils/xpdfopen/
-## configure options and TL libraries required for xpdfopen
-# Check whether --enable-xpdfopen was given.
-if test "${enable_xpdfopen+set}" = set; then :
-  enableval=$enable_xpdfopen;
-fi
-if test "x$with_x" = xno; then :
-  case $enable_xpdfopen in #(
-  "") :
-    { $as_echo "$as_me:${as_lineno-$LINENO}: \`--without-x' -> \`--disable-xpdfopen'" >&5
-$as_echo "$as_me: \`--without-x' -> \`--disable-xpdfopen'" >&6;}
-                      enable_xpdfopen=no
-                      ac_configure_args="$ac_configure_args '--disable-xpdfopen'" ;; #(
-  yes) :
-    as_fn_error $? "Sorry, incompatible options \`--without-x' and \`--enable-xpdfopen'" "$LINENO" 5 ;; #(
-  *) :
-     ;;
-esac
-fi
-case $enable_xpdfopen in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_xpdfopen=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-xpdfopen=$enable_xpdfopen'" >&5
-$as_echo "$as_me: Assuming \`--enable-xpdfopen=$enable_xpdfopen'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-xpdfopen=$enable_xpdfopen'"
-    ;;
-esac
-
-
 ## texk/web2c/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/web2c/
 ## configure options and TL libraries required for web2c
 # Check whether --enable-web2c was given.
@@ -4944,809 +4474,6 @@
 fi
 
 
-## texk/afm2pl/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/afm2pl/
-## configure options and TL libraries required for afm2pl
-# Check whether --enable-afm2pl was given.
-if test "${enable_afm2pl+set}" = set; then :
-  enableval=$enable_afm2pl;
-fi
-case $enable_afm2pl in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_afm2pl=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-afm2pl=$enable_afm2pl'" >&5
-$as_echo "$as_me: Assuming \`--enable-afm2pl=$enable_afm2pl'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-afm2pl=$enable_afm2pl'"
-    ;;
-esac
-
-test "x$enable_afm2pl" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/bibtex-x/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/bibtex-x/
-## configure options and TL libraries required for bibtex-x
-# Check whether --enable-bibtex-x was given.
-if test "${enable_bibtex_x+set}" = set; then :
-  enableval=$enable_bibtex_x;
-fi
-case $enable_bibtex_x in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_bibtex_x=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-bibtex-x=$enable_bibtex_x'" >&5
-$as_echo "$as_me: Assuming \`--enable-bibtex-x=$enable_bibtex_x'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-bibtex-x=$enable_bibtex_x'"
-    ;;
-esac
-
-test "x$enable_bibtex_x" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/bibtex-x/ac/bibtex-x.ac: configure.ac fragment for the TeX Live subdirectory texk/bibtex-x/
-## configure options for bibtex-x
-# Check whether --enable-bibtex8 was given.
-if test "${enable_bibtex8+set}" = set; then :
-  enableval=$enable_bibtex8;
-fi
-
-case $enable_bibtex8 in #(
-  yes | no) :
-     ;; #(
-  *) :
-    enable_bibtex8=yes ;;
-esac
-# Check whether --enable-bibtexu was given.
-if test "${enable_bibtexu+set}" = set; then :
-  enableval=$enable_bibtexu;
-fi
-
-case $enable_bibtexu in #(
-  yes | no) :
-     ;; #(
-  *) :
-    enable_bibtexu=yes ;;
-esac
-
-test "x$enable_bibtex_x:$enable_bibtexu" = xyes:yes && need_icu=yes
-
-## texk/chktex/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/chktex/
-## configure options and TL libraries required for chktex
-# Check whether --enable-chktex was given.
-if test "${enable_chktex+set}" = set; then :
-  enableval=$enable_chktex;
-fi
-case $enable_chktex in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_chktex=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-chktex=$enable_chktex'" >&5
-$as_echo "$as_me: Assuming \`--enable-chktex=$enable_chktex'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-chktex=$enable_chktex'"
-    ;;
-esac
-
-test "x$enable_chktex" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/cjkutils/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/cjkutils/
-## configure options and TL libraries required for cjkutils
-# Check whether --enable-cjkutils was given.
-if test "${enable_cjkutils+set}" = set; then :
-  enableval=$enable_cjkutils;
-fi
-case $enable_cjkutils in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_cjkutils=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-cjkutils=$enable_cjkutils'" >&5
-$as_echo "$as_me: Assuming \`--enable-cjkutils=$enable_cjkutils'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-cjkutils=$enable_cjkutils'"
-    ;;
-esac
-
-test "x$enable_cjkutils" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/detex/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/detex/
-## configure options and TL libraries required for detex
-# Check whether --enable-detex was given.
-if test "${enable_detex+set}" = set; then :
-  enableval=$enable_detex;
-fi
-case $enable_detex in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_detex=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-detex=$enable_detex'" >&5
-$as_echo "$as_me: Assuming \`--enable-detex=$enable_detex'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-detex=$enable_detex'"
-    ;;
-esac
-
-test "x$enable_detex" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/dtl/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dtl/
-## configure options and TL libraries required for dtl
-# Check whether --enable-dtl was given.
-if test "${enable_dtl+set}" = set; then :
-  enableval=$enable_dtl;
-fi
-case $enable_dtl in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dtl=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dtl=$enable_dtl'" >&5
-$as_echo "$as_me: Assuming \`--enable-dtl=$enable_dtl'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dtl=$enable_dtl'"
-    ;;
-esac
-
-test "x$enable_dtl" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/dvi2tty/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dvi2tty/
-## configure options and TL libraries required for dvi2tty
-# Check whether --enable-dvi2tty was given.
-if test "${enable_dvi2tty+set}" = set; then :
-  enableval=$enable_dvi2tty;
-fi
-case $enable_dvi2tty in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dvi2tty=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dvi2tty=$enable_dvi2tty'" >&5
-$as_echo "$as_me: Assuming \`--enable-dvi2tty=$enable_dvi2tty'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dvi2tty=$enable_dvi2tty'"
-    ;;
-esac
-
-test "x$enable_dvi2tty" = xno || {
-  need_ptexenc=yes
-}
-
-## texk/dvidvi/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dvidvi/
-## configure options and TL libraries required for dvidvi
-# Check whether --enable-dvidvi was given.
-if test "${enable_dvidvi+set}" = set; then :
-  enableval=$enable_dvidvi;
-fi
-case $enable_dvidvi in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dvidvi=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dvidvi=$enable_dvidvi'" >&5
-$as_echo "$as_me: Assuming \`--enable-dvidvi=$enable_dvidvi'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dvidvi=$enable_dvidvi'"
-    ;;
-esac
-
-test "x$enable_dvidvi" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/dviljk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dviljk/
-## configure options and TL libraries required for dviljk
-# Check whether --enable-dviljk was given.
-if test "${enable_dviljk+set}" = set; then :
-  enableval=$enable_dviljk;
-fi
-case $enable_dviljk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dviljk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dviljk=$enable_dviljk'" >&5
-$as_echo "$as_me: Assuming \`--enable-dviljk=$enable_dviljk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dviljk=$enable_dviljk'"
-    ;;
-esac
-
-test "x$enable_dviljk" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/dviout-util/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dviout-util/
-## configure options and TL libraries required for dviout-util
-# Check whether --enable-dviout-util was given.
-if test "${enable_dviout_util+set}" = set; then :
-  enableval=$enable_dviout_util;
-fi
-case $enable_dviout_util in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dviout_util=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dviout-util=$enable_dviout_util'" >&5
-$as_echo "$as_me: Assuming \`--enable-dviout-util=$enable_dviout_util'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dviout-util=$enable_dviout_util'"
-    ;;
-esac
-
-test "x$enable_dviout_util" = xno || {
-  need_ptexenc=yes
-}
-
-## texk/dvipdfm-x/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dvipdfm-x/
-## configure options and TL libraries required for dvipdfm-x
-# Check whether --enable-dvipdfm-x was given.
-if test "${enable_dvipdfm_x+set}" = set; then :
-  enableval=$enable_dvipdfm_x;
-fi
-case $enable_dvipdfm_x in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dvipdfm_x=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dvipdfm-x=$enable_dvipdfm_x'" >&5
-$as_echo "$as_me: Assuming \`--enable-dvipdfm-x=$enable_dvipdfm_x'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dvipdfm-x=$enable_dvipdfm_x'"
-    ;;
-esac
-
-test "x$enable_dvipdfm_x" = xno || {
-  need_kpathsea=yes
-  need_libpng=yes
-  need_libpaper=yes
-}
-
-## texk/dvipng/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dvipng/
-## configure options and TL libraries required for dvipng
-# Check whether --enable-dvipng was given.
-if test "${enable_dvipng+set}" = set; then :
-  enableval=$enable_dvipng;
-fi
-case $enable_dvipng in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dvipng=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dvipng=$enable_dvipng'" >&5
-$as_echo "$as_me: Assuming \`--enable-dvipng=$enable_dvipng'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dvipng=$enable_dvipng'"
-    ;;
-esac
-
-test "x$enable_dvipng" = xno || {
-  need_kpathsea=yes
-  need_gd=yes
-}
-
-## texk/dvipng/ac/dvipng.ac: configure.ac fragment for the TeX Live subdirectory texk/dvipng/
-## configure options for dvipng
-# Check whether --enable-debug was given.
-if test "${enable_debug+set}" = set; then :
-  enableval=$enable_debug;
-fi
-
-# Check whether --enable-timing was given.
-if test "${enable_timing+set}" = set; then :
-  enableval=$enable_timing;
-fi
-
-
-# Check whether --with-gs was given.
-if test "${with_gs+set}" = set; then :
-  withval=$with_gs;
-fi
-
-
-## texk/dvipos/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dvipos/
-## configure options and TL libraries required for dvipos
-# Check whether --enable-dvipos was given.
-if test "${enable_dvipos+set}" = set; then :
-  enableval=$enable_dvipos;
-fi
-case $enable_dvipos in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dvipos=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dvipos=$enable_dvipos'" >&5
-$as_echo "$as_me: Assuming \`--enable-dvipos=$enable_dvipos'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dvipos=$enable_dvipos'"
-    ;;
-esac
-
-test "x$enable_dvipos" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/dvipsk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/dvipsk/
-## configure options and TL libraries required for dvipsk
-# Check whether --enable-dvipsk was given.
-if test "${enable_dvipsk+set}" = set; then :
-  enableval=$enable_dvipsk;
-fi
-case $enable_dvipsk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dvipsk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dvipsk=$enable_dvipsk'" >&5
-$as_echo "$as_me: Assuming \`--enable-dvipsk=$enable_dvipsk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dvipsk=$enable_dvipsk'"
-    ;;
-esac
-
-test "x$enable_dvipsk" = xno || {
-  need_kpathsea=yes
-}
-
-# texk/dvisvgm/ac/withenable.ac: configure.ac fragment
-## configure options and TL libraries required for dvisvgm
-# Check whether --enable-dvisvgm was given.
-if test "${enable_dvisvgm+set}" = set; then :
-  enableval=$enable_dvisvgm;
-fi
-case $enable_dvisvgm in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_dvisvgm=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-dvisvgm=$enable_dvisvgm'" >&5
-$as_echo "$as_me: Assuming \`--enable-dvisvgm=$enable_dvisvgm'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-dvisvgm=$enable_dvisvgm'"
-    ;;
-esac
-
-test "x$enable_dvisvgm" = xno || {
-  need_kpathsea=yes
-  need_potrace=yes
-  need_freetype2=yes
-  need_zlib=yes
-}
-
-## texk/gregorio/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/gregorio/
-## configure options and TL libraries required for gregorio
-# Check whether --enable-gregorio was given.
-if test "${enable_gregorio+set}" = set; then :
-  enableval=$enable_gregorio;
-fi
-case $enable_gregorio in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_gregorio=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-gregorio=$enable_gregorio'" >&5
-$as_echo "$as_me: Assuming \`--enable-gregorio=$enable_gregorio'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-gregorio=$enable_gregorio'"
-    ;;
-esac
-
-test "x$enable_gregorio" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/gsftopk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/gsftopk/
-## configure options and TL libraries required for gsftopk
-# Check whether --enable-gsftopk was given.
-if test "${enable_gsftopk+set}" = set; then :
-  enableval=$enable_gsftopk;
-fi
-case $enable_gsftopk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_gsftopk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-gsftopk=$enable_gsftopk'" >&5
-$as_echo "$as_me: Assuming \`--enable-gsftopk=$enable_gsftopk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-gsftopk=$enable_gsftopk'"
-    ;;
-esac
-
-test "x$enable_gsftopk" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/lcdf-typetools/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/lcdf-typetools/
-## configure options and TL libraries required for lcdf-typetools
-# Check whether --enable-lcdf-typetools was given.
-if test "${enable_lcdf_typetools+set}" = set; then :
-  enableval=$enable_lcdf_typetools;
-fi
-case $enable_lcdf_typetools in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_lcdf_typetools=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-lcdf-typetools=$enable_lcdf_typetools'" >&5
-$as_echo "$as_me: Assuming \`--enable-lcdf-typetools=$enable_lcdf_typetools'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-lcdf-typetools=$enable_lcdf_typetools'"
-    ;;
-esac
-
-test "x$enable_lcdf_typetools" = xno || {
-  need_kpathsea=yes
-}
-
-## Define configure options for lcdf-typetools.  Extracted from configure.ac
-## for ease of building TeX Live.
-# Check whether --enable-cfftot1 was given.
-if test "${enable_cfftot1+set}" = set; then :
-  enableval=$enable_cfftot1;
-fi
-# Check whether --enable-mmafm was given.
-if test "${enable_mmafm+set}" = set; then :
-  enableval=$enable_mmafm;
-fi
-# Check whether --enable-mmpfb was given.
-if test "${enable_mmpfb+set}" = set; then :
-  enableval=$enable_mmpfb;
-fi
-# Check whether --enable-otfinfo was given.
-if test "${enable_otfinfo+set}" = set; then :
-  enableval=$enable_otfinfo;
-fi
-# Check whether --enable-otftotfm was given.
-if test "${enable_otftotfm+set}" = set; then :
-  enableval=$enable_otftotfm;
-fi
-# Check whether --enable-t1dotlessj was given.
-if test "${enable_t1dotlessj+set}" = set; then :
-  enableval=$enable_t1dotlessj;
-fi
-# Check whether --enable-t1lint was given.
-if test "${enable_t1lint+set}" = set; then :
-  enableval=$enable_t1lint;
-fi
-# Check whether --enable-t1rawafm was given.
-if test "${enable_t1rawafm+set}" = set; then :
-  enableval=$enable_t1rawafm;
-fi
-# Check whether --enable-t1reencode was given.
-if test "${enable_t1reencode+set}" = set; then :
-  enableval=$enable_t1reencode;
-fi
-# Check whether --enable-t1testpage was given.
-if test "${enable_t1testpage+set}" = set; then :
-  enableval=$enable_t1testpage;
-fi
-# Check whether --enable-ttftotype42 was given.
-if test "${enable_ttftotype42+set}" = set; then :
-  enableval=$enable_ttftotype42;
-fi
-
-# Check whether --enable-cfftot1 was given.
-if test "${enable_cfftot1+set}" = set; then :
-  enableval=$enable_cfftot1;
-fi
-# Check whether --enable-t1dotlessj was given.
-if test "${enable_t1dotlessj+set}" = set; then :
-  enableval=$enable_t1dotlessj;
-fi
-# Check whether --enable-ttftotype42 was given.
-if test "${enable_ttftotype42+set}" = set; then :
-  enableval=$enable_ttftotype42;
-fi
-# Check whether --enable-updmap was given.
-if test "${enable_updmap+set}" = set; then :
-  enableval=$enable_updmap;
-fi
-
-
-## texk/makeindexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/makeindexk/
-## configure options and TL libraries required for makeindexk
-# Check whether --enable-makeindexk was given.
-if test "${enable_makeindexk+set}" = set; then :
-  enableval=$enable_makeindexk;
-fi
-case $enable_makeindexk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_makeindexk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-makeindexk=$enable_makeindexk'" >&5
-$as_echo "$as_me: Assuming \`--enable-makeindexk=$enable_makeindexk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-makeindexk=$enable_makeindexk'"
-    ;;
-esac
-
-test "x$enable_makeindexk" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/makejvf/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/makejvf/
-## configure options and TL libraries required for makejvf
-# Check whether --enable-makejvf was given.
-if test "${enable_makejvf+set}" = set; then :
-  enableval=$enable_makejvf;
-fi
-case $enable_makejvf in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_makejvf=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-makejvf=$enable_makejvf'" >&5
-$as_echo "$as_me: Assuming \`--enable-makejvf=$enable_makejvf'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-makejvf=$enable_makejvf'"
-    ;;
-esac
-
-test "x$enable_makejvf" = xno || {
-  need_ptexenc=yes
-}
-
-## texk/mendexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/mendexk/
-## configure options and TL libraries required for mendexk
-# Check whether --enable-mendexk was given.
-if test "${enable_mendexk+set}" = set; then :
-  enableval=$enable_mendexk;
-fi
-case $enable_mendexk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_mendexk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-mendexk=$enable_mendexk'" >&5
-$as_echo "$as_me: Assuming \`--enable-mendexk=$enable_mendexk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-mendexk=$enable_mendexk'"
-    ;;
-esac
-
-test "x$enable_mendexk" = xno || {
-  need_ptexenc=yes
-}
-
-## texk/musixtnt/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/musixtnt/
-## configure options and TL libraries required for musixtnt
-# Check whether --enable-musixtnt was given.
-if test "${enable_musixtnt+set}" = set; then :
-  enableval=$enable_musixtnt;
-fi
-case $enable_musixtnt in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_musixtnt=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-musixtnt=$enable_musixtnt'" >&5
-$as_echo "$as_me: Assuming \`--enable-musixtnt=$enable_musixtnt'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-musixtnt=$enable_musixtnt'"
-    ;;
-esac
-
-test "x$enable_musixtnt" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/ps2pk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ps2pk/
-## configure options and TL libraries required for ps2pk
-# Check whether --enable-ps2pk was given.
-if test "${enable_ps2pk+set}" = set; then :
-  enableval=$enable_ps2pk;
-fi
-case $enable_ps2pk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_ps2pk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-ps2pk=$enable_ps2pk'" >&5
-$as_echo "$as_me: Assuming \`--enable-ps2pk=$enable_ps2pk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-ps2pk=$enable_ps2pk'"
-    ;;
-esac
-
-test "x$enable_ps2pk" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/psutils/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/psutils/
-## configure options and TL libraries required for psutils
-# Check whether --enable-psutils was given.
-if test "${enable_psutils+set}" = set; then :
-  enableval=$enable_psutils;
-fi
-case $enable_psutils in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_psutils=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-psutils=$enable_psutils'" >&5
-$as_echo "$as_me: Assuming \`--enable-psutils=$enable_psutils'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-psutils=$enable_psutils'"
-    ;;
-esac
-
-test "x$enable_psutils" = xno || {
-  need_kpathsea=yes
-  need_libpaper=yes
-}
-
-## texk/seetexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/seetexk/
-## configure options and TL libraries required for seetexk
-# Check whether --enable-seetexk was given.
-if test "${enable_seetexk+set}" = set; then :
-  enableval=$enable_seetexk;
-fi
-case $enable_seetexk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_seetexk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-seetexk=$enable_seetexk'" >&5
-$as_echo "$as_me: Assuming \`--enable-seetexk=$enable_seetexk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-seetexk=$enable_seetexk'"
-    ;;
-esac
-
-test "x$enable_seetexk" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/tex4htk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/tex4htk/
-## configure options and TL libraries required for tex4htk
-# Check whether --enable-tex4htk was given.
-if test "${enable_tex4htk+set}" = set; then :
-  enableval=$enable_tex4htk;
-fi
-case $enable_tex4htk in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_tex4htk=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-tex4htk=$enable_tex4htk'" >&5
-$as_echo "$as_me: Assuming \`--enable-tex4htk=$enable_tex4htk'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-tex4htk=$enable_tex4htk'"
-    ;;
-esac
-
-test "x$enable_tex4htk" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/ttf2pk2/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ttf2pk2/
-## configure options and TL libraries required for ttf2pk
-# Check whether --enable-ttf2pk2 was given.
-if test "${enable_ttf2pk2+set}" = set; then :
-  enableval=$enable_ttf2pk2;
-fi
-case $enable_ttf2pk2 in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_ttf2pk2=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-ttf2pk2=$enable_ttf2pk2'" >&5
-$as_echo "$as_me: Assuming \`--enable-ttf2pk2=$enable_ttf2pk2'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-ttf2pk2=$enable_ttf2pk2'"
-    ;;
-esac
-
-test "x$enable_ttf2pk2" = xno || {
-  need_kpathsea=yes
-  need_freetype2=yes
-}
-
-## texk/ttfdump/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ttfdump/
-## configure options and TL libraries required for ttfdump
-# Check whether --enable-ttfdump was given.
-if test "${enable_ttfdump+set}" = set; then :
-  enableval=$enable_ttfdump;
-fi
-case $enable_ttfdump in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_ttfdump=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-ttfdump=$enable_ttfdump'" >&5
-$as_echo "$as_me: Assuming \`--enable-ttfdump=$enable_ttfdump'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-ttfdump=$enable_ttfdump'"
-    ;;
-esac
-
-test "x$enable_ttfdump" = xno || {
-  need_kpathsea=yes
-}
-
-## texk/upmendex/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/upmendex/
-## configure options and TL libraries required for upmendex
-# Check whether --enable-upmendex was given.
-if test "${enable_upmendex+set}" = set; then :
-  enableval=$enable_upmendex;
-fi
-case $enable_upmendex in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_upmendex=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-upmendex=$enable_upmendex'" >&5
-$as_echo "$as_me: Assuming \`--enable-upmendex=$enable_upmendex'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-upmendex=$enable_upmendex'"
-    ;;
-esac
-
-test "x$enable_upmendex" = xno || {
-  need_kpathsea=yes
-  need_icu=yes
-}
-
-## texk/xdvik/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/xdvik/
-## configure options and TL libraries required for xdvik
-# Check whether --enable-xdvik was given.
-if test "${enable_xdvik+set}" = set; then :
-  enableval=$enable_xdvik;
-fi
-if test "x$with_x" = xno; then :
-  case $enable_xdvik in #(
-  "") :
-    { $as_echo "$as_me:${as_lineno-$LINENO}: \`--without-x' -> \`--disable-xdvik'" >&5
-$as_echo "$as_me: \`--without-x' -> \`--disable-xdvik'" >&6;}
-                      enable_xdvik=no
-                      ac_configure_args="$ac_configure_args '--disable-xdvik'" ;; #(
-  yes) :
-    as_fn_error $? "Sorry, incompatible options \`--without-x' and \`--enable-xdvik'" "$LINENO" 5 ;; #(
-  *) :
-     ;;
-esac
-fi
-case $enable_xdvik in #(
-  yes|no) :
-     ;; #(
-  *) :
-
-   enable_xdvik=$enable_all_pkgs
-     { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`--enable-xdvik=$enable_xdvik'" >&5
-$as_echo "$as_me: Assuming \`--enable-xdvik=$enable_xdvik'" >&6;}
-     ac_configure_args="$ac_configure_args '--enable-xdvik=$enable_xdvik'"
-    ;;
-esac
-
-test "x$enable_xdvik" = xno || {
-  need_kpathsea=yes
-  need_freetype2=yes
-}
-
-## texk/xdvik/ac/xdvik.ac: configure.ac fragment for the TeX Live subdirectory texk/xdvik/
-## configure options for xdvik
-
-# Check whether --with-xdvi-x-toolkit was given.
-if test "${with_xdvi_x_toolkit+set}" = set; then :
-  withval=$with_xdvi_x_toolkit;
-fi
-
-
 ## texk/texlive/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/texlive/
 ## configure options and TL libraries required for texlive
 # Check whether --enable-texlive was given.
@@ -5829,80 +4556,6 @@
   need_icu=yes
 }
 
-## libs/icu/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/icu/
-## configure options and TL libraries required for icu (modified for XeTeX)
-
-# Check whether --with-system-icu was given.
-if test "${with_system_icu+set}" = set; then :
-  withval=$with_system_icu;
-fi
-if test "x$with_system_icu" = x; then
-  if test -f $srcdir/libs/icu/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`icu' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`icu' headers and library from TL tree" >&6;}
-    with_system_icu=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`icu' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`icu' headers and library" >&6;}
-    with_system_icu=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-icu=$with_system_icu'"
-elif test "x$with_system_icu" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`icu' headers and library" >&5
-$as_echo "$as_me: Using installed \`icu' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`icu' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`icu' headers and library from TL tree" >&6;}
-  if test "x$with_system_icu" != xno; then
-    with_system_icu=no
-    ac_configure_args="$ac_configure_args '--without-system-icu'"
-  fi
-fi
-
-## libs/teckit/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/teckit/
-## configure options and TL libraries required for teckit
-
-# Check whether --with-system-teckit was given.
-if test "${with_system_teckit+set}" = set; then :
-  withval=$with_system_teckit;
-fi
-if test "x$with_system_teckit" = x; then
-  if test -f $srcdir/libs/teckit/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`teckit' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`teckit' headers and library from TL tree" >&6;}
-    with_system_teckit=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`teckit' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`teckit' headers and library" >&6;}
-    with_system_teckit=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-teckit=$with_system_teckit'"
-elif test "x$with_system_teckit" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`teckit' headers and library" >&5
-$as_echo "$as_me: Using installed \`teckit' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`teckit' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`teckit' headers and library from TL tree" >&6;}
-  if test "x$with_system_teckit" != xno; then
-    with_system_teckit=no
-    ac_configure_args="$ac_configure_args '--without-system-teckit'"
-  fi
-fi
-if test "x$with_system_teckit" = xyes; then
-  if test "x$with_system_zlib" = x; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}:   ->  installed \`zlib' headers and library" >&5
-$as_echo "$as_me:   ->  installed \`zlib' headers and library" >&6;}
-    with_system_zlib=yes
-    ac_configure_args="$ac_configure_args '--with-system-zlib'"
-  elif test "x$with_system_zlib" != xyes; then
-    as_fn_error $? "Sorry, \`--with-system-teckit' requires \`--with-system-zlib'" "$LINENO" 5
-  fi
-fi
-
-test "x$need_teckit" = xyes && {
-  need_zlib=yes
-}
-
 ## libs/graphite2/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/graphite2/
 ## configure options and TL libraries required for graphite2
 
@@ -5977,307 +4630,6 @@
   need_zlib=yes
 }
 
-## libs/xpdf/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/xpdf/
-## configure options and TL libraries required for xpdf
-: "kpse_xpdf_options - no-op"
-if test "x$with_system_xpdf" = x; then
-  if test -f $srcdir/libs/xpdf/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`xpdf' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`xpdf' headers and library from TL tree" >&6;}
-    with_system_xpdf=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`xpdf' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`xpdf' headers and library" >&6;}
-    with_system_xpdf=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-xpdf=$with_system_xpdf'"
-elif test "x$with_system_xpdf" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`xpdf' headers and library" >&5
-$as_echo "$as_me: Using installed \`xpdf' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`xpdf' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`xpdf' headers and library from TL tree" >&6;}
-  if test "x$with_system_xpdf" != xno; then
-    with_system_xpdf=no
-    ac_configure_args="$ac_configure_args '--without-system-xpdf'"
-  fi
-fi
-
-## libs/mpfr/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/mpfr/
-## configure options and TL libraries required for mpfr
-
-# Check whether --with-system-mpfr was given.
-if test "${with_system_mpfr+set}" = set; then :
-  withval=$with_system_mpfr;
-fi
-
-# Check whether --with-mpfr-includes was given.
-if test "${with_mpfr_includes+set}" = set; then :
-  withval=$with_mpfr_includes;
-fi
-
-# Check whether --with-mpfr-libdir was given.
-if test "${with_mpfr_libdir+set}" = set; then :
-  withval=$with_mpfr_libdir;
-fi
-if test "x$with_system_mpfr" = x; then
-  if test -f $srcdir/libs/mpfr/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`mpfr' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`mpfr' headers and library from TL tree" >&6;}
-    with_system_mpfr=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`mpfr' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`mpfr' headers and library" >&6;}
-    with_system_mpfr=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-mpfr=$with_system_mpfr'"
-elif test "x$with_system_mpfr" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`mpfr' headers and library" >&5
-$as_echo "$as_me: Using installed \`mpfr' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`mpfr' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`mpfr' headers and library from TL tree" >&6;}
-  if test "x$with_system_mpfr" != xno; then
-    with_system_mpfr=no
-    ac_configure_args="$ac_configure_args '--without-system-mpfr'"
-  fi
-fi
-if test "x$with_system_mpfr" = xyes; then
-  if test "x$with_system_gmp" = x; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}:   ->  installed \`gmp' headers and library" >&5
-$as_echo "$as_me:   ->  installed \`gmp' headers and library" >&6;}
-    with_system_gmp=yes
-    ac_configure_args="$ac_configure_args '--with-system-gmp'"
-  elif test "x$with_system_gmp" != xyes; then
-    as_fn_error $? "Sorry, \`--with-system-mpfr' requires \`--with-system-gmp'" "$LINENO" 5
-  fi
-fi
-
-test "x$need_mpfr" = xyes && {
-  need_gmp=yes
-}
-
-## libs/gmp/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/gmp/
-## configure options and TL libraries required for gmp
-
-# Check whether --with-system-gmp was given.
-if test "${with_system_gmp+set}" = set; then :
-  withval=$with_system_gmp;
-fi
-
-# Check whether --with-gmp-includes was given.
-if test "${with_gmp_includes+set}" = set; then :
-  withval=$with_gmp_includes;
-fi
-
-# Check whether --with-gmp-libdir was given.
-if test "${with_gmp_libdir+set}" = set; then :
-  withval=$with_gmp_libdir;
-fi
-if test "x$with_system_gmp" = x; then
-  if test -f $srcdir/libs/gmp/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`gmp' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`gmp' headers and library from TL tree" >&6;}
-    with_system_gmp=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`gmp' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`gmp' headers and library" >&6;}
-    with_system_gmp=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-gmp=$with_system_gmp'"
-elif test "x$with_system_gmp" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`gmp' headers and library" >&5
-$as_echo "$as_me: Using installed \`gmp' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`gmp' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`gmp' headers and library from TL tree" >&6;}
-  if test "x$with_system_gmp" != xno; then
-    with_system_gmp=no
-    ac_configure_args="$ac_configure_args '--without-system-gmp'"
-  fi
-fi
-
-## libs/cairo/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/cairo/
-## configure options and TL libraries required for cairo
-
-# Check whether --with-system-cairo was given.
-if test "${with_system_cairo+set}" = set; then :
-  withval=$with_system_cairo;
-fi
-if test "x$with_system_cairo" = x; then
-  if test -f $srcdir/libs/cairo/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`cairo' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`cairo' headers and library from TL tree" >&6;}
-    with_system_cairo=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`cairo' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`cairo' headers and library" >&6;}
-    with_system_cairo=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-cairo=$with_system_cairo'"
-elif test "x$with_system_cairo" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`cairo' headers and library" >&5
-$as_echo "$as_me: Using installed \`cairo' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`cairo' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`cairo' headers and library from TL tree" >&6;}
-  if test "x$with_system_cairo" != xno; then
-    with_system_cairo=no
-    ac_configure_args="$ac_configure_args '--without-system-cairo'"
-  fi
-fi
-if test "x$with_system_cairo" = xyes; then
-  if test "x$with_system_pixman" = x; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}:   ->  installed \`pixman' headers and library" >&5
-$as_echo "$as_me:   ->  installed \`pixman' headers and library" >&6;}
-    with_system_pixman=yes
-    ac_configure_args="$ac_configure_args '--with-system-pixman'"
-  elif test "x$with_system_pixman" != xyes; then
-    as_fn_error $? "Sorry, \`--with-system-cairo' requires \`--with-system-pixman'" "$LINENO" 5
-  fi
-fi
-
-test "x$need_cairo" = xyes && {
-  need_pixman=yes
-}
-
-## libs/pixman/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/pixman/
-## configure options and TL libraries required for pixman
-
-# Check whether --with-system-pixman was given.
-if test "${with_system_pixman+set}" = set; then :
-  withval=$with_system_pixman;
-fi
-if test "x$with_system_pixman" = x; then
-  if test -f $srcdir/libs/pixman/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`pixman' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`pixman' headers and library from TL tree" >&6;}
-    with_system_pixman=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`pixman' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`pixman' headers and library" >&6;}
-    with_system_pixman=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-pixman=$with_system_pixman'"
-elif test "x$with_system_pixman" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`pixman' headers and library" >&5
-$as_echo "$as_me: Using installed \`pixman' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`pixman' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`pixman' headers and library from TL tree" >&6;}
-  if test "x$with_system_pixman" != xno; then
-    with_system_pixman=no
-    ac_configure_args="$ac_configure_args '--without-system-pixman'"
-  fi
-fi
-
-## libs/gd/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/gd/
-## configure options and TL libraries required for gd
-
-# Check whether --with-system-gd was given.
-if test "${with_system_gd+set}" = set; then :
-  withval=$with_system_gd;
-fi
-
-# Check whether --with-gd-includes was given.
-if test "${with_gd_includes+set}" = set; then :
-  withval=$with_gd_includes;
-fi
-
-# Check whether --with-gd-libdir was given.
-if test "${with_gd_libdir+set}" = set; then :
-  withval=$with_gd_libdir;
-fi
-if test "x$with_system_gd" = x; then
-  if test -f $srcdir/libs/gd/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`gd' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`gd' headers and library from TL tree" >&6;}
-    with_system_gd=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`gd' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`gd' headers and library" >&6;}
-    with_system_gd=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-gd=$with_system_gd'"
-elif test "x$with_system_gd" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`gd' headers and library" >&5
-$as_echo "$as_me: Using installed \`gd' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`gd' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`gd' headers and library from TL tree" >&6;}
-  if test "x$with_system_gd" != xno; then
-    with_system_gd=no
-    ac_configure_args="$ac_configure_args '--without-system-gd'"
-  fi
-fi
-if test "x$with_system_gd" = xyes; then
-  if test "x$with_system_libpng" = x; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}:   ->  installed \`libpng' headers and library" >&5
-$as_echo "$as_me:   ->  installed \`libpng' headers and library" >&6;}
-    with_system_libpng=yes
-    ac_configure_args="$ac_configure_args '--with-system-libpng'"
-  elif test "x$with_system_libpng" != xyes; then
-    as_fn_error $? "Sorry, \`--with-system-gd' requires \`--with-system-libpng'" "$LINENO" 5
-  fi
-  if test "x$with_system_freetype2" = x; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}:   ->  installed \`freetype2' headers and library" >&5
-$as_echo "$as_me:   ->  installed \`freetype2' headers and library" >&6;}
-    with_system_freetype2=yes
-    ac_configure_args="$ac_configure_args '--with-system-freetype2'"
-  elif test "x$with_system_freetype2" != xyes; then
-    as_fn_error $? "Sorry, \`--with-system-gd' requires \`--with-system-freetype2'" "$LINENO" 5
-  fi
-fi
-
-test "x$need_gd" = xyes && {
-  need_libpng=yes
-  need_freetype2=yes
-}
-
-## libs/freetype2/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/freetype2/
-## configure options and TL libraries required for freetype2
-
-# Check whether --with-system-freetype2 was given.
-if test "${with_system_freetype2+set}" = set; then :
-  withval=$with_system_freetype2;
-fi
-if test "x$with_system_freetype2" = x; then
-  if test -f $srcdir/libs/freetype2/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`freetype2' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`freetype2' headers and library from TL tree" >&6;}
-    with_system_freetype2=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`freetype2' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`freetype2' headers and library" >&6;}
-    with_system_freetype2=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-freetype2=$with_system_freetype2'"
-elif test "x$with_system_freetype2" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`freetype2' headers and library" >&5
-$as_echo "$as_me: Using installed \`freetype2' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`freetype2' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`freetype2' headers and library from TL tree" >&6;}
-  if test "x$with_system_freetype2" != xno; then
-    with_system_freetype2=no
-    ac_configure_args="$ac_configure_args '--without-system-freetype2'"
-  fi
-fi
-if test "x$with_system_freetype2" = xyes; then
-  if test "x$with_system_zlib" = x; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}:   ->  installed \`zlib' headers and library" >&5
-$as_echo "$as_me:   ->  installed \`zlib' headers and library" >&6;}
-    with_system_zlib=yes
-    ac_configure_args="$ac_configure_args '--with-system-zlib'"
-  elif test "x$with_system_zlib" != xyes; then
-    as_fn_error $? "Sorry, \`--with-system-freetype2' requires \`--with-system-zlib'" "$LINENO" 5
-  fi
-fi
-
-test "x$need_freetype2" = xyes && {
-  need_zlib=yes
-}
-
 ## libs/libpng/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/libpng/
 ## configure options and TL libraries required for libpng
 
@@ -6322,46 +4674,6 @@
   need_zlib=yes
 }
 
-## libs/libpaper/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/libpaper/
-## configure options and TL libraries required for libpaper
-
-# Check whether --with-system-libpaper was given.
-if test "${with_system_libpaper+set}" = set; then :
-  withval=$with_system_libpaper;
-fi
-
-# Check whether --with-libpaper-includes was given.
-if test "${with_libpaper_includes+set}" = set; then :
-  withval=$with_libpaper_includes;
-fi
-
-# Check whether --with-libpaper-libdir was given.
-if test "${with_libpaper_libdir+set}" = set; then :
-  withval=$with_libpaper_libdir;
-fi
-if test "x$with_system_libpaper" = x; then
-  if test -f $srcdir/libs/libpaper/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`libpaper' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`libpaper' headers and library from TL tree" >&6;}
-    with_system_libpaper=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`libpaper' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`libpaper' headers and library" >&6;}
-    with_system_libpaper=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-libpaper=$with_system_libpaper'"
-elif test "x$with_system_libpaper" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`libpaper' headers and library" >&5
-$as_echo "$as_me: Using installed \`libpaper' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`libpaper' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`libpaper' headers and library from TL tree" >&6;}
-  if test "x$with_system_libpaper" != xno; then
-    with_system_libpaper=no
-    ac_configure_args="$ac_configure_args '--without-system-libpaper'"
-  fi
-fi
-
 ## libs/luajit/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory libs/luajit/
 ## configure options and TL libraries required for luajit
 
@@ -6409,50 +4721,6 @@
 fi
 
 
-## texk/ptexenc/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ptexenc/
-## configure options and TL libraries required for ptexenc
-
-# Check whether --with-system-ptexenc was given.
-if test "${with_system_ptexenc+set}" = set; then :
-  withval=$with_system_ptexenc;
-fi
-if test "x$with_system_ptexenc" = x; then
-  if test -f $srcdir/texk/ptexenc/configure; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming \`ptexenc' headers and library from TL tree" >&5
-$as_echo "$as_me: Assuming \`ptexenc' headers and library from TL tree" >&6;}
-    with_system_ptexenc=no
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: Assuming installed \`ptexenc' headers and library" >&5
-$as_echo "$as_me: Assuming installed \`ptexenc' headers and library" >&6;}
-    with_system_ptexenc=yes
-  fi
-  ac_configure_args="$ac_configure_args '--with-system-ptexenc=$with_system_ptexenc'"
-elif test "x$with_system_ptexenc" = xyes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using installed \`ptexenc' headers and library" >&5
-$as_echo "$as_me: Using installed \`ptexenc' headers and library" >&6;}
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: Using \`ptexenc' headers and library from TL tree" >&5
-$as_echo "$as_me: Using \`ptexenc' headers and library from TL tree" >&6;}
-  if test "x$with_system_ptexenc" != xno; then
-    with_system_ptexenc=no
-    ac_configure_args="$ac_configure_args '--without-system-ptexenc'"
-  fi
-fi
-if test "x$with_system_ptexenc" = xyes; then
-  if test "x$with_system_kpathsea" = x; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}:   ->  installed \`kpathsea' headers and library" >&5
-$as_echo "$as_me:   ->  installed \`kpathsea' headers and library" >&6;}
-    with_system_kpathsea=yes
-    ac_configure_args="$ac_configure_args '--with-system-kpathsea'"
-  elif test "x$with_system_kpathsea" != xyes; then
-    as_fn_error $? "Sorry, \`--with-system-ptexenc' requires \`--with-system-kpathsea'" "$LINENO" 5
-  fi
-fi
-
-test "x$need_ptexenc" = xyes && {
-  need_kpathsea=yes
-}
-
 ## texk/kpathsea/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/kpathsea/
 ## configure options and TL libraries required for kpathsea
 
@@ -6691,7 +4959,12 @@
 program_transform_name=`$as_echo "$program_transform_name" | sed "$ac_script"`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
@@ -21085,10 +19358,6 @@
 echo 'tldbg:_KPSE_RECURSE called: list=texlibs, text=TeX specific libraries, cond=test "x$with_system_[]Kpse_pkg" != xyes && test "x$need_[]Kpse_pkg" = xyes, prefix=texk/.' >&5
 MAKE_SUBDIRS=
 CONF_SUBDIRS=
-if test -x $srcdir/texk/ptexenc/configure; then
-  test "x$with_system_ptexenc" != xyes && test "x$need_ptexenc" = xyes && MAKE_SUBDIRS="texk/ptexenc $MAKE_SUBDIRS"
-  CONF_SUBDIRS="texk/ptexenc $CONF_SUBDIRS"
-fi
 if test -x $srcdir/texk/kpathsea/configure; then
   test "x$with_system_kpathsea" != xyes && test "x$need_kpathsea" = xyes && MAKE_SUBDIRS="texk/kpathsea $MAKE_SUBDIRS"
   CONF_SUBDIRS="texk/kpathsea $CONF_SUBDIRS"
@@ -21732,36 +20001,6 @@
 $as_echo "$kpse_res" >&6; }
 fi
 
-## texk/ptexenc/ac/ptexenc.ac: configure.ac fragment for the TeX Live subdirectory texk/ptexenc/
-## basic check of system ptexenc
-if test "x$need_ptexenc:$with_system_ptexenc" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`ptexenc' library" >&5
-$as_echo_n "checking requested system \`ptexenc' library... " >&6; }
-  CPPFLAGS="$PTEXENC_INCLUDES $CPPFLAGS"
-  LIBS="$PTEXENC_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <ptexenc/ptexenc.h>
-int
-main ()
-{
-const char *version = ptexenc_version_string;
-set_enc_string("prog", "name");
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
 ## libs/zlib/ac/zlib.ac: configure.ac fragment for the TeX Live subdirectory libs/zlib/
 ## basic check of system zlib
 if test "x$need_zlib:$with_system_zlib" = xyes:yes; then
@@ -21793,35 +20032,6 @@
 $as_echo "$kpse_res" >&6; }
 fi
 
-## libs/libpaper/ac/libpaper.ac: configure.ac fragment for the TeX Live subdirectory libs/libpaper/
-## basic check of system libpaper
-if test "x$need_libpaper:$with_system_libpaper" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`libpaper' library" >&5
-$as_echo_n "checking requested system \`libpaper' library... " >&6; }
-  CPPFLAGS="$LIBPAPER_INCLUDES $CPPFLAGS"
-  LIBS="$LIBPAPER_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <paper.h>
-int
-main ()
-{
-const char *v = defaultpapername();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
 ## libs/libpng/ac/libpng.ac: configure.ac fragment for the TeX Live subdirectory libs/libpng/
 ## basic check of system libpng
 if test "x$need_libpng:$with_system_libpng" = xyes:yes; then
@@ -21852,221 +20062,6 @@
 $as_echo "$kpse_res" >&6; }
 fi
 
-## libs/freetype2/ac/freetype2.ac: configure.ac fragment for the TeX Live subdirectory libs/freetype2/
-## basic check of system freetype2
-if test "x$need_freetype2:$with_system_freetype2" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`freetype2' library" >&5
-$as_echo_n "checking requested system \`freetype2' library... " >&6; }
-  CPPFLAGS="$FREETYPE2_INCLUDES $CPPFLAGS"
-  LIBS="$FREETYPE2_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <ft2build.h>
-#include FT_FREETYPE_H
-int
-main ()
-{
-FT_Library library; FT_Init_FreeType(&library);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
-## libs/gd/ac/gd.ac: configure.ac fragment for the TeX Live subdirectory libs/gd/
-## basic check of system gd
-if test "x$need_gd:$with_system_gd" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`gd' library" >&5
-$as_echo_n "checking requested system \`gd' library... " >&6; }
-  CPPFLAGS="$GD_INCLUDES $CPPFLAGS"
-  LIBS="$GD_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <gd.h>
-int
-main ()
-{
-gdImageCreate(1, 2);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
-## libs/pixman/ac/pixman.ac: configure.ac fragment for the TeX Live subdirectory libs/pixman/
-## basic check of system pixman
-if test "x$need_pixman:$with_system_pixman" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`pixman' library" >&5
-$as_echo_n "checking requested system \`pixman' library... " >&6; }
-  CPPFLAGS="$PIXMAN_INCLUDES $CPPFLAGS"
-  LIBS="$PIXMAN_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <pixman.h>
-int
-main ()
-{
-const char *s = pixman_version_string();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
-## libs/cairo/ac/cairo.ac: configure.ac fragment for the TeX Live subdirectory libs/cairo/
-## basic check of system cairo
-if test "x$need_cairo:$with_system_cairo" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`cairo' library" >&5
-$as_echo_n "checking requested system \`cairo' library... " >&6; }
-  CPPFLAGS="$CAIRO_INCLUDES $CPPFLAGS"
-  LIBS="$CAIRO_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <cairo.h>
-int
-main ()
-{
-const char *s = cairo_version_string();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
-## libs/gmp/ac/gmp.ac: configure.ac fragment for the TeX Live subdirectory libs/gmp/
-## basic check of system gmp
-if test "x$need_gmp:$with_system_gmp" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`gmp' library" >&5
-$as_echo_n "checking requested system \`gmp' library... " >&6; }
-  CPPFLAGS="$GMP_INCLUDES $CPPFLAGS"
-  LIBS="$GMP_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <gmp.h>
-int
-main ()
-{
-const char *s = gmp_version;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
-## libs/mpfr/ac/mpfr.ac: configure.ac fragment for the TeX Live subdirectory libs/mpfr/
-## basic check of system mpfr
-if test "x$need_mpfr:$with_system_mpfr" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`mpfr' library" >&5
-$as_echo_n "checking requested system \`mpfr' library... " >&6; }
-  CPPFLAGS="$MPFR_INCLUDES $CPPFLAGS"
-  LIBS="$MPFR_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <mpfr.h>
-int
-main ()
-{
-const char *s = mpfr_get_version();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-
-## libs/xpdf/ac/xpdf.ac: configure.ac fragment for the TeX Live subdirectory libs/xpdf/
-## basic check of system xpdf (a.k.a. poppler, no longer supported in
-## TL sources)
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test "x$need_xpdf:$with_system_xpdf" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`xpdf' library" >&5
-$as_echo_n "checking requested system \`xpdf' library... " >&6; }
-  CPPFLAGS="$XPDF_INCLUDES $CPPFLAGS"
-  LIBS="$XPDF_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <GfxFont.h>
-int
-main ()
-{
-GfxFont *gfxFont; gfxFont->decRefCnt();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
 ## libs/zziplib/ac/zziplib.ac: configure.ac fragment for the TeX Live subdirectory libs/zziplib/
 ## basic check of system zziplib
 if test "x$need_zziplib:$with_system_zziplib" = xyes:yes; then
@@ -22126,85 +20121,6 @@
 $as_echo "$kpse_res" >&6; }
 fi
 
-## libs/teckit/ac/teckit.ac: configure.ac fragment for the TeX Live subdirectory libs/teckit/
-## basic check of system teckit
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test "x$need_teckit:$with_system_teckit" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`teckit' library" >&5
-$as_echo_n "checking requested system \`teckit' library... " >&6; }
-  CPPFLAGS="$TECKIT_INCLUDES $CPPFLAGS"
-  LIBS="$TECKIT_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <teckit/TECkit_Engine.h>
-int
-main ()
-{
-TECkit_Converter converter; TECkit_DisposeConverter(converter);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-## libs/icu/ac/icu.ac: configure.ac fragment for the TeX Live subdirectory libs/icu/
-## basic check of system icu
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test "x$need_icu:$with_system_icu" = xyes:yes; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking requested system \`icu' library" >&5
-$as_echo_n "checking requested system \`icu' library... " >&6; }
-  CPPFLAGS="$ICU_INCLUDES $CPPFLAGS"
-  LIBS="$ICU_LIBS $LIBS"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <unicode/ustring.h>
-int
-main ()
-{
-UErrorCode code; const UChar *src; UChar *dst;
-u_strToLower(dst, -1, src, -1, NULL, &code);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_link "$LINENO"; then :
-  syslib_used=yes kpse_res=ok
-else
-  syslib_status=no kpse_res=failed
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_res" >&5
-$as_echo "$kpse_res" >&6; }
-fi
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
 ## libs/harfbuzz/ac/harfbuzz.ac: configure.ac fragment for the TeX Live subdirectory libs/harfbuzz/
 ## basic check of system harfbuzz
 if test "x$need_harfbuzz:$with_system_harfbuzz" = xyes:yes; then
Index: source/doc/Makefile.in
===================================================================
--- source/doc/Makefile.in	(revision 7398)
+++ source/doc/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/aclocal.m4
===================================================================
--- source/libs/aclocal.m4	(revision 7398)
+++ source/libs/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/configure
===================================================================
--- source/libs/configure	(revision 7398)
+++ source/libs/configure	(working copy)
@@ -4079,7 +4079,12 @@
 program_transform_name=`$as_echo "$program_transform_name" | sed "$ac_script"`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/graphite2/aclocal.m4
===================================================================
--- source/libs/graphite2/aclocal.m4	(revision 7398)
+++ source/libs/graphite2/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/graphite2/configure
===================================================================
--- source/libs/graphite2/configure	(revision 7398)
+++ source/libs/graphite2/configure	(working copy)
@@ -2114,7 +2114,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/graphite2/include/graphite2/Makefile.in
===================================================================
--- source/libs/graphite2/include/graphite2/Makefile.in	(revision 7398)
+++ source/libs/graphite2/include/graphite2/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/graphite2/Makefile.in
===================================================================
--- source/libs/graphite2/Makefile.in	(revision 7398)
+++ source/libs/graphite2/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -495,7 +495,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -566,8 +565,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1226,7 +1223,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1424,7 +1421,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/harfbuzz/aclocal.m4
===================================================================
--- source/libs/harfbuzz/aclocal.m4	(revision 7398)
+++ source/libs/harfbuzz/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/harfbuzz/configure
===================================================================
--- source/libs/harfbuzz/configure	(revision 7398)
+++ source/libs/harfbuzz/configure	(working copy)
@@ -2680,7 +2680,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/harfbuzz/harfbuzz-src/src/harfbuzz.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/harfbuzz.cc	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/harfbuzz.cc	(working copy)
@@ -46,6 +46,7 @@
 #include "hb-style.cc"
 #include "hb-ucd.cc"
 #include "hb-unicode.cc"
+#include "hb-ot-layout-jtst-context.cc"
 #include "hb-glib.cc"
 #include "hb-ft.cc"
 #include "hb-graphite2.cc"
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.cc	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.cc	(working copy)
@@ -665,6 +665,12 @@
 
   HB_BUFFER_CONTENT_TYPE_INVALID,
   HB_SEGMENT_PROPERTIES_DEFAULT,
+#ifndef HB_NO_JUSTIFICATION
+  false,
+  false,
+  0,
+  nullptr,
+#endif
   false, /* successful */
   true, /* have_output */
   true  /* have_positions */
@@ -2027,4 +2033,19 @@
   vsnprintf (buf, sizeof (buf), fmt, ap);
   return (bool) this->message_func (this, font, buf, this->message_data);
 }
+#ifndef HB_NO_JUSTIFICATION
+void hb_buffer_set_justify(hb_buffer_t* buffer, int lineWidth)
+{
+  if (lineWidth <= 0) {
+    buffer->justifyLine = false;
+    buffer->lineWidth = 0;
+  }
+  else
+  {
+    buffer->justifyLine = true;
+    buffer->lineWidth = lineWidth;
+  }
+  
+}
 #endif
+#endif
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.h
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.h	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.h	(working copy)
@@ -65,10 +65,17 @@
   hb_mask_t      mask;
   /*< public >*/
   uint32_t       cluster;
+  //VisualMetaFont
+  //unsigned int lookup_index;
+  unsigned int subtable_index;
+  hb_codepoint_t base_codepoint;
 
   /*< private >*/
   hb_var_int_t   var1;
   hb_var_int_t   var2;
+  //VisualMetaFont
+  double lefttatweel;
+  double righttatweel;
 } hb_glyph_info_t;
 
 /**
@@ -127,8 +134,15 @@
   hb_position_t  x_offset;
   hb_position_t  y_offset;
 
+  //VisualMetaFont
+  unsigned int lookup_index;
+  unsigned int subtable_index;
+  hb_codepoint_t base_codepoint;  
   /*< private >*/
   hb_var_int_t   var;
+  //VisualMetaFont
+  double lefttatweel;
+  double righttatweel;
 } hb_glyph_position_t;
 
 /**
@@ -628,6 +642,10 @@
 			    hb_buffer_message_func_t func,
 			    void *user_data, hb_destroy_func_t destroy);
 
+#ifndef HB_NO_JUSTIFICATION
+HB_EXTERN void hb_buffer_set_justify (hb_buffer_t *buffer,
+				    int lineWidth);
+#endif
 
 HB_END_DECLS
 
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.hh	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-buffer.hh	(working copy)
@@ -30,10 +30,12 @@
 #ifndef HB_BUFFER_HH
 #define HB_BUFFER_HH
 
+#include "hb-unicode.hh"
 #include "hb.hh"
-#include "hb-unicode.hh"
+#ifndef HB_NO_JUSTIFICATION
+#include "hb-ot-layout-jtst-context.hh"
+#endif
 
-
 #ifndef HB_BUFFER_MAX_LEN_FACTOR
 #define HB_BUFFER_MAX_LEN_FACTOR 64
 #endif
@@ -41,7 +43,8 @@
 #define HB_BUFFER_MAX_LEN_MIN 16384
 #endif
 #ifndef HB_BUFFER_MAX_LEN_DEFAULT
-#define HB_BUFFER_MAX_LEN_DEFAULT 0x3FFFFFFF /* Shaping more than a billion chars? Let us know! */
+#define HB_BUFFER_MAX_LEN_DEFAULT \
+  0x3FFFFFFF /* Shaping more than a billion chars? Let us know! */
 #endif
 
 #ifndef HB_BUFFER_MAX_OPS_FACTOR
@@ -51,10 +54,12 @@
 #define HB_BUFFER_MAX_OPS_MIN 16384
 #endif
 #ifndef HB_BUFFER_MAX_OPS_DEFAULT
-#define HB_BUFFER_MAX_OPS_DEFAULT 0x1FFFFFFF /* Shaping more than a billion operations? Let us know! */
+#define HB_BUFFER_MAX_OPS_DEFAULT \
+  0x1FFFFFFF /* Shaping more than a billion operations? Let us know! */
 #endif
 
-static_assert ((sizeof (hb_glyph_info_t) == 20), "");
+// VisualMetaFont
+// static_assert ((sizeof (hb_glyph_info_t) == 20), "");
 static_assert ((sizeof (hb_glyph_info_t) == sizeof (hb_glyph_position_t)), "");
 
 HB_MARK_AS_FLAG_T (hb_buffer_flags_t);
@@ -62,23 +67,22 @@
 HB_MARK_AS_FLAG_T (hb_buffer_diff_flags_t);
 
 enum hb_buffer_scratch_flags_t {
-  HB_BUFFER_SCRATCH_FLAG_DEFAULT			= 0x00000000u,
-  HB_BUFFER_SCRATCH_FLAG_HAS_NON_ASCII			= 0x00000001u,
-  HB_BUFFER_SCRATCH_FLAG_HAS_DEFAULT_IGNORABLES		= 0x00000002u,
-  HB_BUFFER_SCRATCH_FLAG_HAS_SPACE_FALLBACK		= 0x00000004u,
-  HB_BUFFER_SCRATCH_FLAG_HAS_GPOS_ATTACHMENT		= 0x00000008u,
-  HB_BUFFER_SCRATCH_FLAG_HAS_UNSAFE_TO_BREAK		= 0x00000010u,
-  HB_BUFFER_SCRATCH_FLAG_HAS_CGJ			= 0x00000020u,
+  HB_BUFFER_SCRATCH_FLAG_DEFAULT = 0x00000000u,
+  HB_BUFFER_SCRATCH_FLAG_HAS_NON_ASCII = 0x00000001u,
+  HB_BUFFER_SCRATCH_FLAG_HAS_DEFAULT_IGNORABLES = 0x00000002u,
+  HB_BUFFER_SCRATCH_FLAG_HAS_SPACE_FALLBACK = 0x00000004u,
+  HB_BUFFER_SCRATCH_FLAG_HAS_GPOS_ATTACHMENT = 0x00000008u,
+  HB_BUFFER_SCRATCH_FLAG_HAS_UNSAFE_TO_BREAK = 0x00000010u,
+  HB_BUFFER_SCRATCH_FLAG_HAS_CGJ = 0x00000020u,
 
   /* Reserved for complex shapers' internal use. */
-  HB_BUFFER_SCRATCH_FLAG_COMPLEX0			= 0x01000000u,
-  HB_BUFFER_SCRATCH_FLAG_COMPLEX1			= 0x02000000u,
-  HB_BUFFER_SCRATCH_FLAG_COMPLEX2			= 0x04000000u,
-  HB_BUFFER_SCRATCH_FLAG_COMPLEX3			= 0x08000000u,
+  HB_BUFFER_SCRATCH_FLAG_COMPLEX0 = 0x01000000u,
+  HB_BUFFER_SCRATCH_FLAG_COMPLEX1 = 0x02000000u,
+  HB_BUFFER_SCRATCH_FLAG_COMPLEX2 = 0x04000000u,
+  HB_BUFFER_SCRATCH_FLAG_COMPLEX3 = 0x08000000u,
 };
 HB_MARK_AS_FLAG_T (hb_buffer_scratch_flags_t);
 
-
 /*
  * hb_buffer_t
  */
@@ -89,29 +93,38 @@
 
   /* Information about how the text in the buffer should be treated */
   hb_unicode_funcs_t *unicode; /* Unicode functions */
-  hb_buffer_flags_t flags; /* BOT / EOT / etc. */
+  hb_buffer_flags_t flags;     /* BOT / EOT / etc. */
   hb_buffer_cluster_level_t cluster_level;
-  hb_codepoint_t replacement; /* U+FFFD or something else. */
-  hb_codepoint_t invisible; /* 0 or something else. */
+  hb_codepoint_t replacement;		   /* U+FFFD or something else. */
+  hb_codepoint_t invisible;		   /* 0 or something else. */
   hb_buffer_scratch_flags_t scratch_flags; /* Have space-fallback, etc. */
-  unsigned int max_len; /* Maximum allowed len. */
-  int max_ops; /* Maximum allowed operations. */
+  unsigned int max_len;			   /* Maximum allowed len. */
+  int max_ops;				   /* Maximum allowed operations. */
 
   /* Buffer contents */
   hb_buffer_content_type_t content_type;
   hb_segment_properties_t props; /* Script, language, direction */
 
-  bool successful; /* Allocations successful */
-  bool have_output; /* Whether we have an output buffer going on */
+  /* OTVar justification test*/
+#ifndef HB_NO_JUSTIFICATION
+  /*enable line justification during shaping*/
+  bool justifyLine;
+  bool useCallback;
+  int lineWidth;
+  OT::JustificationContext* justContext;
+#endif
+
+  bool successful;     /* Allocations successful */
+  bool have_output;    /* Whether we have an output buffer going on */
   bool have_positions; /* Whether we have positions */
 
-  unsigned int idx; /* Cursor into ->info and ->pos arrays */
-  unsigned int len; /* Length of ->info and ->pos arrays */
+  unsigned int idx;	/* Cursor into ->info and ->pos arrays */
+  unsigned int len;	/* Length of ->info and ->pos arrays */
   unsigned int out_len; /* Length of ->out array if have_output */
 
   unsigned int allocated; /* Length of allocated arrays */
-  hb_glyph_info_t     *info;
-  hb_glyph_info_t     *out_info;
+  hb_glyph_info_t *info;
+  hb_glyph_info_t *out_info;
   hb_glyph_position_t *pos;
 
   unsigned int serial;
@@ -131,12 +144,12 @@
 #endif
 
   /* Internal debugging. */
-  /* The bits here reflect current allocations of the bytes in glyph_info_t's var1 and var2. */
+  /* The bits here reflect current allocations of the bytes in glyph_info_t's
+   * var1 and var2. */
 #ifndef HB_NDEBUG
   uint8_t allocated_var_bits;
 #endif
 
-
   /* Methods */
 
   bool in_error () const { return !successful; }
@@ -146,7 +159,7 @@
 #ifndef HB_NDEBUG
     unsigned int end = start + count;
     assert (end <= 8);
-    unsigned int bits = (1u<<end) - (1u<<start);
+    unsigned int bits = (1u << end) - (1u << start);
     assert (0 == (allocated_var_bits & bits));
     allocated_var_bits |= bits;
 #endif
@@ -156,7 +169,7 @@
 #ifndef HB_NDEBUG
     unsigned int end = start + count;
     assert (end <= 8);
-    unsigned int bits = (1u<<end) - (1u<<start);
+    unsigned int bits = (1u << end) - (1u << start);
     assert (bits == (allocated_var_bits & bits));
     allocated_var_bits &= ~bits;
 #endif
@@ -166,7 +179,7 @@
 #ifndef HB_NDEBUG
     unsigned int end = start + count;
     assert (end <= 8);
-    unsigned int bits = (1u<<end) - (1u<<start);
+    unsigned int bits = (1u << end) - (1u << start);
     assert (bits == (allocated_var_bits & bits));
 #endif
   }
@@ -181,23 +194,24 @@
   hb_glyph_info_t cur (unsigned int i = 0) const { return info[idx + i]; }
 
   hb_glyph_position_t &cur_pos (unsigned int i = 0) { return pos[idx + i]; }
-  hb_glyph_position_t cur_pos (unsigned int i = 0) const { return pos[idx + i]; }
+  hb_glyph_position_t cur_pos (unsigned int i = 0) const
+  {
+    return pos[idx + i];
+  }
 
-  hb_glyph_info_t &prev ()      { return out_info[out_len ? out_len - 1 : 0]; }
+  hb_glyph_info_t &prev () { return out_info[out_len ? out_len - 1 : 0]; }
   hb_glyph_info_t prev () const { return out_info[out_len ? out_len - 1 : 0]; }
 
   bool has_separate_output () const { return info != out_info; }
 
-
   HB_INTERNAL void reset ();
   HB_INTERNAL void clear ();
 
-  unsigned int backtrack_len () const { return have_output? out_len : idx; }
+  unsigned int backtrack_len () const { return have_output ? out_len : idx; }
   unsigned int lookahead_len () const { return len - idx; }
   unsigned int next_serial () { return serial++; }
 
-  HB_INTERNAL void add (hb_codepoint_t  codepoint,
-			unsigned int    cluster);
+  HB_INTERNAL void add (hb_codepoint_t codepoint, unsigned int cluster);
   HB_INTERNAL void add_info (const hb_glyph_info_t &glyph_info);
 
   HB_INTERNAL void reverse_range (unsigned int start, unsigned int end);
@@ -216,7 +230,8 @@
 
   void replace_glyph (hb_codepoint_t glyph_index)
   {
-    if (unlikely (out_info != info || out_len != idx)) {
+    if (unlikely (out_info != info || out_len != idx))
+    {
       if (unlikely (!make_room_for (1, 1))) return;
       out_info[out_len] = info[idx];
     }
@@ -226,7 +241,7 @@
     out_len++;
   }
   /* Makes a copy of the glyph at idx to output and replace glyph_index */
-  hb_glyph_info_t & output_glyph (hb_codepoint_t glyph_index)
+  hb_glyph_info_t &output_glyph (hb_codepoint_t glyph_index)
   {
     if (unlikely (!make_room_for (0, 1))) return Crap (hb_glyph_info_t);
 
@@ -259,8 +274,7 @@
   }
   /* Copies glyph at idx to output and advance idx.
    * If there's no output, just advance idx. */
-  void
-  next_glyph ()
+  void next_glyph ()
   {
     if (have_output)
     {
@@ -276,8 +290,7 @@
   }
   /* Copies n glyphs at idx to output and advance idx.
    * If there's no output, just advance idx. */
-  void
-  next_glyphs (unsigned int n)
+  void next_glyphs (unsigned int n)
   {
     if (have_output)
     {
@@ -295,21 +308,20 @@
   void skip_glyph () { idx++; }
   void reset_masks (hb_mask_t mask)
   {
-    for (unsigned int j = 0; j < len; j++)
-      info[j].mask = mask;
+    for (unsigned int j = 0; j < len; j++) info[j].mask = mask;
   }
   void add_masks (hb_mask_t mask)
   {
-    for (unsigned int j = 0; j < len; j++)
-      info[j].mask |= mask;
+    for (unsigned int j = 0; j < len; j++) info[j].mask |= mask;
   }
-  HB_INTERNAL void set_masks (hb_mask_t value, hb_mask_t mask,
-			      unsigned int cluster_start, unsigned int cluster_end);
+  HB_INTERNAL void set_masks (hb_mask_t value,
+			      hb_mask_t mask,
+			      unsigned int cluster_start,
+			      unsigned int cluster_end);
 
   void merge_clusters (unsigned int start, unsigned int end)
   {
-    if (end - start < 2)
-      return;
+    if (end - start < 2) return;
     merge_clusters_impl (start, end);
   }
   HB_INTERNAL void merge_clusters_impl (unsigned int start, unsigned int end);
@@ -320,14 +332,13 @@
   void unsafe_to_break (unsigned int start,
 			unsigned int end)
   {
-    if (end - start < 2)
-      return;
+    if (end - start < 2) return;
     unsafe_to_break_impl (start, end);
   }
   HB_INTERNAL void unsafe_to_break_impl (unsigned int start, unsigned int end);
-  HB_INTERNAL void unsafe_to_break_from_outbuffer (unsigned int start, unsigned int end);
+  HB_INTERNAL void unsafe_to_break_from_outbuffer (unsigned int start,
+						   unsigned int end);
 
-
   /* Internal methods */
   HB_INTERNAL bool move_to (unsigned int i); /* i is output-buffer index. */
 
@@ -334,10 +345,14 @@
   HB_INTERNAL bool enlarge (unsigned int size);
 
   bool ensure (unsigned int size)
-  { return likely (!size || size < allocated) ? true : enlarge (size); }
+  {
+    return likely (!size || size < allocated) ? true : enlarge (size);
+  }
 
   bool ensure_inplace (unsigned int size)
-  { return likely (!size || size < allocated); }
+  {
+    return likely (!size || size < allocated);
+  }
 
   void assert_glyphs ()
   {
@@ -380,7 +395,10 @@
 
   void clear_context (unsigned int side) { context_len[side] = 0; }
 
-  HB_INTERNAL void sort (unsigned int start, unsigned int end, int(*compar)(const hb_glyph_info_t *, const hb_glyph_info_t *));
+  HB_INTERNAL void sort (unsigned int start,
+			 unsigned int end,
+			 int (*compar) (const hb_glyph_info_t *,
+					const hb_glyph_info_t *));
 
   bool messaging ()
   {
@@ -390,13 +408,12 @@
     return unlikely (message_func);
 #endif
   }
-  bool message (hb_font_t *font, const char *fmt, ...) HB_PRINTF_FUNC(3, 4)
+  bool message (hb_font_t *font, const char *fmt, ...) HB_PRINTF_FUNC (3, 4)
   {
 #ifdef HB_NO_BUFFER_MESSAGE
-   return true;
+    return true;
 #else
-    if (!messaging ())
-      return true;
+    if (!messaging ()) return true;
     va_list ap;
     va_start (ap, fmt);
     bool ret = message_impl (font, fmt, ap);
@@ -404,10 +421,12 @@
     return ret;
 #endif
   }
-  HB_INTERNAL bool message_impl (hb_font_t *font, const char *fmt, va_list ap) HB_PRINTF_FUNC(3, 0);
+  HB_INTERNAL bool message_impl (hb_font_t *font, const char *fmt, va_list ap)
+      HB_PRINTF_FUNC (3, 0);
 
-  static void
-  set_cluster (hb_glyph_info_t &inf, unsigned int cluster, unsigned int mask = 0)
+  static void set_cluster (hb_glyph_info_t &inf,
+			   unsigned int cluster,
+			   unsigned int mask = 0)
   {
     if (inf.cluster != cluster)
     {
@@ -428,10 +447,10 @@
       cluster = hb_min (cluster, infos[i].cluster);
     return cluster;
   }
-  void
-  _unsafe_to_break_set_mask (hb_glyph_info_t *infos,
-			     unsigned int start, unsigned int end,
-			     unsigned int cluster)
+  void _unsafe_to_break_set_mask (hb_glyph_info_t *infos,
+				  unsigned int start,
+				  unsigned int end,
+				  unsigned int cluster)
   {
     for (unsigned int i = start; i < end; i++)
       if (cluster != infos[i].cluster)
@@ -450,14 +469,11 @@
 };
 DECLARE_NULL_INSTANCE (hb_buffer_t);
 
-
 /* Loop over clusters. Duplicated in foreach_syllable(). */
-#define foreach_cluster(buffer, start, end) \
-  for (unsigned int \
-       _count = buffer->len, \
-       start = 0, end = _count ? _next_cluster (buffer, 0) : 0; \
-       start < _count; \
-       start = end, end = _next_cluster (buffer, start))
+#define foreach_cluster(buffer, start, end)                       \
+  for (unsigned int _count = buffer->len, start = 0,              \
+		    end = _count ? _next_cluster (buffer, 0) : 0; \
+       start < _count; start = end, end = _next_cluster (buffer, start))
 
 static inline unsigned int
 _next_cluster (hb_buffer_t *buffer, unsigned int start)
@@ -472,13 +488,14 @@
   return start;
 }
 
-
-#define HB_BUFFER_XALLOCATE_VAR(b, func, var) \
-  b->func (offsetof (hb_glyph_info_t, var) - offsetof(hb_glyph_info_t, var1), \
+#define HB_BUFFER_XALLOCATE_VAR(b, func, var)                                  \
+  b->func (offsetof (hb_glyph_info_t, var) - offsetof (hb_glyph_info_t, var1), \
 	   sizeof (b->info[0].var))
-#define HB_BUFFER_ALLOCATE_VAR(b, var)		HB_BUFFER_XALLOCATE_VAR (b, allocate_var,   var ())
-#define HB_BUFFER_DEALLOCATE_VAR(b, var)	HB_BUFFER_XALLOCATE_VAR (b, deallocate_var, var ())
-#define HB_BUFFER_ASSERT_VAR(b, var)		HB_BUFFER_XALLOCATE_VAR (b, assert_var,     var ())
+#define HB_BUFFER_ALLOCATE_VAR(b, var) \
+  HB_BUFFER_XALLOCATE_VAR (b, allocate_var, var ())
+#define HB_BUFFER_DEALLOCATE_VAR(b, var) \
+  HB_BUFFER_XALLOCATE_VAR (b, deallocate_var, var ())
+#define HB_BUFFER_ASSERT_VAR(b, var) \
+  HB_BUFFER_XALLOCATE_VAR (b, assert_var, var ())
 
-
 #endif /* HB_BUFFER_HH */
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-font.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-font.cc	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-font.cc	(working copy)
@@ -501,6 +501,45 @@
   return font->parent->get_glyph_from_name (name, len, glyph);
 }
 
+/* Added for VisualMetaFont */
+
+#define hb_font_get_cursive_anchor_nil hb_font_get_cursive_anchor_default
+static hb_bool_t
+hb_font_get_cursive_anchor_default (hb_font_t *font,
+				    void *font_data,
+				    hb_cursive_anchor_context_t *context,
+				    hb_position_t *x,
+				    hb_position_t *y,
+				    void *user_data)
+{
+  *x = 0;
+  *y = 0;
+
+  return false;
+}
+
+#define hb_font_get_substitution_nil hb_font_get_substitution_default
+static hb_bool_t
+hb_font_get_substitution_default (hb_font_t *font,
+				  void *font_data,
+				  hb_substitution_context_t *context,
+				  void *user_data)
+{
+
+  return false;
+}
+
+#define hb_font_get_apply_lookup_nil hb_font_get_apply_lookup_default
+static hb_bool_t
+hb_font_get_apply_lookup_default (hb_font_t *font,
+				  void *font_data,
+				  OT::hb_ot_apply_context_t *c,
+				  void *user_data)
+{
+
+  return false;
+}
+
 DEFINE_NULL_INSTANCE (hb_font_funcs_t) =
 {
   HB_OBJECT_HEADER_STATIC,
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-font.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-font.hh	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-font.hh	(working copy)
@@ -39,6 +39,70 @@
  * hb_font_funcs_t
  */
 
+
+/* Added for VisualMetaFont */
+
+typedef struct hb_cursive_anchor_context_t
+{
+  enum Type { entry, exit, mark, base };
+  hb_codepoint_t glyph_id;
+  hb_codepoint_t base_glyph_id;
+  double lefttatweel;
+  double righttatweel;
+  unsigned int lookup_index;
+  unsigned int subtable_index;
+  Type type;
+} hb_cursive_anchor_context_t;
+
+typedef hb_bool_t (*hb_font_get_cursive_anchor_func_t) (
+    hb_font_t *font,
+    void *font_data,
+    hb_cursive_anchor_context_t *context,
+    hb_position_t *x,
+    hb_position_t *y,
+    void *user_data);
+
+namespace OT {
+struct hb_ot_apply_context_t;
+}
+
+typedef struct hb_substitution_context_t
+{
+  OT::hb_ot_apply_context_t *ot_context;
+  unsigned int substitute;
+} hb_substitution_context_t;
+
+typedef hb_bool_t (*hb_font_get_substitution_func_t) (
+    hb_font_t *font,
+    void *font_data,
+    hb_substitution_context_t *context,
+    void *user_data);
+
+typedef hb_bool_t (*hb_font_get_apply_lookup_func_t) (
+    hb_font_t *font,
+    void *font_data,
+    OT::hb_ot_apply_context_t *c,
+    void *user_data);
+
+
+HB_EXTERN void
+hb_font_funcs_set_substitution_func (hb_font_funcs_t *ffuncs,
+				     hb_font_get_substitution_func_t func,
+				     void *user_data,
+				     hb_destroy_func_t destroy);
+
+HB_EXTERN void
+hb_font_funcs_set_apply_lookup_func (hb_font_funcs_t *ffuncs,
+				     hb_font_get_apply_lookup_func_t func,
+				     void *user_data,
+				     hb_destroy_func_t destroy);
+HB_EXTERN void
+hb_font_funcs_set_cursive_anchor_func (hb_font_funcs_t *ffuncs,
+				       hb_font_get_cursive_anchor_func_t func,
+				       void *user_data,
+				       hb_destroy_func_t destroy);
+
+//added cursive_anchor and substitution for VisualMetaFont
 #define HB_FONT_FUNCS_IMPLEMENT_CALLBACKS \
   HB_FONT_FUNC_IMPLEMENT (font_h_extents) \
   HB_FONT_FUNC_IMPLEMENT (font_v_extents) \
@@ -57,6 +121,9 @@
   HB_FONT_FUNC_IMPLEMENT (glyph_contour_point) \
   HB_FONT_FUNC_IMPLEMENT (glyph_name) \
   HB_FONT_FUNC_IMPLEMENT (glyph_from_name) \
+  HB_FONT_FUNC_IMPLEMENT (cursive_anchor) \
+  HB_FONT_FUNC_IMPLEMENT (substitution) \
+  HB_FONT_FUNC_IMPLEMENT (apply_lookup) \
   /* ^--- Add new callbacks here */
 
 struct hb_font_funcs_t
@@ -369,7 +436,32 @@
 					 klass->user_data.glyph_from_name);
   }
 
+  //VisualMetaFont
+  hb_bool_t
+  get_cursive_anchor (hb_cursive_anchor_context_t *context,
+				hb_position_t *x,
+				hb_position_t *y)
+  {
+   
+    return klass->get.f.cursive_anchor (this, user_data, context, x, y,
+					klass->user_data.cursive_anchor);
+  }
 
+   // VisualMetaFont
+  hb_bool_t get_substitution (hb_substitution_context_t *context)
+  {
+
+    return klass->get.f.substitution(this, user_data, context,klass->user_data.substitution);
+  }
+
+   hb_bool_t get_apply_lookup (OT::hb_ot_apply_context_t *c)
+  {
+
+    return klass->get.f.apply_lookup (this, user_data, c,
+				      klass->user_data.apply_lookup);
+  }
+
+
   /* A bit higher-level, and with fallback */
 
   void get_h_extents_with_fallback (hb_font_extents_t *extents)
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-face-table-list.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-face-table-list.hh	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-face-table-list.hh	(working copy)
@@ -101,6 +101,10 @@
 //HB_OT_TABLE (OT, JSTF)
 #endif
 
+#ifndef HB_NO_JUSTIFICATION
+HB_OT_TABLE (OT, JTST)
+#endif
+
 /* OpenType baseline. */
 #ifndef HB_NO_BASE
 HB_OT_TABLE (OT, BASE)
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-font.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-font.cc	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-font.cc	(working copy)
@@ -110,11 +110,33 @@
   const hb_ot_face_t *ot_face = (const hb_ot_face_t *) font_data;
   const OT::hmtx_accelerator_t &hmtx = *ot_face->hmtx;
 
+#ifndef HB_NO_JUSTIFICATION
+  auto infos = (hb_glyph_info_t *) (first_glyph);
+  auto positions = (hb_glyph_position_t *) (first_advance);
+#endif
   for (unsigned int i = 0; i < count; i++)
   {
+#ifndef HB_NO_JUSTIFICATION
+    if (infos[i].lefttatweel != 0.0 || infos[i].righttatweel != 0.0)
+    {
+      int coords[2];
+      coords[0] = roundf (infos[i].lefttatweel * 16384.f);
+      coords[1] = roundf (infos[i].righttatweel * 16384.f);
+      font->num_coords = 2;
+      font->coords = &coords[0];
+      positions[i].x_advance = font->em_scale_x (hmtx.get_advance (infos[i].codepoint, font));
+      font->num_coords = 0;
+      font->coords = nullptr;
+    }
+    else
+    {
+      positions[i].x_advance = font->em_scale_x (hmtx.get_advance (infos[i].codepoint, font));
+    }
+#else
     *first_advance = font->em_scale_x (hmtx.get_advance (*first_glyph, font));
     first_glyph = &StructAtOffsetUnaligned<hb_codepoint_t> (first_glyph, glyph_stride);
     first_advance = &StructAtOffsetUnaligned<hb_position_t> (first_advance, advance_stride);
+#endif
   }
 }
 
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-common.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-common.hh	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-common.hh	(working copy)
@@ -1100,6 +1100,9 @@
     return_trace (c->default_return_value ());
   }
 
+  // Added by VisualMetaFont
+  template <typename TSubTable>
+  inline bool dispatch (hb_ot_apply_context_t *c) const;
   bool serialize (hb_serialize_context_t *c,
 		  unsigned int lookup_type,
 		  uint32_t lookup_props,
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gpos-table.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gpos-table.hh	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gpos-table.hh	(working copy)
@@ -129,6 +129,10 @@
       if (unlikely (!horizontal)) glyph_pos.y_advance -= font->em_scale_y (get_short (values, &ret));
       values++;
     }
+    
+    // VisualMetaFont
+    glyph_pos.lookup_index = c->lookup_index;
+    glyph_pos.subtable_index = c->subtable_index;
 
     if (!has_device ()) return ret;
 
@@ -650,14 +654,94 @@
     float mark_x, mark_y, base_x, base_y;
 
     buffer->unsafe_to_break (glyph_pos, buffer->idx);
-    mark_anchor.get_anchor (c, buffer->cur().codepoint, &mark_x, &mark_y);
-    glyph_anchor.get_anchor (c, buffer->info[glyph_pos].codepoint, &base_x, &base_y);
 
+    // VisualMetaFont
+    auto infomark = buffer->cur ();
+    if (infomark.lefttatweel != 0 || infomark.righttatweel != 0)
+    {
+      if (buffer->useCallback || c->font->num_coords != 0)
+      {
+	hb_cursive_anchor_context_t anchor_context;
+	anchor_context.glyph_id = buffer->cur ().codepoint;
+	anchor_context.base_glyph_id = buffer->info[glyph_pos].codepoint;
+	anchor_context.lookup_index = c->lookup_index;
+	anchor_context.subtable_index = c->subtable_index;
+	anchor_context.lefttatweel = infomark.lefttatweel;
+	anchor_context.righttatweel = infomark.righttatweel;
+	anchor_context.type = hb_cursive_anchor_context_t::mark;
+	hb_position_t xCoordinate;
+	hb_position_t yCoordinate;
+	c->font->get_cursive_anchor (&anchor_context, &xCoordinate,
+				     &yCoordinate);
+	mark_x = c->font->em_fscale_x (xCoordinate);
+	mark_y = c->font->em_fscale_y (yCoordinate);
+      }
+      else
+      {
+	/* TODO Merge with existing instance . */
+	int coords[2];
+	coords[0] = roundf (infomark.lefttatweel * 16384.f);
+	coords[1] = roundf (infomark.righttatweel * 16384.f);
+	c->font->num_coords = 2;
+	c->font->coords = &coords[0];
+	mark_anchor.get_anchor (c, buffer->cur ().codepoint, &mark_x, &mark_y);	
+	c->font->num_coords = 0;
+	c->font->coords = nullptr;
+      }      
+    }
+    else
+    {
+      mark_anchor.get_anchor (c, buffer->cur ().codepoint, &mark_x, &mark_y);
+    }
+
+    // VisualMetaFont
+    if (buffer->info[glyph_pos].lefttatweel != 0 ||
+	buffer->info[glyph_pos].righttatweel != 0)
+    {
+      if (buffer->useCallback || c->font->num_coords != 0) {
+	hb_cursive_anchor_context_t anchor_context;
+	anchor_context.glyph_id = buffer->cur ().codepoint;
+	anchor_context.base_glyph_id = buffer->info[glyph_pos].codepoint;
+	anchor_context.lookup_index = c->lookup_index;
+	anchor_context.subtable_index = c->subtable_index;
+	anchor_context.lefttatweel = buffer->info[glyph_pos].lefttatweel;
+	anchor_context.righttatweel = buffer->info[glyph_pos].righttatweel;
+	anchor_context.type = hb_cursive_anchor_context_t::base;
+	hb_position_t xCoordinate;
+	hb_position_t yCoordinate;
+	c->font->get_cursive_anchor (&anchor_context, &xCoordinate,
+				     &yCoordinate);
+	base_x = c->font->em_fscale_x (xCoordinate);
+	base_y = c->font->em_fscale_y (yCoordinate);
+      }
+      else
+      {
+	/* TODO Merge with existing instance . */
+	int coords[2];
+	coords[0] = roundf (buffer->info[glyph_pos].lefttatweel * 16384.f);
+	coords[1] = roundf (buffer->info[glyph_pos].righttatweel * 16384.f);
+	c->font->num_coords = 2;
+	c->font->coords = &coords[0];
+	glyph_anchor.get_anchor (c, buffer->info[glyph_pos].codepoint, &base_x, &base_y);
+	c->font->num_coords = 0;
+	c->font->coords = nullptr;
+      }      
+    }
+    else
+    {
+      glyph_anchor.get_anchor (c, buffer->info[glyph_pos].codepoint, &base_x, &base_y);
+    }
+
     hb_glyph_position_t &o = buffer->cur_pos();
     o.x_offset = roundf (base_x - mark_x);
     o.y_offset = roundf (base_y - mark_y);
     o.attach_type() = ATTACH_TYPE_MARK;
     o.attach_chain() = (int) glyph_pos - (int) buffer->idx;
+    // VisualMetaFont
+    o.lookup_index = c->lookup_index;
+    o.subtable_index = c->subtable_index;
+    o.base_codepoint = buffer->info[glyph_pos].codepoint;
+
     buffer->scratch_flags |= HB_BUFFER_SCRATCH_FLAG_HAS_GPOS_ATTACHMENT;
 
     buffer->idx++;
@@ -914,6 +998,121 @@
   DEFINE_SIZE_ARRAY (8, values);
 };
 
+// Added for VisualMetaFont for coloring glyph
+
+struct SinglePosFormat3
+{
+  bool intersects (const hb_set_t *glyphs) const
+  {
+    return (this + coverage).intersects (glyphs);
+  }
+
+  void closure_lookups (hb_closure_lookups_context_t *c) const {}
+  void collect_variation_indices (hb_collect_variation_indices_context_t *c) const
+  {
+    if (!valueFormat.has_device ()) return;
+
+    auto it = +hb_iter (this + coverage) | hb_filter (c->glyph_set);
+
+    if (!it) return;
+    valueFormat.collect_variation_indices (
+	c, this, values.as_array (valueFormat.get_len ()));
+  }
+
+  void collect_glyphs (hb_collect_glyphs_context_t *c) const
+  {
+    if (unlikely (!(this + coverage).collect_coverage (c->input))) return;
+  }
+
+  const Coverage &get_coverage () const { return this + coverage; }
+
+  bool apply (hb_ot_apply_context_t *c) const
+  {
+    TRACE_APPLY (this);
+    hb_buffer_t *buffer = c->buffer;
+    unsigned int index =
+	(this + coverage).get_coverage (buffer->cur ().codepoint);
+    if (likely (index == NOT_COVERED)) return_trace (false);
+
+    if (likely (index >= valueCount)) return_trace (false);
+
+    /*valueFormat.apply_value (c, this, &values[index * valueFormat.get_len ()],
+			     buffer->cur_pos ());*/
+    const Value *mvalues = &values[index * valueFormat.get_len ()];
+
+    auto p1 = *reinterpret_cast<const HBINT16 *> (mvalues++);
+    auto p2 = *reinterpret_cast<const HBINT16 *> (mvalues++);
+    auto p3 = *reinterpret_cast<const HBINT16 *> (mvalues++);
+    auto p4 = *reinterpret_cast<const HBINT16 *> (mvalues);
+
+    buffer->cur_pos ().base_codepoint =
+	(p1 << 24) + (p2 << 16) + (p3 << 8) + p4;
+    buffer->cur_pos ().lookup_index = c->lookup_index;
+    buffer->cur_pos ().subtable_index = c->subtable_index;
+    
+
+    buffer->idx++;
+    return_trace (true);
+  }
+
+  template <typename Iterator, hb_requires (hb_is_iterator (Iterator))>
+  void serialize (hb_serialize_context_t *c, Iterator it, ValueFormat valFormat)
+  {
+    if (unlikely (!c->extend_min (*this))) return;
+    if (unlikely (!c->check_assign (valueFormat, valFormat))) return;
+    if (unlikely (!c->check_assign (valueCount, it.len ()))) return;
+
+    for (auto iter : it) c->copy_all (iter.second);
+
+    auto glyphs = +it | hb_map_retains_sorting (hb_first);
+
+    coverage.serialize (c, this).serialize (c, glyphs);
+  }
+
+  bool subset (hb_subset_context_t *c) const
+  {
+    TRACE_SUBSET (this);
+    const hb_set_t &glyphset = *c->plan->glyphset ();
+    const hb_map_t &glyph_map = *c->plan->glyph_map;
+
+    unsigned sub_length = valueFormat.get_len ();
+    auto values_array = values.as_array (valueCount * sub_length);
+
+    auto it = +hb_zip (this + coverage, hb_range ((unsigned) valueCount)) |
+	      hb_filter (glyphset, hb_first) |
+	      hb_map_retains_sorting (
+		  [&] (const hb_pair_t<hb_codepoint_t, unsigned> &_) {
+		    return hb_pair (glyph_map[_.first],
+				    values_array.sub_array (
+					_.second * sub_length, sub_length));
+		  });
+
+    bool ret = bool (it);
+    SinglePos_serialize (c->serializer, this, it, valueFormat,
+			 c->plan->layout_variation_idx_map);
+    return_trace (ret);
+  }
+
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (c->check_struct (this) && coverage.sanitize (c, this) &&
+		  valueFormat.sanitize_values (c, this, values, valueCount));
+  }
+
+  protected:
+  HBUINT16 format;	       /* Format identifier--format = 2 */
+  OffsetTo<Coverage> coverage; /* Offset to Coverage table--from
+				* beginning of subtable */
+  ValueFormat valueFormat;     /* Defines the types of data in the
+				* ValueRecord */
+  HBUINT16 valueCount;	       /* Number of ValueRecords */
+  ValueRecord values;	       /* Array of ValueRecords--positioning
+				* values applied to glyphs */
+  public:
+  DEFINE_SIZE_ARRAY (8, values);
+};
+
 struct SinglePos
 {
   template<typename Iterator,
@@ -962,6 +1161,8 @@
     switch (u.format) {
     case 1: return_trace (c->dispatch (u.format1, hb_forward<Ts> (ds)...));
     case 2: return_trace (c->dispatch (u.format2, hb_forward<Ts> (ds)...));
+    // VisualMetaFont
+    case 3: return_trace (c->dispatch (u.format3, hb_forward<Ts> (ds)...));
     default:return_trace (c->default_return_value ());
     }
   }
@@ -971,6 +1172,8 @@
   HBUINT16		format;		/* Format identifier */
   SinglePosFormat1	format1;
   SinglePosFormat2	format2;
+  // VisualMetaFont
+    SinglePosFormat3 format3;
   } u;
 };
 
@@ -1614,10 +1817,81 @@
     unsigned int j = buffer->idx;
 
     buffer->unsafe_to_break (i, j);
-    float entry_x, entry_y, exit_x, exit_y;
-    (this+prev_record.exitAnchor).get_anchor (c, buffer->info[i].codepoint, &exit_x, &exit_y);
-    (this+this_record.entryAnchor).get_anchor (c, buffer->info[j].codepoint, &entry_x, &entry_y);
+    float entry_x, entry_y, exit_x, exit_y;    
+    
+    // VisualMetaFont    
+    if (buffer->info[i].lefttatweel != 0 || buffer->info[i].righttatweel != 0)
+    {
+      if (buffer->useCallback || c->font->num_coords != 0) {
+	hb_cursive_anchor_context_t anchor_context;
+	anchor_context.glyph_id = buffer->info[i].codepoint;
+	anchor_context.lookup_index = c->lookup_index;
+	anchor_context.subtable_index = c->subtable_index;
+	anchor_context.lefttatweel = buffer->info[i].lefttatweel;
+	anchor_context.righttatweel = buffer->info[i].righttatweel;
+	anchor_context.type = hb_cursive_anchor_context_t::exit;
+	hb_position_t xCoordinate;
+	hb_position_t yCoordinate;
+	c->font->get_cursive_anchor (&anchor_context, &xCoordinate,
+				     &yCoordinate);
+	exit_x = c->font->em_fscale_x (xCoordinate);
+	exit_y = c->font->em_fscale_y (yCoordinate);
+      }
+      else
+      {
+	/* TODO Merge with existing instance . */
+	int coords[2];
+	coords[0] = roundf (buffer->info[i].lefttatweel * 16384.f);
+	coords[1] = roundf (buffer->info[i].righttatweel * 16384.f);
+	c->font->num_coords = 2;
+	c->font->coords = &coords[0];
+	(this + prev_record.exitAnchor).get_anchor (c, buffer->info[i].codepoint, &exit_x, &exit_y);
+	c->font->num_coords = 0;
+	c->font->coords = nullptr;
+      }
+      
+    }
+    else
+    {
+      (this + prev_record.exitAnchor).get_anchor (c, buffer->info[i].codepoint, &exit_x, &exit_y);
+    }
 
+    if (buffer->info[j].lefttatweel != 0 || buffer->info[j].righttatweel != 0)
+    {
+      if (buffer->useCallback || c->font->num_coords != 0)
+      {
+	hb_cursive_anchor_context_t anchor_context;
+	anchor_context.glyph_id = buffer->info[j].codepoint;
+	anchor_context.lookup_index = c->lookup_index;
+	anchor_context.subtable_index = c->subtable_index;
+	anchor_context.lefttatweel = buffer->info[j].lefttatweel;
+	anchor_context.righttatweel = buffer->info[j].righttatweel;
+	anchor_context.type = hb_cursive_anchor_context_t::entry;
+	hb_position_t xCoordinate;
+	hb_position_t yCoordinate;
+	c->font->get_cursive_anchor (&anchor_context, &xCoordinate,
+				     &yCoordinate);
+	entry_x = c->font->em_fscale_x (xCoordinate);
+	entry_y = c->font->em_fscale_y (yCoordinate);
+      }
+      else
+      {
+	/* TODO Merge with existing instance . */
+	int coords[2];
+	coords[0] = roundf (buffer->info[j].lefttatweel * 16384.f);
+	coords[1] = roundf (buffer->info[j].righttatweel * 16384.f);
+	c->font->num_coords = 2;
+	c->font->coords = &coords[0];
+	(this + this_record.entryAnchor).get_anchor (c, buffer->info[j].codepoint, &entry_x, &entry_y);
+	c->font->num_coords = 0;
+	c->font->coords = nullptr;
+      }
+    }
+    else
+    {
+      (this + this_record.entryAnchor).get_anchor (c, buffer->info[j].codepoint, &entry_x, &entry_y);
+    }
+
     hb_glyph_position_t *pos = buffer->pos;
 
     hb_position_t d;
@@ -1699,6 +1973,12 @@
       pos[parent].attach_chain() = 0;
 
     buffer->idx++;
+    
+    // VisualMetaFont
+    pos[j].lookup_index = c->lookup_index;
+    pos[j].subtable_index = c->subtable_index;
+    pos[j].base_codepoint = buffer->info[i].codepoint;
+    
     return_trace (true);
   }
 
@@ -2410,6 +2690,8 @@
 
 struct ChainContextPos : ChainContext {};
 
+struct FSMPos : FSM {};
+
 struct ExtensionPos : Extension<ExtensionPos>
 {
   typedef struct PosLookupSubTable SubTable;
@@ -2436,7 +2718,8 @@
     MarkMark		= 6,
     Context		= 7,
     ChainContext	= 8,
-    Extension		= 9
+    Extension		= 9,
+    FSM			= 20,
   };
 
   template <typename context_t, typename ...Ts>
@@ -2453,6 +2736,7 @@
     case Context:		return_trace (u.context.dispatch (c, hb_forward<Ts> (ds)...));
     case ChainContext:		return_trace (u.chainContext.dispatch (c, hb_forward<Ts> (ds)...));
     case Extension:		return_trace (u.extension.dispatch (c, hb_forward<Ts> (ds)...));
+    case FSM:			return_trace (u.fsmPos.dispatch (c, hb_forward<Ts> (ds)...));
     default:			return_trace (c->default_return_value ());
     }
   }
@@ -2474,6 +2758,7 @@
   ContextPos		context;
   ChainContextPos	chainContext;
   ExtensionPos		extension;
+  FSMPos		fsmPos;
   } u;
   public:
   DEFINE_SIZE_MIN (0);
@@ -2733,7 +3018,6 @@
 }
 #endif
 
-
 } /* namespace OT */
 
 
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gsub-table.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gsub-table.hh	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gsub-table.hh	(working copy)
@@ -243,6 +243,288 @@
   DEFINE_SIZE_ARRAY (6, substitute);
 };
 
+// Added for VisualMetaFont
+struct JustParams
+{
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (likely (c->check_struct (this)));
+  }
+
+  HBGlyphID substitute;
+  HBFixed minLeftTatweel;
+  HBFixed maxLeftTatweel;
+  HBFixed minRightTatweel;
+  HBFixed maxRightTatweel;
+  HBUINT16 weight;
+  HBUINT32 flags;
+
+  public:
+  DEFINE_SIZE_STATIC (24);
+};
+
+// Added for VisualMetaFont
+struct SingleSubstFormat10
+{
+  bool intersects (const hb_set_t *glyphs) const
+  {
+    return (this + coverage).intersects (glyphs);
+  }
+
+  void closure_lookups (hb_closure_lookups_context_t *c) const {}
+
+  void closure (hb_closure_context_t *c) const
+  {
+    /*
+    +hb_zip (this + coverage, substitute) | hb_filter (*c->glyphs, hb_first) |
+	hb_map (hb_second) | hb_sink (c->output);*/
+  }
+
+  void collect_glyphs (hb_collect_glyphs_context_t *c) const
+  {
+    /*
+    if (unlikely (!(this + coverage).add_coverage (c->input))) return;
+    +hb_zip (this + coverage, substitute) | hb_map (hb_second) |
+	hb_sink (c->output);*/
+  }
+
+  const Coverage &get_coverage () const { return this + coverage; }
+
+  bool would_apply (hb_would_apply_context_t *c) const
+  {
+    return c->len == 1 &&
+	   (this + coverage).get_coverage (c->glyphs[0]) != NOT_COVERED;
+  }
+
+  bool apply (hb_ot_apply_context_t *c) const
+  {
+    TRACE_APPLY (this);
+    unsigned int index =
+	(this + coverage).get_coverage (c->buffer->cur ().codepoint);
+    if (likely (index == NOT_COVERED)) return_trace (false);
+
+    if (unlikely (index >= substitute.len)) return_trace (false);
+
+    // VisualMetaFont
+    //c->replace_glyph (substitute[index]);
+
+    //return_trace (true);
+#ifndef HB_NO_JUSTIFICATION
+    if (c->buffer->justContext != nullptr) {
+      OT::JustificationContext &justContext = *c->buffer->justContext;
+      justContext.GlyphsToExtend.push_back (c->buffer->idx);
+      justContext.Substitutes.push_back (substitute[index].substitute);
+
+      OT::GlyphExpansion expa;
+
+      expa.MinLeftTatweel = substitute[index].minLeftTatweel.to_float();
+      expa.MaxLeftTatweel = substitute[index].maxLeftTatweel.to_float ();
+      expa.MinRightTatweel = substitute[index].minRightTatweel.to_float ();
+      expa.MaxRightTatweel = substitute[index].maxRightTatweel.to_float ();
+      expa.weight = substitute[index].weight;
+      expa.startEndLig = (StartEndLig) (substitute[index].flags & 7);
+      expa.stretchIsAbsolute = substitute[index].flags & 8;
+      expa.shrinkIsAbsolute = substitute[index].flags & 16;
+
+      justContext.Expansions.insert ({c->buffer->idx, expa});
+      justContext.totalWeight += expa.weight;
+    }    
+#endif
+
+    hb_substitution_context_t substitution_context;
+
+    substitution_context.ot_context = c;
+    substitution_context.substitute = substitute[index].substitute;
+
+    auto result = c->font->get_substitution (&substitution_context);
+
+    if (result) c->replace_glyph (substitute[index].substitute);
+
+    return_trace (result);
+
+  }
+
+  template <typename Iterator,
+	    hb_requires (hb_is_sorted_source_of (Iterator,
+						 hb_codepoint_pair_t))>
+  bool serialize (hb_serialize_context_t *c, Iterator it)
+  {
+    /*
+    TRACE_SERIALIZE (this);
+    auto substitutes = +it | hb_map (hb_second);
+    auto glyphs = +it | hb_map_retains_sorting (hb_first);
+    if (unlikely (!c->extend_min (*this))) return_trace (false);
+    if (unlikely (!substitute.serialize (c, substitutes))) return_trace (false);
+    if (unlikely (!coverage.serialize (c, this).serialize (c, glyphs)))
+      return_trace (false);*/
+    return true;
+  }
+
+  bool subset (hb_subset_context_t *c) const
+  {
+    /*
+    TRACE_SUBSET (this);
+    const hb_set_t &glyphset = *c->plan->glyphset_gsub ();
+    const hb_map_t &glyph_map = *c->plan->glyph_map;
+
+    auto it = +hb_zip (this + coverage, substitute) |
+	      hb_filter (glyphset, hb_first) | hb_filter (glyphset, hb_second) |
+	      hb_map_retains_sorting (
+		  [&] (hb_pair_t<hb_codepoint_t, const HBGlyphID &> p)
+		      -> hb_codepoint_pair_t {
+		    return hb_pair (glyph_map[p.first], glyph_map[p.second]);
+		  });
+
+    bool ret = bool (it);
+    SingleSubst_serialize (c->serializer, it);
+    return_trace (ret);*/
+    return true;
+  }
+
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (coverage.sanitize (c, this) && substitute.sanitize (c));
+  }
+
+  protected:
+  HBUINT16 format;		 /* Format identifier--format = 2 */
+  OffsetTo<Coverage> coverage;	 /* Offset to Coverage table--from
+				  * beginning of Substitution table */
+  ArrayOf<JustParams> substitute; /* Array of substitute
+				  * GlyphIDs--ordered by Coverage Index */
+  public:
+  DEFINE_SIZE_ARRAY (6, substitute);
+};
+
+// Added for VisualMetaFont
+struct AdjustTatweel
+{
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (likely (c->check_struct (this)));
+  }
+
+  HBGlyphID substitute;
+  HBFixed leftTatweel;
+  HBFixed rightTatweel;
+
+  public:
+  DEFINE_SIZE_STATIC (10);
+};
+
+// Added for VisualMetaFont (substitute with expansion)
+struct SingleSubstFormat11
+{
+  void closure_lookups (hb_closure_lookups_context_t *c) const {}
+
+  bool intersects (const hb_set_t *glyphs) const
+  {
+    return (this + coverage).intersects (glyphs);
+  }
+  
+  void closure (hb_closure_context_t *c) const
+  {
+    /*
+    +hb_zip (this + coverage, tatweel) | hb_filter (*c->glyphs, hb_first) |
+	hb_map (hb_second) | hb_sink (c->output);*/
+  }
+  
+  void collect_glyphs (hb_collect_glyphs_context_t *c) const
+  {
+    /*
+    if (unlikely (!(this + coverage).add_coverage (c->input))) return;
+    +hb_zip (this + coverage, tatweel) | hb_map (hb_second) |
+	hb_sink (c->output);*/
+  }
+
+  const Coverage &get_coverage () const { return this + coverage; }
+
+  bool would_apply (hb_would_apply_context_t *c) const
+  {
+    return c->len == 1 &&
+	   (this + coverage).get_coverage (c->glyphs[0]) != NOT_COVERED;
+  }
+
+  bool apply (hb_ot_apply_context_t *c) const
+  {
+    TRACE_APPLY (this);
+    unsigned int index =
+	(this + coverage).get_coverage (c->buffer->cur ().codepoint);
+    if (likely (index == NOT_COVERED)) return_trace (false);
+
+    if (unlikely (index >= tatweel.len)) return_trace (false);
+
+    auto tat = tatweel[index];
+
+    auto& info = c->buffer->cur ();    
+
+    info.lefttatweel += tat.leftTatweel.to_float ();
+    info.righttatweel += tat.rightTatweel.to_float ();
+
+    c->replace_glyph (tat.substitute);
+
+    return_trace (true);
+  }
+
+  template <typename Iterator,
+	    hb_requires (hb_is_sorted_source_of (Iterator,
+						 hb_codepoint_pair_t))>
+  bool serialize (hb_serialize_context_t *c, Iterator it)
+  {
+    /*
+    TRACE_SERIALIZE (this);
+    auto tatweels = +it | hb_map (hb_second);
+    auto glyphs = +it | hb_map_retains_sorting (hb_first);
+    if (unlikely (!c->extend_min (*this))) return_trace (false);
+    if (unlikely (!tatweel.serialize (c, tatweels))) return_trace (false);
+    if (unlikely (!coverage.serialize (c, this).serialize (c, glyphs)))
+      return_trace (false);
+    return_trace (true);*/
+
+    return false;
+  }
+
+  bool subset (hb_subset_context_t *c) const
+  {
+    /*
+    TRACE_SUBSET (this);
+    const hb_set_t &glyphset = *c->plan->glyphset_gsub ();
+    const hb_map_t &glyph_map = *c->plan->glyph_map;
+
+    auto it = +hb_zip (this + coverage, tatweel) |
+	      hb_filter (glyphset, hb_first) | hb_filter (glyphset, hb_second) |
+	      hb_map_retains_sorting (
+		  [&] (hb_pair_t<hb_codepoint_t, const HBGlyphID &> p)
+		      -> hb_codepoint_pair_t {
+		    return hb_pair (glyph_map[p.first], glyph_map[p.second]);
+		  });
+
+    bool ret = bool (it);
+    SingleSubst_serialize (c->serializer, it);
+    return_trace (ret);*/
+
+    return false;
+  }
+
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (coverage.sanitize (c, this) && tatweel.sanitize (c));
+  }
+
+  protected:
+  HBUINT16 format;	       /* Format identifier--format = 2 */
+  OffsetTo<Coverage> coverage; /* Offset to Coverage table--from
+				* beginning of Substitution table */
+  ArrayOf<AdjustTatweel> tatweel;
+
+  public:
+  DEFINE_SIZE_ARRAY (6, tatweel);
+};
+
 struct SingleSubst
 {
 
@@ -271,6 +553,8 @@
 					       | hb_map_retains_sorting (hb_first),
 					       delta));
     case 2: return_trace (u.format2.serialize (c, glyphs));
+    case 10: return_trace (u.format10.serialize (c, glyphs)); // VisualMetaFont
+    case 11: return_trace (u.format11.serialize (c, glyphs)); // VisualMetaFont
     default:return_trace (false);
     }
   }
@@ -283,6 +567,8 @@
     switch (u.format) {
     case 1: return_trace (c->dispatch (u.format1, hb_forward<Ts> (ds)...));
     case 2: return_trace (c->dispatch (u.format2, hb_forward<Ts> (ds)...));
+    case 10: return_trace (c->dispatch (u.format10, hb_forward<Ts> (ds)...)); // VisualMetaFont
+    case 11: return_trace (c->dispatch (u.format11, hb_forward<Ts> (ds)...)); // VisualMetaFont
     default:return_trace (c->default_return_value ());
     }
   }
@@ -292,6 +578,8 @@
   HBUINT16		format;		/* Format identifier */
   SingleSubstFormat1	format1;
   SingleSubstFormat2	format2;
+  SingleSubstFormat10 format10; // VisualMetaFont  
+  SingleSubstFormat11 format11; // VisualMetaFont
   } u;
 };
 
@@ -1143,6 +1431,8 @@
 
 struct ChainContextSubst : ChainContext {};
 
+struct FSMSubst : FSM {};
+
 struct ExtensionSubst : Extension<ExtensionSubst>
 {
   typedef struct SubstLookupSubTable SubTable;
@@ -1328,7 +1618,8 @@
     Context		= 5,
     ChainContext	= 6,
     Extension		= 7,
-    ReverseChainSingle	= 8
+    ReverseChainSingle	= 8,
+    FSM			= 20,
   };
 
   template <typename context_t, typename ...Ts>
@@ -1344,6 +1635,7 @@
     case ChainContext:		return_trace (u.chainContext.dispatch (c, hb_forward<Ts> (ds)...));
     case Extension:		return_trace (u.extension.dispatch (c, hb_forward<Ts> (ds)...));
     case ReverseChainSingle:	return_trace (u.reverseChainContextSingle.dispatch (c, hb_forward<Ts> (ds)...));
+    case FSM:			return_trace (u.fsmSubst.dispatch (c, hb_forward<Ts> (ds)...));
     default:			return_trace (c->default_return_value ());
     }
   }
@@ -1364,6 +1656,7 @@
   ChainContextSubst		chainContext;
   ExtensionSubst		extension;
   ReverseChainSingleSubst	reverseChainContextSingle;
+  FSMSubst			fsmSubst;
   } u;
   public:
   DEFINE_SIZE_MIN (0);
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gsubgpos.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gsubgpos.hh	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-gsubgpos.hh	(working copy)
@@ -534,6 +534,8 @@
   hb_mask_t lookup_mask;
   unsigned int table_index; /* GSUB/GPOS */
   unsigned int lookup_index;
+  //VisualMetaFont
+  unsigned int subtable_index;
   unsigned int lookup_props;
   unsigned int nesting_level_left;
 
@@ -681,7 +683,24 @@
   }
 };
 
+// Added for VisualMetaFont
+template <typename TSubTable>
+inline bool Lookup::dispatch (hb_ot_apply_context_t *c) const
+{
+  unsigned int lookup_type = get_type ();
+  // TRACE_DISPATCH (this, lookup_type);
+  hb_no_trace_t<bool> trace;
+  unsigned int count = get_subtable_count ();
+  for (unsigned int i = 0; i < count; i++)
+  {
+    c->subtable_index = i;
+    bool r = get_subtable<TSubTable> (i).dispatch (c, lookup_type);
+    if (c->stop_sublookup_iteration (r)) return_trace (r);
+  }
+  return_trace (c->default_return_value ());
+}
 
+
 struct hb_get_subtables_context_t :
        hb_dispatch_context_t<hb_get_subtables_context_t>
 {
@@ -3186,8 +3205,12 @@
   bool apply (hb_ot_apply_context_t *c) const
   {
     for (unsigned int i = 0; i < subtables.length; i++)
+    {
+      // VisualMetaFont
+      c->subtable_index = i;
       if (subtables[i].apply (c))
 	return true;
+    }
     return false;
   }
 
@@ -3419,7 +3442,84 @@
   DEFINE_SIZE_MIN (10);
 };
 
+struct FSMFormat1
+{
+  void closure_lookups (hb_closure_lookups_context_t *c) const {}
 
+  void collect_variation_indices (hb_collect_variation_indices_context_t *c) const {}
+
+  bool intersects (const hb_set_t *glyphs) const
+  {
+    return true;
+  }
+
+  void closure (hb_closure_context_t *c) const
+  {
+    
+  }
+
+  void collect_glyphs (hb_collect_glyphs_context_t *c) const
+  {
+    
+  }
+
+  bool would_apply (hb_would_apply_context_t *c) const
+  {
+    return true;
+  }
+
+  const Coverage &get_coverage () const
+  {    
+    return coverage;
+  }
+
+  bool apply (hb_ot_apply_context_t *c) const
+  {
+
+    c->font->get_apply_lookup (c);
+
+    return false;
+  }
+
+  bool subset (hb_subset_context_t *c) const
+  {
+    return true;
+  }
+
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    return true;
+  }
+
+  private:
+  Coverage coverage;
+};
+
+struct FSM
+{
+  template <typename context_t, typename... Ts>
+  typename context_t::return_t dispatch (context_t *c, Ts &&... ds) const
+  {
+    TRACE_DISPATCH (this, u.format);
+    if (unlikely (!c->may_dispatch (this, &u.format)))
+      return_trace (c->no_dispatch_return_value ());
+    switch (u.format)
+    {
+    case 1: return_trace (c->dispatch (u.format1, hb_forward<Ts> (ds)...));
+    default: return_trace (c->default_return_value ());
+    }
+  }
+
+  protected:
+  union
+  {
+    HBUINT16 format; /* Format identifier */
+    FSMFormat1 format1;
+  } u;
+};
+
+
+
 } /* namespace OT */
 
 
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-context.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-context.cc	(nonexistent)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-context.cc	(working copy)
@@ -0,0 +1,348 @@
+#include "hb-ot-layout-jtst-context.hh"
+#include "hb-font.hh"
+#include "hb-ot-layout-gsubgpos.hh"
+
+namespace OT {
+
+JustificationContext::JustificationContext (hb_font_t *font) : font{font}
+{
+  minSpace = font->em_scale_x (MINSPACEWIDTH);
+  defaultSpace = font->em_scale_x (SPACEWIDTH);
+}
+
+int
+JustificationContext::getWidth (hb_buffer_t *buffer, int* minLineWidth)
+{
+  int maxCurrentlineWidth = 0;
+  int currentlineWidth = 0;
+  unsigned int glyph_count;
+
+  hb_glyph_position_t *glyph_pos =
+      hb_buffer_get_glyph_positions (buffer, &glyph_count);
+  hb_glyph_info_t *glyph_info =
+      hb_buffer_get_glyph_infos (buffer, &glyph_count);
+
+  std::vector<int> spaces;
+
+  for (unsigned int i = 0; i < glyph_count; i++)
+  {
+    currentlineWidth += glyph_pos[i].x_advance;
+    if (glyph_info[i].codepoint == 32)
+    {      
+      spaces.push_back (i);
+    }
+    else
+    {
+      maxCurrentlineWidth += glyph_pos[i].x_advance;
+    }
+  }
+
+  if (minLineWidth != nullptr) {
+    *minLineWidth = maxCurrentlineWidth + spaces.size () * (double) minSpace;
+  }
+
+  maxCurrentlineWidth += spaces.size () * (double) defaultSpace;
+
+  return currentlineWidth;
+}
+void
+JustificationContext::justify (int &diff,
+			       hb_buffer_t *buffer,
+			       hb_glyph_position_t *glyph_pos)
+{
+  unsigned int glyph_count;
+
+  hb_glyph_info_t *glyph_info =
+      hb_buffer_get_glyph_infos (buffer, &glyph_count);
+
+  int totalWeight = this->totalWeight;
+
+  bool remaining = true;
+
+  double remainingWidth = -1;
+
+  bool stretch = diff > 0;
+
+  while (totalWeight != 0 && remaining && remainingWidth != 0.0)
+  {
+
+    double expaUnit = (double)diff / totalWeight;
+    if (expaUnit == 0.0)
+    {
+      diff = 0.0;
+      break;
+      ;
+    }
+
+    totalWeight = 0;
+
+    std::map<int, GlyphExpansion> affectedIndexes;
+
+    bool insideGroup = false;
+    hb_position_t oldWidth = 0;
+    hb_position_t newWidth = 0;
+    GlyphExpansion groupExpa{};
+    groupExpa.weight = 0;
+    std::vector<int> group;
+    remaining = false;
+    remainingWidth = 0.0;
+
+    for (unsigned int i = 0; i < this->GlyphsToExtend.size (); i++)
+    {
+
+      int index = this->GlyphsToExtend[i];
+
+      GlyphExpansion &expa = this->Expansions[index];
+
+      if (expa.stretchIsAbsolute)
+      {
+	expa.MaxLeftTatweel =
+	    expa.MaxLeftTatweel - glyph_info[index].lefttatweel;
+	expa.MaxRightTatweel =
+	    expa.MaxRightTatweel - glyph_info[index].righttatweel;
+	expa.stretchIsAbsolute = false;
+      }
+
+      if (expa.shrinkIsAbsolute)
+      {
+	expa.MinLeftTatweel =
+	    expa.MinLeftTatweel - glyph_info[index].lefttatweel;
+	expa.MinRightTatweel =
+	    expa.MinRightTatweel - glyph_info[index].righttatweel;
+	expa.shrinkIsAbsolute = false;
+      }
+
+      group.push_back (i);
+      oldWidth += glyph_pos[index].x_advance;
+      if (glyph_info[index].codepoint == this->Substitutes[i])
+      { newWidth += glyph_pos[index].x_advance; }
+      else
+      {
+	hb_position_t advance = 0;
+	hb_glyph_info_t info;
+	info.codepoint = this->Substitutes[i];
+	info.lefttatweel = glyph_pos[index].lefttatweel;
+	info.righttatweel = glyph_pos[index].righttatweel;
+
+	font->get_glyph_h_advances (1, &info.codepoint, sizeof (info), &advance,
+				    0);
+
+	newWidth += advance;
+      }
+
+      groupExpa.weight += expa.weight;
+      groupExpa.MinLeftTatweel += expa.MinLeftTatweel;
+      groupExpa.MaxLeftTatweel += expa.MaxLeftTatweel;
+      groupExpa.MinRightTatweel += expa.MinRightTatweel;
+      groupExpa.MaxRightTatweel += expa.MaxRightTatweel;
+
+      if (expa.startEndLig == StartEndLig::Start)
+      {
+	insideGroup = true;
+	continue;
+      }
+      else if (insideGroup && expa.startEndLig != StartEndLig::End &&
+	       expa.startEndLig != StartEndLig::EndKashida)
+      {
+	continue;
+      }
+
+      if (groupExpa.weight != 0) {
+	int widthDiff = newWidth - oldWidth;
+
+	auto tatweel = expaUnit * groupExpa.weight + remainingWidth;
+
+	if ((stretch && widthDiff > tatweel) ||
+	    (!stretch && widthDiff < tatweel))
+	{
+	  totalWeight += groupExpa.weight;
+	  remainingWidth = tatweel;
+	}
+	else
+	{
+
+	  diff -= widthDiff;
+	  tatweel -= widthDiff;
+
+	  for (int i : group)
+	  {
+
+	    int index = this->GlyphsToExtend[i];
+	    GlyphExpansion &expa = this->Expansions[index];
+
+	    glyph_info[index].codepoint = this->Substitutes[i];
+
+	    if (stretch)
+	    {
+	      expa.MaxLeftTatweel =
+		  expa.MaxLeftTatweel > 0 ? expa.MaxLeftTatweel : 0;
+	      expa.MaxRightTatweel =
+		  expa.MaxRightTatweel > 0 ? expa.MaxRightTatweel : 0;
+
+	      auto maxTatweel = expa.MaxLeftTatweel + expa.MaxRightTatweel;
+	      hb_position_t maxStretch = 0;
+	      if (maxTatweel != 0)
+	      {
+
+		hb_position_t actualWidth = 0;
+		hb_position_t maxWidth = 0;
+		hb_glyph_info_t info;
+		info.codepoint = glyph_info[index].codepoint;
+		info.lefttatweel = glyph_info[index].lefttatweel;
+		info.righttatweel = glyph_info[index].righttatweel;
+
+		font->get_glyph_h_advances (1, &info.codepoint, sizeof (info),
+					    &actualWidth, 0);
+
+		info.lefttatweel =
+		    glyph_info[index].lefttatweel + expa.MaxLeftTatweel;
+		info.righttatweel =
+		    glyph_info[index].righttatweel + expa.MaxRightTatweel;
+
+		font->get_glyph_h_advances (1, &info.codepoint, sizeof (info),
+					    &maxWidth, 0);
+
+		maxStretch = maxWidth - actualWidth;
+	      }
+	      if (maxStretch != 0)
+	      {
+
+		double ratio = maxTatweel / maxStretch;
+
+		// auto maxStretch = maxTatweel * nuqta;
+
+		if (tatweel > maxStretch)
+		{
+		  remainingWidth = tatweel - maxStretch;
+		  tatweel = maxStretch;
+		}
+		else
+		{
+		  remainingWidth = 0;
+		}
+
+		double leftTatweel =
+		    (tatweel * (expa.MaxLeftTatweel / maxTatweel)) * ratio;
+		// / nuqta;
+		double rightTatweel =
+		    (tatweel * (expa.MaxRightTatweel / maxTatweel)) * ratio;
+		// / nuqta;
+
+		glyph_info[index].lefttatweel += leftTatweel;
+		glyph_info[index].righttatweel += rightTatweel;
+		/*
+		if (std::isnan (glyph_info[index].lefttatweel) ||
+		    std::isnan (glyph_info[index].righttatweel))
+		{ int stop = 5; }*/
+
+		diff -= tatweel;
+
+		if (maxStretch > tatweel)
+		{
+		  expa.MaxLeftTatweel -= leftTatweel;
+		  expa.MaxRightTatweel -= rightTatweel;
+		  remaining = true;
+		  totalWeight += expa.weight;
+		}
+		else
+		{
+		  expa.weight = 0;
+		}
+	      }
+	      else
+	      {
+		expa.weight = 0;
+	      }
+	    }
+	    else
+	    {
+	      expa.MinLeftTatweel =
+		  expa.MinLeftTatweel < 0 ? expa.MinLeftTatweel : 0;
+	      expa.MinRightTatweel =
+		  expa.MinRightTatweel < 0 ? expa.MinRightTatweel : 0;
+
+	      auto MinTatweel = expa.MinLeftTatweel + expa.MinRightTatweel;
+	      hb_position_t maxShrink = 0;
+	      if (MinTatweel != 0)
+	      {
+		hb_position_t actualWidth = 0;
+		hb_position_t maxWidth = 0;
+		hb_glyph_info_t info;
+		info.codepoint = glyph_info[index].codepoint;
+		info.lefttatweel = glyph_info[index].lefttatweel;
+		info.righttatweel = glyph_info[index].righttatweel;
+
+		font->get_glyph_h_advances (1, &info.codepoint, sizeof (info),
+					    &actualWidth, 0);
+
+		info.lefttatweel =
+		    glyph_info[index].lefttatweel + expa.MinLeftTatweel;
+		info.righttatweel =
+		    glyph_info[index].righttatweel + expa.MinRightTatweel;
+
+		font->get_glyph_h_advances (1, &info.codepoint, sizeof (info),
+					    &maxWidth, 0);
+
+		maxShrink = maxWidth - actualWidth;
+	      }
+	      if (maxShrink != 0)
+	      {
+
+		// auto maxShrink = MinTatweel * nuqta;
+		double ratio = std::abs (MinTatweel / maxShrink);
+
+		if (tatweel < maxShrink)
+		{
+		  remainingWidth = tatweel - maxShrink;
+		  tatweel = maxShrink;
+		}
+		else
+		{
+		  remainingWidth = 0;
+		}
+
+		double leftTatweel =
+		    (tatweel * (expa.MinLeftTatweel / MinTatweel)) * ratio;
+		double rightTatweel =
+		    (tatweel * (expa.MinRightTatweel / MinTatweel)) * ratio;
+
+		/*
+		if (std::isnan (leftTatweel) || std::isnan (rightTatweel))
+		{ int stop = 5; }*/
+
+		glyph_info[index].lefttatweel += leftTatweel;
+		glyph_info[index].righttatweel += rightTatweel;
+
+		diff -= tatweel;
+
+		if (tatweel > maxShrink)
+		{
+		  expa.MinLeftTatweel -= leftTatweel;
+		  expa.MinRightTatweel -= rightTatweel;
+		  remaining = true;
+		  totalWeight += expa.weight;
+		}
+		else
+		{
+		  expa.weight = 0;
+		}
+	      }
+	      else
+	      {
+		expa.weight = 0;
+	      }
+	    }
+	  }
+	}
+      }
+      insideGroup = false;
+      oldWidth = 0.0;
+      newWidth = 0.0;
+      groupExpa = {};
+      groupExpa.weight = 0;
+      group.clear ();
+    }
+  }
+}
+
+} /* namespace OT */
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-context.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-context.hh	(nonexistent)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-context.hh	(working copy)
@@ -0,0 +1,88 @@
+/*
+ * Copyright (c) 2015-2020 Amine Anane. http: //digitalkhatt/license
+ * This file is part of DigitalKhatt.
+ *
+ * DigitalKhatt is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Affero General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+
+ * DigitalKhatt is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU Affero General Public License for more details.
+
+ * You should have received a copy of the GNU Affero General Public License
+ * along with DigitalKhatt. If not, see
+ * <https: //www.gnu.org/licenses />.
+*/
+
+#ifndef HB_OT_LAYOUT_JTST_CONTEXT_HH
+#define HB_OT_LAYOUT_JTST_CONTEXT_HH
+
+
+#include <unordered_map>
+#include <map>
+#include <vector>
+
+#include "hb.hh"
+//#include "hb-ot-layout-jtst-table.hh"
+
+
+
+
+namespace OT {
+
+enum class StartEndLig { StartEnd, Start, End, EndKashida };
+
+struct GlyphExpansion
+{
+  float MinLeftTatweel = 0.0;
+  float MaxLeftTatweel = 0.0;
+  float MinRightTatweel = 0.0;
+  float MaxRightTatweel = 0.0;
+  int weight = 1;
+  int level = 0;
+  StartEndLig startEndLig;
+  bool shrinkIsAbsolute = false;
+  bool stretchIsAbsolute = true;
+};
+
+class JustificationContext
+{
+  public:
+  const int MINSPACEWIDTH = 50;
+  const int SPACEWIDTH = 75;
+  const int MAXSPACEWIDTH = 100;
+
+
+  std::vector<unsigned int> GlyphsToExtend;
+  std::vector<unsigned int> Substitutes;
+  std::unordered_map<unsigned int, GlyphExpansion> Expansions;
+  int totalWeight = 0;
+
+  JustificationContext (hb_font_t *font);
+
+  void clear ()
+  {
+    GlyphsToExtend.clear ();
+    Substitutes.clear ();
+    Expansions.clear ();
+    totalWeight = 0;
+  }
+
+  int getWidth (hb_buffer_t *buffer, int *minLineWidth = nullptr);
+  void justify (int& diff, hb_buffer_t *buffer, hb_glyph_position_t *glyph_pos);
+
+  private:
+  hb_font_t *font;
+  int minSpace;
+  int defaultSpace;
+  
+};
+
+
+
+} /* namespace OT */
+
+#endif /* HB_OT_LAYOUT_JTST_CONTEXT_HH */
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-table.hh
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-table.hh	(nonexistent)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout-jtst-table.hh	(working copy)
@@ -0,0 +1,91 @@
+/*
+ * Copyright (c) 2015-2020 Amine Anane. http: //digitalkhatt/license
+ * This file is part of DigitalKhatt.
+ *
+ * DigitalKhatt is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Affero General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+
+ * DigitalKhatt is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ * GNU Affero General Public License for more details.
+
+ * You should have received a copy of the GNU Affero General Public License
+ * along with DigitalKhatt. If not, see
+ * <https: //www.gnu.org/licenses />.
+*/
+
+#ifndef HB_OT_LAYOUT_JTST_TABLE_HH
+#define HB_OT_LAYOUT_JTST_TABLE_HH
+
+#include "hb-open-type.hh"
+#include "hb-ot-layout-gpos-table.hh"
+
+
+#define HB_OT_TAG_JTST HB_TAG ('J', 'T', 'S', 'T')
+
+namespace OT {
+
+typedef IndexArray JtstLookupList;
+
+struct JtstStep
+{
+  bool isSubtitution () const { return (flags & 1); }
+
+  const JtstLookupList &get_lookups () const { return lookupList; }
+
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (true);
+  }
+
+  protected:
+  HBUINT32 flags;
+  JtstLookupList lookupList;
+};
+
+struct JtstSteps : OffsetListOf<JtstStep>
+{
+  bool sanitize (hb_sanitize_context_t *c,
+		 const Record_sanitize_closure_t * = nullptr) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (OffsetListOf<JtstStep>::sanitize (c));
+  }
+};
+
+
+struct JTST
+{
+  static constexpr hb_tag_t tableTag = HB_OT_TAG_JTST;
+
+  const JtstSteps& get_stretch_steps () const { return this + stretchSteps; }
+  const JtstSteps &get_shrink_steps () const { return this + shrinkSteps; }
+
+  bool sanitize (hb_sanitize_context_t *c) const
+  {
+    TRACE_SANITIZE (this);
+    return_trace (version.sanitize (c)
+      && likely (version.major == 1)
+      && stretchSteps.sanitize (c, this)
+      && shrinkSteps.sanitize (c, this));
+  }
+
+  protected:
+  FixedVersion<> version; /* Version of the JTST table--initially set
+			   * to 0x00010000u */
+
+  OffsetTo<JtstSteps> stretchSteps;
+
+  OffsetTo<JtstSteps> shrinkSteps;
+
+  public:
+    DEFINE_SIZE_STATIC (8);
+};
+
+} /* namespace OT */
+
+#endif /* HB_OT_LAYOUT_JTST_TABLE_HH */
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout.cc	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-layout.cc	(working copy)
@@ -48,6 +48,9 @@
 #include "hb-ot-layout-gpos-table.hh"
 #include "hb-ot-layout-base-table.hh" // Just so we compile it; unused otherwise.
 #include "hb-ot-layout-jstf-table.hh" // Just so we compile it; unused otherwise.
+#ifndef HB_NO_JUSTIFICATION
+#include "hb-ot-layout-jtst-table.hh" 
+#endif
 #include "hb-ot-name-table.hh"
 #include "hb-ot-os2-table.hh"
 
@@ -1851,6 +1854,11 @@
     const stage_map_t *stage = &stages[table_index][stage_index];
     for (; i < stage->last_lookup; i++)
     {
+#ifndef HB_NO_JUSTIFICATION
+      /* TODO hack to disable lookup during justification */
+      if (!lookups[table_index][i].mask)
+	continue;
+#endif
       unsigned int lookup_index = lookups[table_index][i].index;
       if (!buffer->message (font, "start lookup %d", lookup_index)) continue;
       c.set_lookup_index (lookup_index);
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-ot-shape.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-ot-shape.cc	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-ot-shape.cc	(working copy)
@@ -36,10 +36,10 @@
 
 #include "hb-shaper-impl.hh"
 
-#include "hb-ot-shape.hh"
 #include "hb-ot-shape-complex.hh"
 #include "hb-ot-shape-fallback.hh"
 #include "hb-ot-shape-normalize.hh"
+#include "hb-ot-shape.hh"
 
 #include "hb-ot-face.hh"
 
@@ -46,8 +46,11 @@
 #include "hb-set.hh"
 
 #include "hb-aat-layout.hh"
+#ifndef HB_NO_JUSTIFICATION
+#include "hb-ot-layout-jtst-table.hh"
+#include "hb-ot-layout-gsub-table.hh" 
+#endif
 
-
 #ifndef HB_NO_AAT_SHAPE
 static inline bool
 _hb_apply_morx (hb_face_t *face, const hb_segment_properties_t *props)
@@ -67,18 +70,13 @@
  * Support functions for OpenType shaping related queries.
  **/
 
+static void hb_ot_shape_collect_features (hb_ot_shape_planner_t *planner,
+					  const hb_feature_t *user_features,
+					  unsigned int num_user_features);
 
-static void
-hb_ot_shape_collect_features (hb_ot_shape_planner_t          *planner,
-			      const hb_feature_t             *user_features,
-			      unsigned int                    num_user_features);
-
-hb_ot_shape_planner_t::hb_ot_shape_planner_t (hb_face_t                     *face,
-					      const hb_segment_properties_t *props) :
-						face (face),
-						props (*props),
-						map (face, props),
-						aat_map (face, props)
+hb_ot_shape_planner_t::hb_ot_shape_planner_t (
+    hb_face_t *face, const hb_segment_properties_t *props)
+    : face (face), props (*props), map (face, props), aat_map (face, props)
 #ifndef HB_NO_AAT_SHAPE
 						, apply_morx (_hb_apply_morx (face, props))
 #endif
@@ -85,7 +83,8 @@
 {
   shaper = hb_ot_shape_complex_categorize (this);
 
-  script_zero_marks = shaper->zero_width_marks != HB_OT_SHAPE_ZERO_WIDTH_MARKS_NONE;
+  script_zero_marks =
+      shaper->zero_width_marks != HB_OT_SHAPE_ZERO_WIDTH_MARKS_NONE;
   script_fallback_mark_positioning = shaper->fallback_position;
 
   /* https://github.com/harfbuzz/harfbuzz/issues/1528 */
@@ -94,7 +93,7 @@
 }
 
 void
-hb_ot_shape_planner_t::compile (hb_ot_shape_plan_t           &plan,
+hb_ot_shape_planner_t::compile (hb_ot_shape_plan_t &plan,
 				const hb_ot_shape_plan_key_t &key)
 {
   plan.props = props;
@@ -101,32 +100,33 @@
   plan.shaper = shaper;
   map.compile (plan.map, key);
 #ifndef HB_NO_AAT_SHAPE
-  if (apply_morx)
-    aat_map.compile (plan.aat_map);
+  if (apply_morx) aat_map.compile (plan.aat_map);
 #endif
 
 #ifndef HB_NO_OT_SHAPE_FRACTIONS
-  plan.frac_mask = plan.map.get_1_mask (HB_TAG ('f','r','a','c'));
-  plan.numr_mask = plan.map.get_1_mask (HB_TAG ('n','u','m','r'));
-  plan.dnom_mask = plan.map.get_1_mask (HB_TAG ('d','n','o','m'));
+  plan.frac_mask = plan.map.get_1_mask (HB_TAG ('f', 'r', 'a', 'c'));
+  plan.numr_mask = plan.map.get_1_mask (HB_TAG ('n', 'u', 'm', 'r'));
+  plan.dnom_mask = plan.map.get_1_mask (HB_TAG ('d', 'n', 'o', 'm'));
   plan.has_frac = plan.frac_mask || (plan.numr_mask && plan.dnom_mask);
 #endif
 
-  plan.rtlm_mask = plan.map.get_1_mask (HB_TAG ('r','t','l','m'));
-  plan.has_vert = !!plan.map.get_1_mask (HB_TAG ('v','e','r','t'));
+  plan.rtlm_mask = plan.map.get_1_mask (HB_TAG ('r', 't', 'l', 'm'));
+  plan.has_vert = !!plan.map.get_1_mask (HB_TAG ('v', 'e', 'r', 't'));
 
-  hb_tag_t kern_tag = HB_DIRECTION_IS_HORIZONTAL (props.direction) ?
-		      HB_TAG ('k','e','r','n') : HB_TAG ('v','k','r','n');
+  hb_tag_t kern_tag = HB_DIRECTION_IS_HORIZONTAL (props.direction)
+			  ? HB_TAG ('k', 'e', 'r', 'n')
+			  : HB_TAG ('v', 'k', 'r', 'n');
 #ifndef HB_NO_OT_KERN
   plan.kern_mask = plan.map.get_mask (kern_tag);
   plan.requested_kerning = !!plan.kern_mask;
 #endif
 #ifndef HB_NO_AAT_SHAPE
-  plan.trak_mask = plan.map.get_mask (HB_TAG ('t','r','a','k'));
+  plan.trak_mask = plan.map.get_mask (HB_TAG ('t', 'r', 'a', 'k'));
   plan.requested_tracking = !!plan.trak_mask;
 #endif
 
-  bool has_gpos_kern = plan.map.get_feature_index (1, kern_tag) != HB_OT_LAYOUT_NO_FEATURE_INDEX;
+  bool has_gpos_kern =
+      plan.map.get_feature_index (1, kern_tag) != HB_OT_LAYOUT_NO_FEATURE_INDEX;
   bool disable_gpos = plan.shaper->gpos_tag &&
 		      plan.shaper->gpos_tag != plan.map.chosen_script[1];
 
@@ -137,9 +137,9 @@
   if (!hb_ot_layout_has_glyph_classes (face))
     plan.fallback_glyph_classes = true;
 
-  /*
-   * Decide who does substitutions. GSUB, morx, or fallback.
-   */
+    /*
+     * Decide who does substitutions. GSUB, morx, or fallback.
+     */
 
 #ifndef HB_NO_AAT_SHAPE
   plan.apply_morx = apply_morx;
@@ -167,27 +167,26 @@
     else
 #endif
 #ifndef HB_NO_OT_KERN
-    if (hb_ot_layout_has_kerning (face))
+	if (hb_ot_layout_has_kerning (face))
       plan.apply_kern = true;
 #endif
   }
 
-  plan.zero_marks = script_zero_marks &&
-		    !plan.apply_kerx &&
+  plan.zero_marks = script_zero_marks && !plan.apply_kerx &&
 		    (!plan.apply_kern
 #ifndef HB_NO_OT_KERN
 		     || !hb_ot_layout_has_machine_kerning (face)
 #endif
 		    );
-  plan.has_gpos_mark = !!plan.map.get_1_mask (HB_TAG ('m','a','r','k'));
+  plan.has_gpos_mark = !!plan.map.get_1_mask (HB_TAG ('m', 'a', 'r', 'k'));
 
-  plan.adjust_mark_positioning_when_zeroing = !plan.apply_gpos &&
-					      !plan.apply_kerx &&
-					      (!plan.apply_kern
+  plan.adjust_mark_positioning_when_zeroing =
+      !plan.apply_gpos && !plan.apply_kerx &&
+      (!plan.apply_kern
 #ifndef HB_NO_OT_KERN
-					       || !hb_ot_layout_has_cross_kerning (face)
+       || !hb_ot_layout_has_cross_kerning (face)
 #endif
-					      );
+      );
 
   plan.fallback_mark_positioning = plan.adjust_mark_positioning_when_zeroing &&
 				   script_fallback_mark_positioning;
@@ -194,13 +193,13 @@
 
 #ifndef HB_NO_AAT_SHAPE
   /* Currently we always apply trak. */
-  plan.apply_trak = plan.requested_tracking && hb_aat_layout_has_tracking (face);
+  plan.apply_trak =
+      plan.requested_tracking && hb_aat_layout_has_tracking (face);
 #endif
 }
 
 bool
-hb_ot_shape_plan_t::init0 (hb_face_t                     *face,
-			   const hb_shape_plan_key_t     *key)
+hb_ot_shape_plan_t::init0 (hb_face_t *face, const hb_shape_plan_key_t *key)
 {
   map.init ();
 #ifndef HB_NO_AAT_SHAPE
@@ -207,11 +206,9 @@
   aat_map.init ();
 #endif
 
-  hb_ot_shape_planner_t planner (face,
-				 &key->props);
+  hb_ot_shape_planner_t planner (face, &key->props);
 
-  hb_ot_shape_collect_features (&planner,
-				key->user_features,
+  hb_ot_shape_collect_features (&planner, key->user_features,
 				key->num_user_features);
 
   planner.compile (*this, key->ot);
@@ -235,8 +232,7 @@
 void
 hb_ot_shape_plan_t::fini ()
 {
-  if (shaper->data_destroy)
-    shaper->data_destroy (const_cast<void *> (data));
+  if (shaper->data_destroy) shaper->data_destroy (const_cast<void *> (data));
 
   map.fini ();
 #ifndef HB_NO_AAT_SHAPE
@@ -245,8 +241,7 @@
 }
 
 void
-hb_ot_shape_plan_t::substitute (hb_font_t   *font,
-				hb_buffer_t *buffer) const
+hb_ot_shape_plan_t::substitute (hb_font_t *font, hb_buffer_t *buffer) const
 {
 #ifndef HB_NO_AAT_SHAPE
   if (unlikely (apply_morx))
@@ -257,11 +252,9 @@
 }
 
 void
-hb_ot_shape_plan_t::position (hb_font_t   *font,
-			      hb_buffer_t *buffer) const
+hb_ot_shape_plan_t::position (hb_font_t *font, hb_buffer_t *buffer) const
 {
-  if (this->apply_gpos)
-    map.position (this, font, buffer);
+  if (this->apply_gpos) map.position (this, font, buffer);
 #ifndef HB_NO_AAT_SHAPE
   else if (this->apply_kerx)
     hb_aat_layout_position (this, font, buffer);
@@ -274,86 +267,80 @@
     _hb_ot_shape_fallback_kern (this, font, buffer);
 
 #ifndef HB_NO_AAT_SHAPE
-  if (this->apply_trak)
-    hb_aat_layout_track (this, font, buffer);
+  if (this->apply_trak) hb_aat_layout_track (this, font, buffer);
 #endif
 }
 
-
-static const hb_ot_map_feature_t
-common_features[] =
-{
-  {HB_TAG('a','b','v','m'), F_GLOBAL},
-  {HB_TAG('b','l','w','m'), F_GLOBAL},
-  {HB_TAG('c','c','m','p'), F_GLOBAL},
-  {HB_TAG('l','o','c','l'), F_GLOBAL},
-  {HB_TAG('m','a','r','k'), F_GLOBAL_MANUAL_JOINERS},
-  {HB_TAG('m','k','m','k'), F_GLOBAL_MANUAL_JOINERS},
-  {HB_TAG('r','l','i','g'), F_GLOBAL},
+static const hb_ot_map_feature_t common_features[] = {
+    {HB_TAG ('a', 'b', 'v', 'm'), F_GLOBAL},
+    {HB_TAG ('b', 'l', 'w', 'm'), F_GLOBAL},
+    {HB_TAG ('c', 'c', 'm', 'p'), F_GLOBAL},
+    {HB_TAG ('l', 'o', 'c', 'l'), F_GLOBAL},
+    {HB_TAG ('m', 'a', 'r', 'k'), F_GLOBAL_MANUAL_JOINERS},
+    {HB_TAG ('m', 'k', 'm', 'k'), F_GLOBAL_MANUAL_JOINERS},
+    {HB_TAG ('r', 'l', 'i', 'g'), F_GLOBAL},
 };
 
-
-static const hb_ot_map_feature_t
-horizontal_features[] =
-{
-  {HB_TAG('c','a','l','t'), F_GLOBAL},
-  {HB_TAG('c','l','i','g'), F_GLOBAL},
-  {HB_TAG('c','u','r','s'), F_GLOBAL},
-  {HB_TAG('d','i','s','t'), F_GLOBAL},
-  {HB_TAG('k','e','r','n'), F_GLOBAL_HAS_FALLBACK},
-  {HB_TAG('l','i','g','a'), F_GLOBAL},
-  {HB_TAG('r','c','l','t'), F_GLOBAL},
+static const hb_ot_map_feature_t horizontal_features[] = {
+    {HB_TAG ('c', 'a', 'l', 't'), F_GLOBAL},
+    {HB_TAG ('c', 'l', 'i', 'g'), F_GLOBAL},
+    {HB_TAG ('c', 'u', 'r', 's'), F_GLOBAL},
+    {HB_TAG ('d', 'i', 's', 't'), F_GLOBAL},
+    {HB_TAG ('k', 'e', 'r', 'n'), F_GLOBAL_HAS_FALLBACK},
+    {HB_TAG ('l', 'i', 'g', 'a'), F_GLOBAL},
+    {HB_TAG ('r', 'c', 'l', 't'), F_GLOBAL},
 };
 
 static void
-hb_ot_shape_collect_features (hb_ot_shape_planner_t          *planner,
-			      const hb_feature_t             *user_features,
-			      unsigned int                    num_user_features)
+hb_ot_shape_collect_features (hb_ot_shape_planner_t *planner,
+			      const hb_feature_t *user_features,
+			      unsigned int num_user_features)
 {
   hb_ot_map_builder_t *map = &planner->map;
 
-  map->enable_feature (HB_TAG('r','v','r','n'));
+  map->enable_feature (HB_TAG ('r', 'v', 'r', 'n'));
   map->add_gsub_pause (nullptr);
 
-  switch (planner->props.direction) {
-    case HB_DIRECTION_LTR:
-      map->enable_feature (HB_TAG ('l','t','r','a'));
-      map->enable_feature (HB_TAG ('l','t','r','m'));
-      break;
-    case HB_DIRECTION_RTL:
-      map->enable_feature (HB_TAG ('r','t','l','a'));
-      map->add_feature (HB_TAG ('r','t','l','m'));
-      break;
-    case HB_DIRECTION_TTB:
-    case HB_DIRECTION_BTT:
-    case HB_DIRECTION_INVALID:
-    default:
-      break;
+  switch (planner->props.direction)
+  {
+  case HB_DIRECTION_LTR:
+    map->enable_feature (HB_TAG ('l', 't', 'r', 'a'));
+    map->enable_feature (HB_TAG ('l', 't', 'r', 'm'));
+    break;
+  case HB_DIRECTION_RTL:
+    map->enable_feature (HB_TAG ('r', 't', 'l', 'a'));
+    map->add_feature (HB_TAG ('r', 't', 'l', 'm'));
+    break;
+  case HB_DIRECTION_TTB:
+  case HB_DIRECTION_BTT:
+  case HB_DIRECTION_INVALID:
+  default: break;
   }
 
 #ifndef HB_NO_OT_SHAPE_FRACTIONS
   /* Automatic fractions. */
-  map->add_feature (HB_TAG ('f','r','a','c'));
-  map->add_feature (HB_TAG ('n','u','m','r'));
-  map->add_feature (HB_TAG ('d','n','o','m'));
+  map->add_feature (HB_TAG ('f', 'r', 'a', 'c'));
+  map->add_feature (HB_TAG ('n', 'u', 'm', 'r'));
+  map->add_feature (HB_TAG ('d', 'n', 'o', 'm'));
 #endif
 
   /* Random! */
-  map->enable_feature (HB_TAG ('r','a','n','d'), F_RANDOM, HB_OT_MAP_MAX_VALUE);
+  map->enable_feature (HB_TAG ('r', 'a', 'n', 'd'), F_RANDOM,
+		       HB_OT_MAP_MAX_VALUE);
 
 #ifndef HB_NO_AAT_SHAPE
   /* Tracking.  We enable dummy feature here just to allow disabling
    * AAT 'trak' table using features.
    * https://github.com/harfbuzz/harfbuzz/issues/1303 */
-  map->enable_feature (HB_TAG ('t','r','a','k'), F_HAS_FALLBACK);
+  map->enable_feature (HB_TAG ('t', 'r', 'a', 'k'), F_HAS_FALLBACK);
 #endif
 
-  map->enable_feature (HB_TAG ('H','A','R','F'));
+  map->enable_feature (HB_TAG ('H', 'A', 'R', 'F'));
 
   if (planner->shaper->collect_features)
     planner->shaper->collect_features (planner);
 
-  map->enable_feature (HB_TAG ('B','U','Z','Z'));
+  map->enable_feature (HB_TAG ('B', 'U', 'Z', 'Z'));
 
   for (unsigned int i = 0; i < ARRAY_LENGTH (common_features); i++)
     map->add_feature (common_features[i]);
@@ -367,7 +354,7 @@
      * matter which script/langsys it is listed (or not) under.
      * See various bugs referenced from:
      * https://github.com/harfbuzz/harfbuzz/issues/63 */
-    map->enable_feature (HB_TAG ('v','e','r','t'), F_GLOBAL_SEARCH);
+    map->enable_feature (HB_TAG ('v', 'e', 'r', 't'), F_GLOBAL_SEARCH);
   }
 
   for (unsigned int i = 0; i < num_user_features; i++)
@@ -375,7 +362,9 @@
     const hb_feature_t *feature = &user_features[i];
     map->add_feature (feature->tag,
 		      (feature->start == HB_FEATURE_GLOBAL_START &&
-		       feature->end == HB_FEATURE_GLOBAL_END) ?  F_GLOBAL : F_NONE,
+		       feature->end == HB_FEATURE_GLOBAL_END)
+			  ? F_GLOBAL
+			  : F_NONE,
 		      feature->value);
   }
 
@@ -395,12 +384,13 @@
     planner->shaper->override_features (planner);
 }
 
-
 /*
  * shaper face data
  */
 
-struct hb_ot_face_data_t {};
+struct hb_ot_face_data_t
+{
+};
 
 hb_ot_face_data_t *
 _hb_ot_shaper_face_data_create (hb_face_t *face)
@@ -410,15 +400,15 @@
 
 void
 _hb_ot_shaper_face_data_destroy (hb_ot_face_data_t *data)
-{
-}
+{}
 
-
 /*
  * shaper font data
  */
 
-struct hb_ot_font_data_t {};
+struct hb_ot_font_data_t
+{
+};
 
 hb_ot_font_data_t *
 _hb_ot_shaper_font_data_create (hb_font_t *font HB_UNUSED)
@@ -428,10 +418,8 @@
 
 void
 _hb_ot_shaper_font_data_destroy (hb_ot_font_data_t *data HB_UNUSED)
-{
-}
+{}
 
-
 /*
  * shaper
  */
@@ -441,19 +429,16 @@
   hb_ot_shape_plan_t *plan;
   hb_font_t *font;
   hb_face_t *face;
-  hb_buffer_t  *buffer;
+  hb_buffer_t *buffer;
   const hb_feature_t *user_features;
-  unsigned int        num_user_features;
+  unsigned int num_user_features;
 
   /* Transient stuff */
   hb_direction_t target_direction;
 };
 
-
-
 /* Main shaper */
 
-
 /* Prepare */
 
 static void
@@ -475,11 +460,11 @@
 
     /* Marks are already set as continuation by the above line.
      * Handle Emoji_Modifier and ZWJ-continuation. */
-    if (unlikely (_hb_glyph_info_get_general_category (&info[i]) == HB_UNICODE_GENERAL_CATEGORY_MODIFIER_SYMBOL &&
-		  hb_in_range<hb_codepoint_t> (info[i].codepoint, 0x1F3FBu, 0x1F3FFu)))
-    {
-	_hb_glyph_info_set_continuation (&info[i]);
-    }
+    if (unlikely (_hb_glyph_info_get_general_category (&info[i]) ==
+		      HB_UNICODE_GENERAL_CATEGORY_MODIFIER_SYMBOL &&
+		  hb_in_range<hb_codepoint_t> (info[i].codepoint, 0x1F3FBu,
+					       0x1F3FFu)))
+    { _hb_glyph_info_set_continuation (&info[i]); }
 #ifndef HB_NO_EMOJI_SEQUENCES
     else if (unlikely (_hb_glyph_info_is_zwj (&info[i])))
     {
@@ -497,15 +482,17 @@
      * As of Unicode 11 that is just:
      *
      * 200C          ; Other_Grapheme_Extend # Cf       ZERO WIDTH NON-JOINER
-     * FF9E..FF9F    ; Other_Grapheme_Extend # Lm   [2] HALFWIDTH KATAKANA VOICED SOUND MARK..HALFWIDTH KATAKANA SEMI-VOICED SOUND MARK
-     * E0020..E007F  ; Other_Grapheme_Extend # Cf  [96] TAG SPACE..CANCEL TAG
+     * FF9E..FF9F    ; Other_Grapheme_Extend # Lm   [2] HALFWIDTH KATAKANA
+     * VOICED SOUND MARK..HALFWIDTH KATAKANA SEMI-VOICED SOUND MARK E0020..E007F
+     * ; Other_Grapheme_Extend # Cf  [96] TAG SPACE..CANCEL TAG
      *
-     * ZWNJ is special, we don't want to merge it as there's no need, and keeping
-     * it separate results in more granular clusters.  Ignore Katakana for now.
-     * Tags are used for Emoji sub-region flag sequences:
+     * ZWNJ is special, we don't want to merge it as there's no need, and
+     * keeping it separate results in more granular clusters.  Ignore Katakana
+     * for now. Tags are used for Emoji sub-region flag sequences:
      * https://github.com/harfbuzz/harfbuzz/issues/1556
      */
-    else if (unlikely (hb_in_range<hb_codepoint_t> (info[i].codepoint, 0xE0020u, 0xE007Fu)))
+    else if (unlikely (hb_in_range<hb_codepoint_t> (info[i].codepoint, 0xE0020u,
+						    0xE007Fu)))
       _hb_glyph_info_set_continuation (&info[i]);
   }
 }
@@ -516,13 +503,11 @@
   if (unlikely (buffer->flags & HB_BUFFER_FLAG_DO_NOT_INSERT_DOTTED_CIRCLE))
     return;
 
-  if (!(buffer->flags & HB_BUFFER_FLAG_BOT) ||
-      buffer->context_len[0] ||
+  if (!(buffer->flags & HB_BUFFER_FLAG_BOT) || buffer->context_len[0] ||
       !_hb_glyph_info_is_unicode_mark (&buffer->info[0]))
     return;
 
-  if (!font->has_glyph (0x25CCu))
-    return;
+  if (!font->has_glyph (0x25CCu)) return;
 
   hb_glyph_info_t dottedcircle = {0};
   dottedcircle.codepoint = 0x25CCu;
@@ -532,11 +517,10 @@
 
   buffer->idx = 0;
   hb_glyph_info_t info = dottedcircle;
-  info.cluster = buffer->cur().cluster;
-  info.mask = buffer->cur().mask;
+  info.cluster = buffer->cur ().cluster;
+  info.mask = buffer->cur ().mask;
   buffer->output_info (info);
-  while (buffer->idx < buffer->len && buffer->successful)
-    buffer->next_glyph ();
+  while (buffer->idx < buffer->len && buffer->successful) buffer->next_glyph ();
   buffer->swap_buffers ();
 }
 
@@ -543,15 +527,12 @@
 static void
 hb_form_clusters (hb_buffer_t *buffer)
 {
-  if (!(buffer->scratch_flags & HB_BUFFER_SCRATCH_FLAG_HAS_NON_ASCII))
-    return;
+  if (!(buffer->scratch_flags & HB_BUFFER_SCRATCH_FLAG_HAS_NON_ASCII)) return;
 
   if (buffer->cluster_level == HB_BUFFER_CLUSTER_LEVEL_MONOTONE_GRAPHEMES)
-    foreach_grapheme (buffer, start, end)
-      buffer->merge_clusters (start, end);
+    foreach_grapheme (buffer, start, end) buffer->merge_clusters (start, end);
   else
-    foreach_grapheme (buffer, start, end)
-      buffer->unsafe_to_break (start, end);
+    foreach_grapheme (buffer, start, end) buffer->unsafe_to_break (start, end);
 }
 
 static void
@@ -558,16 +539,16 @@
 hb_ensure_native_direction (hb_buffer_t *buffer)
 {
   hb_direction_t direction = buffer->props.direction;
-  hb_direction_t horiz_dir = hb_script_get_horizontal_direction (buffer->props.script);
+  hb_direction_t horiz_dir =
+      hb_script_get_horizontal_direction (buffer->props.script);
 
   /* TODO vertical:
-   * The only BTT vertical script is Ogham, but it's not clear to me whether OpenType
-   * Ogham fonts are supposed to be implemented BTT or not.  Need to research that
-   * first. */
-  if ((HB_DIRECTION_IS_HORIZONTAL (direction) &&
-       direction != horiz_dir && horiz_dir != HB_DIRECTION_INVALID) ||
-      (HB_DIRECTION_IS_VERTICAL   (direction) &&
-       direction != HB_DIRECTION_TTB))
+   * The only BTT vertical script is Ogham, but it's not clear to me whether
+   * OpenType Ogham fonts are supposed to be implemented BTT or not.  Need to
+   * research that first. */
+  if ((HB_DIRECTION_IS_HORIZONTAL (direction) && direction != horiz_dir &&
+       horiz_dir != HB_DIRECTION_INVALID) ||
+      (HB_DIRECTION_IS_VERTICAL (direction) && direction != HB_DIRECTION_TTB))
   {
 
     if (buffer->cluster_level == HB_BUFFER_CLUSTER_LEVEL_MONOTONE_CHARACTERS)
@@ -578,8 +559,8 @@
       }
     else
       foreach_grapheme (buffer, start, end)
-	/* form_clusters() merged clusters already, we don't merge. */
-	buffer->reverse_range (start, end);
+	  /* form_clusters() merged clusters already, we don't merge. */
+	  buffer->reverse_range (start, end);
 
     buffer->reverse ();
 
@@ -587,7 +568,6 @@
   }
 }
 
-
 /*
  * Substitute
  */
@@ -597,47 +577,59 @@
 {
   switch (u >> 8)
   {
-    case 0x20: switch (u) {
-      case 0x2013u: return 0xfe32u; // EN DASH
-      case 0x2014u: return 0xfe31u; // EM DASH
-      case 0x2025u: return 0xfe30u; // TWO DOT LEADER
-      case 0x2026u: return 0xfe19u; // HORIZONTAL ELLIPSIS
-    } break;
-    case 0x30: switch (u) {
-      case 0x3001u: return 0xfe11u; // IDEOGRAPHIC COMMA
-      case 0x3002u: return 0xfe12u; // IDEOGRAPHIC FULL STOP
-      case 0x3008u: return 0xfe3fu; // LEFT ANGLE BRACKET
-      case 0x3009u: return 0xfe40u; // RIGHT ANGLE BRACKET
-      case 0x300au: return 0xfe3du; // LEFT DOUBLE ANGLE BRACKET
-      case 0x300bu: return 0xfe3eu; // RIGHT DOUBLE ANGLE BRACKET
-      case 0x300cu: return 0xfe41u; // LEFT CORNER BRACKET
-      case 0x300du: return 0xfe42u; // RIGHT CORNER BRACKET
-      case 0x300eu: return 0xfe43u; // LEFT WHITE CORNER BRACKET
-      case 0x300fu: return 0xfe44u; // RIGHT WHITE CORNER BRACKET
-      case 0x3010u: return 0xfe3bu; // LEFT BLACK LENTICULAR BRACKET
-      case 0x3011u: return 0xfe3cu; // RIGHT BLACK LENTICULAR BRACKET
-      case 0x3014u: return 0xfe39u; // LEFT TORTOISE SHELL BRACKET
-      case 0x3015u: return 0xfe3au; // RIGHT TORTOISE SHELL BRACKET
-      case 0x3016u: return 0xfe17u; // LEFT WHITE LENTICULAR BRACKET
-      case 0x3017u: return 0xfe18u; // RIGHT WHITE LENTICULAR BRACKET
-    } break;
-    case 0xfe: switch (u) {
-      case 0xfe4fu: return 0xfe34u; // WAVY LOW LINE
-    } break;
-    case 0xff: switch (u) {
-      case 0xff01u: return 0xfe15u; // FULLWIDTH EXCLAMATION MARK
-      case 0xff08u: return 0xfe35u; // FULLWIDTH LEFT PARENTHESIS
-      case 0xff09u: return 0xfe36u; // FULLWIDTH RIGHT PARENTHESIS
-      case 0xff0cu: return 0xfe10u; // FULLWIDTH COMMA
-      case 0xff1au: return 0xfe13u; // FULLWIDTH COLON
-      case 0xff1bu: return 0xfe14u; // FULLWIDTH SEMICOLON
-      case 0xff1fu: return 0xfe16u; // FULLWIDTH QUESTION MARK
-      case 0xff3bu: return 0xfe47u; // FULLWIDTH LEFT SQUARE BRACKET
-      case 0xff3du: return 0xfe48u; // FULLWIDTH RIGHT SQUARE BRACKET
-      case 0xff3fu: return 0xfe33u; // FULLWIDTH LOW LINE
-      case 0xff5bu: return 0xfe37u; // FULLWIDTH LEFT CURLY BRACKET
-      case 0xff5du: return 0xfe38u; // FULLWIDTH RIGHT CURLY BRACKET
-    } break;
+  case 0x20:
+    switch (u)
+    {
+    case 0x2013u: return 0xfe32u; // EN DASH
+    case 0x2014u: return 0xfe31u; // EM DASH
+    case 0x2025u: return 0xfe30u; // TWO DOT LEADER
+    case 0x2026u: return 0xfe19u; // HORIZONTAL ELLIPSIS
+    }
+    break;
+  case 0x30:
+    switch (u)
+    {
+    case 0x3001u: return 0xfe11u; // IDEOGRAPHIC COMMA
+    case 0x3002u: return 0xfe12u; // IDEOGRAPHIC FULL STOP
+    case 0x3008u: return 0xfe3fu; // LEFT ANGLE BRACKET
+    case 0x3009u: return 0xfe40u; // RIGHT ANGLE BRACKET
+    case 0x300au: return 0xfe3du; // LEFT DOUBLE ANGLE BRACKET
+    case 0x300bu: return 0xfe3eu; // RIGHT DOUBLE ANGLE BRACKET
+    case 0x300cu: return 0xfe41u; // LEFT CORNER BRACKET
+    case 0x300du: return 0xfe42u; // RIGHT CORNER BRACKET
+    case 0x300eu: return 0xfe43u; // LEFT WHITE CORNER BRACKET
+    case 0x300fu: return 0xfe44u; // RIGHT WHITE CORNER BRACKET
+    case 0x3010u: return 0xfe3bu; // LEFT BLACK LENTICULAR BRACKET
+    case 0x3011u: return 0xfe3cu; // RIGHT BLACK LENTICULAR BRACKET
+    case 0x3014u: return 0xfe39u; // LEFT TORTOISE SHELL BRACKET
+    case 0x3015u: return 0xfe3au; // RIGHT TORTOISE SHELL BRACKET
+    case 0x3016u: return 0xfe17u; // LEFT WHITE LENTICULAR BRACKET
+    case 0x3017u: return 0xfe18u; // RIGHT WHITE LENTICULAR BRACKET
+    }
+    break;
+  case 0xfe:
+    switch (u)
+    {
+    case 0xfe4fu: return 0xfe34u; // WAVY LOW LINE
+    }
+    break;
+  case 0xff:
+    switch (u)
+    {
+    case 0xff01u: return 0xfe15u; // FULLWIDTH EXCLAMATION MARK
+    case 0xff08u: return 0xfe35u; // FULLWIDTH LEFT PARENTHESIS
+    case 0xff09u: return 0xfe36u; // FULLWIDTH RIGHT PARENTHESIS
+    case 0xff0cu: return 0xfe10u; // FULLWIDTH COMMA
+    case 0xff1au: return 0xfe13u; // FULLWIDTH COLON
+    case 0xff1bu: return 0xfe14u; // FULLWIDTH SEMICOLON
+    case 0xff1fu: return 0xfe16u; // FULLWIDTH QUESTION MARK
+    case 0xff3bu: return 0xfe47u; // FULLWIDTH LEFT SQUARE BRACKET
+    case 0xff3du: return 0xfe48u; // FULLWIDTH RIGHT SQUARE BRACKET
+    case 0xff3fu: return 0xfe33u; // FULLWIDTH LOW LINE
+    case 0xff5bu: return 0xfe37u; // FULLWIDTH LEFT CURLY BRACKET
+    case 0xff5du: return 0xfe38u; // FULLWIDTH RIGHT CURLY BRACKET
+    }
+    break;
   }
 
   return u;
@@ -655,9 +647,11 @@
     hb_unicode_funcs_t *unicode = buffer->unicode;
     hb_mask_t rtlm_mask = c->plan->rtlm_mask;
 
-    for (unsigned int i = 0; i < count; i++) {
+    for (unsigned int i = 0; i < count; i++)
+    {
       hb_codepoint_t codepoint = unicode->mirroring (info[i].codepoint);
-      if (unlikely (codepoint != info[i].codepoint && c->font->has_glyph (codepoint)))
+      if (unlikely (codepoint != info[i].codepoint &&
+		    c->font->has_glyph (codepoint)))
 	info[i].codepoint = codepoint;
       else
 	info[i].mask |= rtlm_mask;
@@ -666,7 +660,8 @@
 
   if (HB_DIRECTION_IS_VERTICAL (c->target_direction) && !c->plan->has_vert)
   {
-    for (unsigned int i = 0; i < count; i++) {
+    for (unsigned int i = 0; i < count; i++)
+    {
       hb_codepoint_t codepoint = hb_vert_char_for (info[i].codepoint);
       if (unlikely (codepoint != info[i].codepoint && c->font->has_glyph (codepoint)))
 	info[i].codepoint = codepoint;
@@ -706,22 +701,18 @@
     if (info[i].codepoint == 0x2044u) /* FRACTION SLASH */
     {
       unsigned int start = i, end = i + 1;
-      while (start &&
-	     _hb_glyph_info_get_general_category (&info[start - 1]) ==
-	     HB_UNICODE_GENERAL_CATEGORY_DECIMAL_NUMBER)
+      while (start && _hb_glyph_info_get_general_category (&info[start - 1]) ==
+			  HB_UNICODE_GENERAL_CATEGORY_DECIMAL_NUMBER)
 	start--;
-      while (end < count &&
-	     _hb_glyph_info_get_general_category (&info[end]) ==
-	     HB_UNICODE_GENERAL_CATEGORY_DECIMAL_NUMBER)
+      while (end < count && _hb_glyph_info_get_general_category (&info[end]) ==
+				HB_UNICODE_GENERAL_CATEGORY_DECIMAL_NUMBER)
 	end++;
 
       buffer->unsafe_to_break (start, end);
 
-      for (unsigned int j = start; j < i; j++)
-	info[j].mask |= pre_mask;
+      for (unsigned int j = start; j < i; j++) info[j].mask |= pre_mask;
       info[i].mask |= c->plan->frac_mask;
-      for (unsigned int j = i + 1; j < end; j++)
-	info[j].mask |= post_mask;
+      for (unsigned int j = i + 1; j < end; j++) info[j].mask |= post_mask;
 
       i = end - 1;
     }
@@ -752,10 +743,13 @@
   for (unsigned int i = 0; i < c->num_user_features; i++)
   {
     const hb_feature_t *feature = &c->user_features[i];
-    if (!(feature->start == HB_FEATURE_GLOBAL_START && feature->end == HB_FEATURE_GLOBAL_END)) {
+    if (!(feature->start == HB_FEATURE_GLOBAL_START &&
+	  feature->end == HB_FEATURE_GLOBAL_END))
+    {
       unsigned int shift;
       hb_mask_t mask = map->get_mask (feature->tag, &shift);
-      buffer->set_masks (feature->value << shift, mask, feature->start, feature->end);
+      buffer->set_masks (feature->value << shift, mask, feature->start,
+			 feature->end);
     }
   }
 }
@@ -763,7 +757,8 @@
 static void
 hb_ot_zero_width_default_ignorables (const hb_buffer_t *buffer)
 {
-  if (!(buffer->scratch_flags & HB_BUFFER_SCRATCH_FLAG_HAS_DEFAULT_IGNORABLES) ||
+  if (!(buffer->scratch_flags &
+	HB_BUFFER_SCRATCH_FLAG_HAS_DEFAULT_IGNORABLES) ||
       (buffer->flags & HB_BUFFER_FLAG_PRESERVE_DEFAULT_IGNORABLES) ||
       (buffer->flags & HB_BUFFER_FLAG_REMOVE_DEFAULT_IGNORABLES))
     return;
@@ -774,14 +769,15 @@
   unsigned int i = 0;
   for (i = 0; i < count; i++)
     if (unlikely (_hb_glyph_info_is_default_ignorable (&info[i])))
-      pos[i].x_advance = pos[i].y_advance = pos[i].x_offset = pos[i].y_offset = 0;
+      pos[i].x_advance = pos[i].y_advance = pos[i].x_offset = pos[i].y_offset =
+	  0;
 }
 
 static void
-hb_ot_hide_default_ignorables (hb_buffer_t *buffer,
-			       hb_font_t   *font)
+hb_ot_hide_default_ignorables (hb_buffer_t *buffer, hb_font_t *font)
 {
-  if (!(buffer->scratch_flags & HB_BUFFER_SCRATCH_FLAG_HAS_DEFAULT_IGNORABLES) ||
+  if (!(buffer->scratch_flags &
+	HB_BUFFER_SCRATCH_FLAG_HAS_DEFAULT_IGNORABLES) ||
       (buffer->flags & HB_BUFFER_FLAG_PRESERVE_DEFAULT_IGNORABLES))
     return;
 
@@ -800,18 +796,18 @@
     }
   }
   else
-    hb_ot_layout_delete_glyphs_inplace (buffer, _hb_glyph_info_is_default_ignorable);
+    hb_ot_layout_delete_glyphs_inplace (buffer,
+					_hb_glyph_info_is_default_ignorable);
 }
 
-
 static inline void
-hb_ot_map_glyphs_fast (hb_buffer_t  *buffer)
+hb_ot_map_glyphs_fast (hb_buffer_t *buffer)
 {
   /* Normalization process sets up glyph_index(), we just copy it. */
   unsigned int count = buffer->len;
   hb_glyph_info_t *info = buffer->info;
   for (unsigned int i = 0; i < count; i++)
-    info[i].codepoint = info[i].glyph_index();
+    info[i].codepoint = info[i].glyph_index ();
 
   buffer->content_type = HB_BUFFER_CONTENT_TYPE_GLYPHS;
 }
@@ -834,10 +830,10 @@
      * GDEF rely on this.  Another notable character that
      * this applies to is COMBINING GRAPHEME JOINER. */
     klass = (_hb_glyph_info_get_general_category (&info[i]) !=
-	     HB_UNICODE_GENERAL_CATEGORY_NON_SPACING_MARK ||
-	     _hb_glyph_info_is_default_ignorable (&info[i])) ?
-	    HB_OT_LAYOUT_GLYPH_PROPS_BASE_GLYPH :
-	    HB_OT_LAYOUT_GLYPH_PROPS_MARK;
+		 HB_UNICODE_GENERAL_CATEGORY_NON_SPACING_MARK ||
+	     _hb_glyph_info_is_default_ignorable (&info[i]))
+		? HB_OT_LAYOUT_GLYPH_PROPS_BASE_GLYPH
+		: HB_OT_LAYOUT_GLYPH_PROPS_MARK;
     _hb_glyph_info_set_glyph_props (&info[i], klass);
   }
 }
@@ -851,15 +847,20 @@
 
   HB_BUFFER_ALLOCATE_VAR (buffer, glyph_index);
 
-  _hb_ot_shape_normalize (c->plan, buffer, c->font);
+  // VisualMetaFont (For justification)
+  if (buffer->content_type != HB_BUFFER_CONTENT_TYPE_GLYPHS)
+  { _hb_ot_shape_normalize (c->plan, buffer, c->font); }
 
   hb_ot_shape_setup_masks (c);
 
   /* This is unfortunate to go here, but necessary... */
   if (c->plan->fallback_mark_positioning)
-    _hb_ot_shape_fallback_mark_position_recategorize_marks (c->plan, c->font, buffer);
+    _hb_ot_shape_fallback_mark_position_recategorize_marks (c->plan, c->font,
+							    buffer);
 
-  hb_ot_map_glyphs_fast (buffer);
+  // VisualMetaFont (For justification)
+  if (buffer->content_type != HB_BUFFER_CONTENT_TYPE_GLYPHS)
+  { hb_ot_map_glyphs_fast (buffer); }
 
   HB_BUFFER_DEALLOCATE_VAR (buffer, glyph_index);
 }
@@ -871,8 +872,7 @@
 
   hb_ot_layout_substitute_start (c->font, buffer);
 
-  if (c->plan->fallback_glyph_classes)
-    hb_synthesize_glyph_classes (c->buffer);
+  if (c->plan->fallback_glyph_classes) hb_synthesize_glyph_classes (c->buffer);
 
   c->plan->substitute (c->font, buffer);
 }
@@ -892,8 +892,7 @@
 {
   hb_ot_hide_default_ignorables (c->buffer, c->font);
 #ifndef HB_NO_AAT_SHAPE
-  if (c->plan->apply_morx)
-    hb_aat_layout_remove_deleted_glyphs (c->buffer);
+  if (c->plan->apply_morx) hb_aat_layout_remove_deleted_glyphs (c->buffer);
 #endif
 
   if (c->plan->shaper->postprocess_glyphs &&
@@ -903,7 +902,6 @@
   }
 }
 
-
 /*
  * Position
  */
@@ -930,8 +928,7 @@
   for (unsigned int i = 0; i < count; i++)
     if (_hb_glyph_info_is_mark (&info[i]))
     {
-      if (adjust_offsets)
-	adjust_mark_offsets (&buffer->pos[i]);
+      if (adjust_offsets) adjust_mark_offsets (&buffer->pos[i]);
       zero_mark_width (&buffer->pos[i]);
     }
 }
@@ -946,23 +943,21 @@
 
   if (HB_DIRECTION_IS_HORIZONTAL (direction))
   {
-    c->font->get_glyph_h_advances (count, &info[0].codepoint, sizeof(info[0]),
-				   &pos[0].x_advance, sizeof(pos[0]));
+    c->font->get_glyph_h_advances (count, &info[0].codepoint, sizeof (info[0]),
+				   &pos[0].x_advance, sizeof (pos[0]));
     /* The nil glyph_h_origin() func returns 0, so no need to apply it. */
     if (c->font->has_glyph_h_origin_func ())
       for (unsigned int i = 0; i < count; i++)
-	c->font->subtract_glyph_h_origin (info[i].codepoint,
-					  &pos[i].x_offset,
+	c->font->subtract_glyph_h_origin (info[i].codepoint, &pos[i].x_offset,
 					  &pos[i].y_offset);
   }
   else
   {
-    c->font->get_glyph_v_advances (count, &info[0].codepoint, sizeof(info[0]),
-				   &pos[0].y_advance, sizeof(pos[0]));
+    c->font->get_glyph_v_advances (count, &info[0].codepoint, sizeof (info[0]),
+				   &pos[0].y_advance, sizeof (pos[0]));
     for (unsigned int i = 0; i < count; i++)
     {
-      c->font->subtract_glyph_v_origin (info[i].codepoint,
-					&pos[i].x_offset,
+      c->font->subtract_glyph_v_origin (info[i].codepoint, &pos[i].x_offset,
 					&pos[i].y_offset);
     }
   }
@@ -986,46 +981,43 @@
    * Note: If fallback positinoing happens, we don't care about
    * this as it will be overriden.
    */
-  bool adjust_offsets_when_zeroing = c->plan->adjust_mark_positioning_when_zeroing &&
-				     HB_DIRECTION_IS_FORWARD (c->buffer->props.direction);
+  bool adjust_offsets_when_zeroing =
+      c->plan->adjust_mark_positioning_when_zeroing &&
+      HB_DIRECTION_IS_FORWARD (c->buffer->props.direction);
 
-  /* We change glyph origin to what GPOS expects (horizontal), apply GPOS, change it back. */
+  /* We change glyph origin to what GPOS expects (horizontal), apply GPOS,
+   * change it back. */
 
   /* The nil glyph_h_origin() func returns 0, so no need to apply it. */
   if (c->font->has_glyph_h_origin_func ())
     for (unsigned int i = 0; i < count; i++)
-      c->font->add_glyph_h_origin (info[i].codepoint,
-				   &pos[i].x_offset,
+      c->font->add_glyph_h_origin (info[i].codepoint, &pos[i].x_offset,
 				   &pos[i].y_offset);
 
   hb_ot_layout_position_start (c->font, c->buffer);
 
-  if (c->plan->zero_marks)
-    switch (c->plan->shaper->zero_width_marks)
+  if (c->plan->zero_marks) switch (c->plan->shaper->zero_width_marks)
     {
-      case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_EARLY:
-	zero_mark_widths_by_gdef (c->buffer, adjust_offsets_when_zeroing);
-	break;
+    case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_EARLY:
+      zero_mark_widths_by_gdef (c->buffer, adjust_offsets_when_zeroing);
+      break;
 
-      default:
-      case HB_OT_SHAPE_ZERO_WIDTH_MARKS_NONE:
-      case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_LATE:
-	break;
+    default:
+    case HB_OT_SHAPE_ZERO_WIDTH_MARKS_NONE:
+    case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_LATE: break;
     }
 
   c->plan->position (c->font, c->buffer);
 
-  if (c->plan->zero_marks)
-    switch (c->plan->shaper->zero_width_marks)
+  if (c->plan->zero_marks) switch (c->plan->shaper->zero_width_marks)
     {
-      case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_LATE:
-	zero_mark_widths_by_gdef (c->buffer, adjust_offsets_when_zeroing);
-	break;
+    case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_LATE:
+      zero_mark_widths_by_gdef (c->buffer, adjust_offsets_when_zeroing);
+      break;
 
-      default:
-      case HB_OT_SHAPE_ZERO_WIDTH_MARKS_NONE:
-      case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_EARLY:
-	break;
+    default:
+    case HB_OT_SHAPE_ZERO_WIDTH_MARKS_NONE:
+    case HB_OT_SHAPE_ZERO_WIDTH_MARKS_BY_GDEF_EARLY: break;
     }
 
   /* Finish off.  Has to follow a certain order. */
@@ -1032,8 +1024,7 @@
   hb_ot_layout_position_finish_advances (c->font, c->buffer);
   hb_ot_zero_width_default_ignorables (c->buffer);
 #ifndef HB_NO_AAT_SHAPE
-  if (c->plan->apply_morx)
-    hb_aat_layout_zero_width_deleted_glyphs (c->buffer);
+  if (c->plan->apply_morx) hb_aat_layout_zero_width_deleted_glyphs (c->buffer);
 #endif
   hb_ot_layout_position_finish_offsets (c->font, c->buffer);
 
@@ -1040,8 +1031,7 @@
   /* The nil glyph_h_origin() func returns 0, so no need to apply it. */
   if (c->font->has_glyph_h_origin_func ())
     for (unsigned int i = 0; i < count; i++)
-      c->font->subtract_glyph_h_origin (info[i].codepoint,
-					&pos[i].x_offset,
+      c->font->subtract_glyph_h_origin (info[i].codepoint, &pos[i].x_offset,
 					&pos[i].y_offset);
 
   if (c->plan->fallback_mark_positioning)
@@ -1057,11 +1047,12 @@
   hb_ot_position_default (c);
 
   hb_ot_position_complex (c);
-
+  
+#ifdef HB_NO_JUSTIFICATION
   if (HB_DIRECTION_IS_BACKWARD (c->buffer->props.direction))
     hb_buffer_reverse (c->buffer);
-
   _hb_buffer_deallocate_gsubgpos_vars (c->buffer);
+#endif
 }
 
 static inline void
@@ -1081,15 +1072,186 @@
     for (unsigned int i = start; i < end; i++)
       if (info[i].mask & HB_GLYPH_FLAG_UNSAFE_TO_BREAK)
       {
-	 mask = HB_GLYPH_FLAG_UNSAFE_TO_BREAK;
-	 break;
+	mask = HB_GLYPH_FLAG_UNSAFE_TO_BREAK;
+	break;
       }
     if (mask)
-      for (unsigned int i = start; i < end; i++)
-	info[i].mask |= mask;
+      for (unsigned int i = start; i < end; i++) info[i].mask |= mask;
   }
 }
+#ifndef HB_NO_JUSTIFICATION
+static void
+hb_ot_justify_line (hb_ot_shape_context_t *c)
+{
+  OT::JustificationContext justContext{c->font};
+  if (c->buffer->justifyLine && c->buffer->lineWidth != 0)
+  {    
+    
+    const unsigned int table_index = 1u;
+    hb_ot_map_t::lookup_map_t *stagelookups = nullptr;
+    unsigned int count;
+    hb_tag_t justFeatureTag = HB_TAG ('s', 'h', 'r', '1');
+    hb_mask_t posMask = c->plan->map.get_mask (justFeatureTag);
+    
 
+    c->plan->map.get_stage_lookups (
+	table_index /*GPOS*/,
+	c->plan->map.get_feature_stage (table_index /*GPOS*/, justFeatureTag),
+	(const hb_ot_map_t::lookup_map_t **) &stagelookups, &count);
+
+    for (unsigned int il = 0; il < count; il++)
+    {
+      for (int tableIndex = 0; tableIndex < 2; tableIndex++) {
+
+	hb_tag_t tableTag = tableIndex == 0 ? HB_OT_TAG_GSUB : HB_OT_TAG_GPOS;
+	unsigned feature_index = 0;
+	bool found = hb_ot_layout_language_find_feature (
+	    c->face, tableTag, 0, HB_OT_LAYOUT_DEFAULT_LANGUAGE_INDEX,
+	    justFeatureTag, &feature_index);
+
+	if (found)
+	{
+	  unsigned int lookup_count;
+	  unsigned int offset = 0;
+	  unsigned int lookup_indexes[32];
+	  /* TODO has to be done elsewhere (i.e during map compilation) */
+	  do
+	  {
+	    
+	    lookup_count = ARRAY_LENGTH (lookup_indexes);
+	    hb_ot_layout_feature_get_lookups (c->face, tableTag, feature_index,
+					      offset, &lookup_count,
+					      lookup_indexes);
+	    for (unsigned int j = 0; j < lookup_count; j++)
+	    {
+	      if (lookup_indexes[j] == stagelookups[il].index)
+	      { stagelookups[il].mask = 0; }
+	    }
+	    offset += lookup_count;
+	  } while (lookup_count == ARRAY_LENGTH (lookup_indexes));
+	  
+	}
+      }
+
+      /*
+      for (int tt = 0; tt < 2; tt++) {
+	auto &steps = tt == 0 ? c->font->face->table.JTST->get_stretch_steps ()
+			      : c->font->face->table.JTST->get_shrink_steps ();
+
+	for (int stepIndex = 0; stepIndex < steps.len; stepIndex++)
+	{
+	  auto &step = steps[stepIndex];
+	  auto &lookups = step.get_lookups ();
+	  int lookupLen = lookups.len;
+	  if (!step.isSubtitution ())
+	  {
+	    for (int j = 0; j < lookupLen; j++)
+	    {
+	      int lookup_index = lookups[j];
+	      if (lookup_index == stagelookups[il].index)
+	      {		
+		stagelookups[il].mask = 0;
+	      }
+	    }
+	  }
+	}
+      }*/
+    }
+
+    c->buffer->add_masks (posMask);
+
+    bool needPosition = false;
+    
+
+    unsigned int glyph_count;
+    
+    hb_buffer_t *copy_buffer = hb_buffer_create ();
+    bool copyBuffer = true;
+
+    c->buffer->justContext = &justContext;
+    int currentlineWidth = justContext.getWidth (c->buffer);
+    int diff = c->buffer->lineWidth - currentlineWidth;
+    bool isStretch = diff > 0;
+
+    auto &steps = isStretch ? c->font->face->table.JTST->get_stretch_steps ()
+			    : c->font->face->table.JTST->get_shrink_steps ();
+    unsigned int stepIndex = 0;
+    while (stepIndex < steps.len &&
+	   ((isStretch && diff > 0) || (!isStretch && diff < 0)))
+    {
+      justContext.clear ();
+      auto &step = steps[stepIndex];
+      auto &lookups = step.get_lookups ();
+      int lookupLen = lookups.len;
+      
+
+      if (lookupLen != 0)
+      {
+	if (step.isSubtitution ())
+	{
+	  if (copyBuffer) {
+	    hb_buffer_clear_contents (copy_buffer);
+	    hb_buffer_append (copy_buffer, c->buffer, 0, -1);
+	    copyBuffer = false;
+	  }
+
+	  hb_glyph_position_t *glyph_pos =
+	      hb_buffer_get_glyph_positions (copy_buffer, &glyph_count);
+
+	  for (int j = 0; j < lookupLen; j++)
+	  {
+	    int lookup_index = lookups[j];
+	    const unsigned int table_index = 0u;
+
+	    OT::hb_ot_apply_context_t ac (table_index, c->font, c->buffer);
+	    ac.set_recurse_func (OT::SubstLookup::apply_recurse_func);
+	    ac.set_lookup_index (lookup_index);
+	    ac.set_lookup_mask (2);
+	    ac.set_auto_zwj (1);
+	    ac.set_auto_zwnj (1);
+
+	    needPosition = true;
+
+	    hb_ot_layout_substitute_lookup (
+		&ac,
+		c->font->face->table.GSUB->table->get_lookup (lookup_index),
+		c->font->face->table.GSUB->accels[lookup_index]);
+	  }
+	  
+
+	  justContext.justify (diff, c->buffer, glyph_pos);
+	}
+	else
+	{
+	  for (int j = 0; j < lookupLen; j++)
+	  {
+	    int lookup_index = lookups[j];
+	    for (unsigned int il = 0; il < count; il++) {
+	      if (stagelookups[il].index == lookup_index) {
+		stagelookups[il].mask = posMask;
+	      }
+	    }	    
+	  }
+	  hb_ot_position (c);	  
+	  diff = c->buffer->lineWidth - justContext.getWidth (c->buffer); 
+	  copyBuffer = true;
+	  needPosition = false;
+	}
+      }
+	
+      stepIndex++;
+    }
+
+    hb_buffer_destroy (copy_buffer);
+    if (needPosition)
+      hb_ot_position (c);
+  }
+  if (HB_DIRECTION_IS_BACKWARD (c->buffer->props.direction))
+    hb_buffer_reverse (c->buffer);
+  _hb_buffer_deallocate_gsubgpos_vars (c->buffer);
+}
+#endif
+
 /* Pull it all together! */
 
 static void
@@ -1097,12 +1259,14 @@
 {
   c->buffer->deallocate_var_all ();
   c->buffer->scratch_flags = HB_BUFFER_SCRATCH_FLAG_DEFAULT;
-  if (likely (!hb_unsigned_mul_overflows (c->buffer->len, HB_BUFFER_MAX_LEN_FACTOR)))
+  if (likely (!hb_unsigned_mul_overflows (c->buffer->len,
+					  HB_BUFFER_MAX_LEN_FACTOR)))
   {
     c->buffer->max_len = hb_max (c->buffer->len * HB_BUFFER_MAX_LEN_FACTOR,
 				 (unsigned) HB_BUFFER_MAX_LEN_MIN);
   }
-  if (likely (!hb_unsigned_mul_overflows (c->buffer->len, HB_BUFFER_MAX_OPS_FACTOR)))
+  if (likely (!hb_unsigned_mul_overflows (c->buffer->len,
+					  HB_BUFFER_MAX_OPS_FACTOR)))
   {
     c->buffer->max_ops = hb_max (c->buffer->len * HB_BUFFER_MAX_OPS_FACTOR,
 				 (unsigned) HB_BUFFER_MAX_OPS_MIN);
@@ -1130,7 +1294,13 @@
   }
 
   hb_ot_substitute_pre (c);
+
   hb_ot_position (c);
+
+#ifndef HB_NO_JUSTIFICATION
+  hb_ot_justify_line (c);
+#endif
+
   hb_ot_substitute_post (c);
 
   hb_propagate_flags (c->buffer);
@@ -1144,21 +1314,20 @@
   c->buffer->deallocate_var_all ();
 }
 
-
 hb_bool_t
-_hb_ot_shape (hb_shape_plan_t    *shape_plan,
-	      hb_font_t          *font,
-	      hb_buffer_t        *buffer,
+_hb_ot_shape (hb_shape_plan_t *shape_plan,
+	      hb_font_t *font,
+	      hb_buffer_t *buffer,
 	      const hb_feature_t *features,
-	      unsigned int        num_features)
+	      unsigned int num_features)
 {
-  hb_ot_shape_context_t c = {&shape_plan->ot, font, font->face, buffer, features, num_features};
+  hb_ot_shape_context_t c = {&shape_plan->ot, font,	font->face,
+			     buffer,	      features, num_features};
   hb_ot_shape_internal (&c);
 
   return true;
 }
 
-
 /**
  * hb_ot_shape_plan_collect_lookups:
  * @shape_plan: #hb_shape_plan_t to query
@@ -1172,33 +1341,30 @@
  **/
 void
 hb_ot_shape_plan_collect_lookups (hb_shape_plan_t *shape_plan,
-				  hb_tag_t         table_tag,
-				  hb_set_t        *lookup_indexes /* OUT */)
+				  hb_tag_t table_tag,
+				  hb_set_t *lookup_indexes /* OUT */)
 {
   shape_plan->ot.collect_lookups (table_tag, lookup_indexes);
 }
 
-
-/* TODO Move this to hb-ot-shape-normalize, make it do decompose, and make it public. */
+/* TODO Move this to hb-ot-shape-normalize, make it do decompose, and make it
+ * public. */
 static void
-add_char (hb_font_t          *font,
+add_char (hb_font_t *font,
 	  hb_unicode_funcs_t *unicode,
-	  hb_bool_t           mirror,
-	  hb_codepoint_t      u,
-	  hb_set_t           *glyphs)
+	  hb_bool_t mirror,
+	  hb_codepoint_t u,
+	  hb_set_t *glyphs)
 {
   hb_codepoint_t glyph;
-  if (font->get_nominal_glyph (u, &glyph))
-    glyphs->add (glyph);
+  if (font->get_nominal_glyph (u, &glyph)) glyphs->add (glyph);
   if (mirror)
   {
     hb_codepoint_t m = unicode->mirroring (u);
-    if (m != u && font->get_nominal_glyph (m, &glyph))
-      glyphs->add (glyph);
+    if (m != u && font->get_nominal_glyph (m, &glyph)) glyphs->add (glyph);
   }
 }
 
-
 /**
  * hb_ot_shape_glyphs_closure:
  * @font: #hb_font_t to work upon
@@ -1214,17 +1380,18 @@
  * Since: 0.9.2
  **/
 void
-hb_ot_shape_glyphs_closure (hb_font_t          *font,
-			    hb_buffer_t        *buffer,
+hb_ot_shape_glyphs_closure (hb_font_t *font,
+			    hb_buffer_t *buffer,
 			    const hb_feature_t *features,
-			    unsigned int        num_features,
-			    hb_set_t           *glyphs)
+			    unsigned int num_features,
+			    hb_set_t *glyphs)
 {
   const char *shapers[] = {"ot", nullptr};
-  hb_shape_plan_t *shape_plan = hb_shape_plan_create_cached (font->face, &buffer->props,
-							     features, num_features, shapers);
+  hb_shape_plan_t *shape_plan = hb_shape_plan_create_cached (
+      font->face, &buffer->props, features, num_features, shapers);
 
-  bool mirror = hb_script_get_horizontal_direction (buffer->props.script) == HB_DIRECTION_RTL;
+  bool mirror = hb_script_get_horizontal_direction (buffer->props.script) ==
+		HB_DIRECTION_RTL;
 
   unsigned int count = buffer->len;
   hb_glyph_info_t *info = buffer->info;
@@ -1240,5 +1407,4 @@
   hb_shape_plan_destroy (shape_plan);
 }
 
-
 #endif
Index: source/libs/harfbuzz/harfbuzz-src/src/hb-shape-plan.cc
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/hb-shape-plan.cc	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/hb-shape-plan.cc	(working copy)
@@ -402,7 +402,7 @@
 
   assert (!hb_object_is_immutable (buffer));
 
-  buffer->assert_unicode ();
+  // VisualMetaFont buffer->assert_unicode ();
 
   if (unlikely (hb_object_is_inert (shape_plan)))
     return false;
Index: source/libs/harfbuzz/harfbuzz-src/src/Makefile.sources
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/Makefile.sources	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/Makefile.sources	(working copy)
@@ -168,6 +168,9 @@
 	hb-utf.hh \
 	hb-vector.hh \
 	hb.hh \
+	hb-ot-layout-jtst-table.hh \
+	hb-ot-layout-jtst-context.hh \
+	hb-ot-layout-jtst-context.cc \ 
 	$(NULL)
 
 HB_BASE_RAGEL_GENERATED_sources = \
Index: source/libs/harfbuzz/harfbuzz-src/src/meson.build
===================================================================
--- source/libs/harfbuzz/harfbuzz-src/src/meson.build	(revision 7410)
+++ source/libs/harfbuzz/harfbuzz-src/src/meson.build	(working copy)
@@ -173,6 +173,9 @@
   'hb-utf.hh',
   'hb-vector.hh',
   'hb.hh',
+  'hb-ot-layout-jtst-table.hh',
+  'hb-ot-layout-jtst-context.hh',
+  'hb-ot-layout-jtst-context.cc',
 )
 
 hb_base_ragel_generated_sources = files(
Index: source/libs/harfbuzz/include/Makefile.in
===================================================================
--- source/libs/harfbuzz/include/Makefile.in	(revision 7398)
+++ source/libs/harfbuzz/include/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/harfbuzz/Makefile.am
===================================================================
--- source/libs/harfbuzz/Makefile.am	(revision 7398)
+++ source/libs/harfbuzz/Makefile.am	(working copy)
@@ -218,7 +218,10 @@
 	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-indic-machine.hh \
 	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-khmer-machine.hh \
 	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-myanmar-machine.hh \
-	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-use-machine.hh
+	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-use-machine.hh \
+	@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-context.cc \
+	@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-context.hh \
+	@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-table.hh
 
 ## Graphite library
 AM_CPPFLAGS += $(GRAPHITE2_INCLUDES)
Index: source/libs/harfbuzz/Makefile.in
===================================================================
--- source/libs/harfbuzz/Makefile.in	(revision 7398)
+++ source/libs/harfbuzz/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -170,6 +170,7 @@
 	@HARFBUZZ_TREE@/src/hb-ot-shape-normalize.$(OBJEXT) \
 	@HARFBUZZ_TREE@/src/hb-ot-shape-fallback.$(OBJEXT) \
 	@HARFBUZZ_TREE@/src/hb-ot-var.$(OBJEXT) \
+	@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-context.$(OBJEXT) \
 	@HARFBUZZ_TREE@/src/hb-graphite2.$(OBJEXT)
 libharfbuzz_a_OBJECTS = $(am_libharfbuzz_a_OBJECTS)
 am_hbtest_OBJECTS = hbtest-hbtest.$(OBJEXT)
@@ -213,6 +214,7 @@
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-color.Po \
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-face.Po \
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-font.Po \
+	@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout-jtst-context.Po \
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout.Po \
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-map.Po \
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-math.Po \
@@ -505,7 +507,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -580,8 +581,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -888,6 +887,9 @@
 	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-khmer-machine.hh \
 	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-myanmar-machine.hh \
 	@HARFBUZZ_TREE@/src/hb-ot-shape-complex-use-machine.hh \
+	@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-context.cc \
+	@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-context.hh \
+	@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-table.hh \
 	@HARFBUZZ_TREE@/src/hb-graphite2.cc
 @build_TRUE@dist_check_SCRIPTS = harfbuzz.test
 @build_TRUE@TESTS = harfbuzz.test
@@ -1127,6 +1129,9 @@
 @HARFBUZZ_TREE@/src/hb-ot-var.$(OBJEXT):  \
 	@HARFBUZZ_TREE@/src/$(am__dirstamp) \
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/$(am__dirstamp)
+@HARFBUZZ_TREE@/src/hb-ot-layout-jtst-context.$(OBJEXT):  \
+	@HARFBUZZ_TREE@/src/$(am__dirstamp) \
+	@HARFBUZZ_TREE@/src/$(DEPDIR)/$(am__dirstamp)
 @HARFBUZZ_TREE@/src/hb-graphite2.$(OBJEXT):  \
 	@HARFBUZZ_TREE@/src/$(am__dirstamp) \
 	@HARFBUZZ_TREE@/src/$(DEPDIR)/$(am__dirstamp)
@@ -1167,6 +1172,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote@@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-color.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-face.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-font.Po@am__quote@ # am--include-marker
+@AMDEP_TRUE@@am__include@ @am__quote@@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout-jtst-context.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-map.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@@HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-math.Po@am__quote@ # am--include-marker
@@ -1497,7 +1503,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1695,7 +1701,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
@@ -1818,6 +1824,7 @@
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-color.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-face.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-font.Po
+	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout-jtst-context.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-map.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-math.Po
@@ -1919,6 +1926,7 @@
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-color.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-face.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-font.Po
+	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout-jtst-context.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-layout.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-map.Po
 	-rm -f @HARFBUZZ_TREE@/src/$(DEPDIR)/hb-ot-math.Po
Index: source/libs/libpng/aclocal.m4
===================================================================
--- source/libs/libpng/aclocal.m4	(revision 7398)
+++ source/libs/libpng/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -759,7 +759,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/libpng/configure
===================================================================
--- source/libs/libpng/configure	(revision 7398)
+++ source/libs/libpng/configure	(working copy)
@@ -2467,7 +2467,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/libpng/include/Makefile.in
===================================================================
--- source/libs/libpng/include/Makefile.in	(revision 7398)
+++ source/libs/libpng/include/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/libpng/Makefile.in
===================================================================
--- source/libs/libpng/Makefile.in	(revision 7398)
+++ source/libs/libpng/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -432,7 +432,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -505,8 +504,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1068,7 +1065,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1266,7 +1263,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/lua53/aclocal.m4
===================================================================
--- source/libs/lua53/aclocal.m4	(revision 7398)
+++ source/libs/lua53/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/lua53/configure
===================================================================
--- source/libs/lua53/configure	(revision 7398)
+++ source/libs/lua53/configure	(working copy)
@@ -2533,7 +2533,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/lua53/include/Makefile.in
===================================================================
--- source/libs/lua53/include/Makefile.in	(revision 7398)
+++ source/libs/lua53/include/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/lua53/Makefile.in
===================================================================
--- source/libs/lua53/Makefile.in	(revision 7398)
+++ source/libs/lua53/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -458,7 +458,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -533,8 +532,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1288,7 +1285,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1486,7 +1483,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/luajit/aclocal.m4
===================================================================
--- source/libs/luajit/aclocal.m4	(revision 7398)
+++ source/libs/luajit/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -759,7 +759,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/luajit/configure
===================================================================
--- source/libs/luajit/configure	(revision 7398)
+++ source/libs/luajit/configure	(working copy)
@@ -2600,7 +2600,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/luajit/include/Makefile.in
===================================================================
--- source/libs/luajit/include/Makefile.in	(revision 7398)
+++ source/libs/luajit/include/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/luajit/Makefile.in
===================================================================
--- source/libs/luajit/Makefile.in	(revision 7398)
+++ source/libs/luajit/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -522,7 +522,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -598,8 +597,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1484,7 +1481,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1682,7 +1679,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/luajit/native/aclocal.m4
===================================================================
--- source/libs/luajit/native/aclocal.m4	(revision 7398)
+++ source/libs/luajit/native/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/luajit/native/configure
===================================================================
--- source/libs/luajit/native/configure	(revision 7398)
+++ source/libs/luajit/native/configure	(working copy)
@@ -2404,7 +2404,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/luajit/native/Makefile.in
===================================================================
--- source/libs/luajit/native/Makefile.in	(revision 7398)
+++ source/libs/luajit/native/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -212,8 +212,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -724,7 +722,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/Makefile.in
===================================================================
--- source/libs/Makefile.in	(revision 7398)
+++ source/libs/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -235,8 +235,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -662,7 +660,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/pplib/aclocal.m4
===================================================================
--- source/libs/pplib/aclocal.m4	(revision 7398)
+++ source/libs/pplib/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/pplib/configure
===================================================================
--- source/libs/pplib/configure	(revision 7398)
+++ source/libs/pplib/configure	(working copy)
@@ -2543,7 +2543,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/pplib/include/Makefile.in
===================================================================
--- source/libs/pplib/include/Makefile.in	(revision 7398)
+++ source/libs/pplib/include/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/pplib/Makefile.in
===================================================================
--- source/libs/pplib/Makefile.in	(revision 7398)
+++ source/libs/pplib/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -454,7 +454,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -528,8 +527,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1209,7 +1206,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1407,7 +1404,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/zlib/aclocal.m4
===================================================================
--- source/libs/zlib/aclocal.m4	(revision 7398)
+++ source/libs/zlib/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/zlib/configure
===================================================================
--- source/libs/zlib/configure	(revision 7398)
+++ source/libs/zlib/configure	(working copy)
@@ -2303,7 +2303,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/zlib/include/Makefile.in
===================================================================
--- source/libs/zlib/include/Makefile.in	(revision 7398)
+++ source/libs/zlib/include/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/zlib/Makefile.in
===================================================================
--- source/libs/zlib/Makefile.in	(revision 7398)
+++ source/libs/zlib/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -406,7 +406,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -478,8 +477,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1007,7 +1004,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1205,7 +1202,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/libs/zziplib/aclocal.m4
===================================================================
--- source/libs/zziplib/aclocal.m4	(revision 7398)
+++ source/libs/zziplib/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/zziplib/configure
===================================================================
--- source/libs/zziplib/configure	(revision 7398)
+++ source/libs/zziplib/configure	(working copy)
@@ -2635,7 +2635,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/libs/zziplib/include/zzip/Makefile.in
===================================================================
--- source/libs/zziplib/include/zzip/Makefile.in	(revision 7398)
+++ source/libs/zziplib/include/zzip/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/libs/zziplib/Makefile.in
===================================================================
--- source/libs/zziplib/Makefile.in	(revision 7398)
+++ source/libs/zziplib/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -404,7 +404,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -479,8 +478,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1003,7 +1000,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -1201,7 +1198,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/Makefile.in
===================================================================
--- source/Makefile.in	(revision 7398)
+++ source/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -254,8 +254,6 @@
 GZIP_ENV = --best
 DIST_ARCHIVES = $(distdir).tar.xz
 DIST_TARGETS = dist-xz
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
 ACLOCAL = @ACLOCAL@ --force
@@ -755,7 +753,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/texk/aclocal.m4
===================================================================
--- source/texk/aclocal.m4	(revision 7398)
+++ source/texk/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/configure
===================================================================
--- source/texk/configure	(revision 7398)
+++ source/texk/configure	(working copy)
@@ -4079,7 +4079,12 @@
 program_transform_name=`$as_echo "$program_transform_name" | sed "$ac_script"`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/kpathsea/aclocal.m4
===================================================================
--- source/texk/kpathsea/aclocal.m4	(revision 7398)
+++ source/texk/kpathsea/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/kpathsea/configure
===================================================================
--- source/texk/kpathsea/configure	(revision 7398)
+++ source/texk/kpathsea/configure	(working copy)
@@ -2943,7 +2943,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/kpathsea/doc/Makefile.in
===================================================================
--- source/texk/kpathsea/doc/Makefile.in	(revision 7398)
+++ source/texk/kpathsea/doc/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/kpathsea/Makefile.in
===================================================================
--- source/texk/kpathsea/Makefile.in	(revision 7398)
+++ source/texk/kpathsea/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -551,7 +551,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 TEST_EXTENSIONS = @EXEEXT@ .test
@@ -626,8 +625,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -1845,7 +1842,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -2040,7 +2037,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
@@ -2106,8 +2103,7 @@
 	done
 install: $(BUILT_SOURCES)
 	$(MAKE) $(AM_MAKEFLAGS) install-recursive
-install-exec: $(BUILT_SOURCES)
-	$(MAKE) $(AM_MAKEFLAGS) install-exec-recursive
+install-exec: install-exec-recursive
 install-data: install-data-recursive
 uninstall: uninstall-recursive
 
@@ -2348,7 +2344,7 @@
 	uninstall-nodist_kpseincludeHEADERS uninstall-pkgconfigDATA
 
 .MAKE: $(am__recursive_targets) all check check-am install install-am \
-	install-exec install-strip
+	install-strip
 
 .PHONY: $(am__recursive_targets) CTAGS GTAGS TAGS all all-am \
 	am--depfiles am--refresh check check-TESTS check-am clean \
Index: source/texk/kpathsea/man/Makefile.in
===================================================================
--- source/texk/kpathsea/man/Makefile.in	(revision 7398)
+++ source/texk/kpathsea/man/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/kpathsea/win32/Makefile.in
===================================================================
--- source/texk/kpathsea/win32/Makefile.in	(revision 7398)
+++ source/texk/kpathsea/win32/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/Makefile.in
===================================================================
--- source/texk/Makefile.in	(revision 7398)
+++ source/texk/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -235,8 +235,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -665,7 +663,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/texk/texlive/aclocal.m4
===================================================================
--- source/texk/texlive/aclocal.m4	(revision 7398)
+++ source/texk/texlive/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/texlive/configure
===================================================================
--- source/texk/texlive/configure	(revision 7398)
+++ source/texk/texlive/configure	(working copy)
@@ -2012,7 +2012,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/texlive/linked_scripts/Makefile.in
===================================================================
--- source/texk/texlive/linked_scripts/Makefile.in	(revision 7398)
+++ source/texk/texlive/linked_scripts/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/texlive/Makefile.in
===================================================================
--- source/texk/texlive/Makefile.in	(revision 7398)
+++ source/texk/texlive/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -338,7 +338,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 TEST_SUITE_LOG = test-suite.log
 am__test_logs1 = $(TESTS:=.log)
@@ -405,8 +404,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -753,7 +750,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -948,7 +945,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
Index: source/texk/texlive/tl_support/Makefile.in
===================================================================
--- source/texk/texlive/tl_support/Makefile.in	(revision 7398)
+++ source/texk/texlive/tl_support/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/web2c/aclocal.m4
===================================================================
--- source/texk/web2c/aclocal.m4	(revision 7398)
+++ source/texk/web2c/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -776,7 +776,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/web2c/configure
===================================================================
--- source/texk/web2c/configure	(revision 7398)
+++ source/texk/web2c/configure	(working copy)
@@ -3560,7 +3560,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/web2c/doc/Makefile.in
===================================================================
--- source/texk/web2c/doc/Makefile.in	(revision 7398)
+++ source/texk/web2c/doc/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/web2c/doc/web2c.info
===================================================================
--- source/texk/web2c/doc/web2c.info	(revision 7398)
+++ source/texk/web2c/doc/web2c.info	(working copy)
@@ -1,4 +1,4 @@
-This is web2c.info, produced by makeinfo version 5.1 from web2c.texi.
+This is web2c.info, produced by makeinfo version 6.7 from web2c.texi.
 
 This file documents the installation and use of the programs in Web2c,
 an implementation of Donald Knuth's TeX system.
@@ -2418,9 +2418,9 @@
 
 * Menu:
 
-* tangle invocation::           
-* weave invocation::            
-* pooltype invocation::         
+* tangle invocation::
+* weave invocation::
+* pooltype invocation::
 
 
 File: web2c.info,  Node: tangle invocation,  Next: weave invocation,  Up: WEB
@@ -2659,7 +2659,7 @@
 
 * Menu:
 
-* dvitype output example::      
+* dvitype output example::
 
 
 File: web2c.info,  Node: dvitype output example,  Up: dvitype invocation
@@ -3494,8 +3494,8 @@
  [index ]
 * Menu:
 
-* '"' character, ignored in filenames:   \input filenames.    (line  22)
-* '#define' options:                     Compile-time options.
+* " character, ignored in filenames:     \input filenames.    (line  22)
+* #define options:                       Compile-time options.
                                                               (line   6)
 * $ expansion in filenames:              \input filename caveats.
                                                               (line  17)
@@ -3537,7 +3537,7 @@
 * -base=BASE:                            Determining the memory dump to use.
                                                               (line  15)
 * -base=DUMPNAME:                        Common options.      (line  34)
-* -change=CHFILE:                        mft invocation.      (line  62)
+* -change=CHFILE:                        mft invocation.      (line  63)
 * -charcode-format=TYPE:                 tftopl invocation.   (line  27)
 * -charcode-format=TYPE <1>:             vftovp invocation.   (line  30)
 * -D compiler options:                   Compile-time options.
@@ -3598,7 +3598,7 @@
 * -shell-restricted:                     tex invocation.      (line 121)
 * -show-opcodes:                         dvitype invocation.  (line  52)
 * -strict:                               tangle invocation.   (line  46)
-* -style=MFTFILE:                        mft invocation.      (line  66)
+* -style=MFTFILE:                        mft invocation.      (line  67)
 * -T:                                    mpost invocation.    (line 115)
 * -terse:                                bibtex invocation.   (line  28)
 * -tex=TEXPROGRAM:                       mpost invocation.    (line 118)
@@ -3618,7 +3618,7 @@
 * .fmt:                                  Initial TeX.         (line   6)
 * .mf:                                   mf invocation.       (line  24)
 * .mp:                                   mpost invocation.    (line  30)
-* '.mps' files and PDF:                  mpost invocation.    (line  86)
+* .mps files and PDF:                    mpost invocation.    (line  86)
 * .NNN PostScript figures:               mpost invocation.    (line  35)
 * .NNNgf generic fonts:                  mf invocation.       (line  34)
 * .tcx character translation files:      Common options.      (line  98)
@@ -3642,12 +3642,12 @@
 * \font and dynamic generation:          tex invocation.      (line  41)
 * \fontdimen:                            tftopl invocation.   (line  99)
 * \immediate\write18:                    Shell escapes.       (line   6)
-* '\input' braced (grouped) filename:    \input braced filename.
+* \input braced (grouped) filename:      \input braced filename.
                                                               (line   6)
-* '\input' filename caveats:             \input filename caveats.
+* \input filename caveats:               \input filename caveats.
                                                               (line   6)
 * \input filenames:                      \input filenames.    (line   6)
-* '\input' quoted filename:              \input quoted filename.
+* \input quoted filename:                \input quoted filename.
                                                               (line   6)
 * \input, and pipes:                     Shell escapes.       (line  64)
 * \mag:                                  dvicopy invocation.  (line  20)
@@ -3655,9 +3655,9 @@
 * \openin, and pipes:                    Shell escapes.       (line  64)
 * \openout and security:                 tex invocation.      (line  48)
 * \openout, and pipes:                   Shell escapes.       (line  64)
-* \output routine, and '\write':         Shell escapes.       (line  28)
+* \output routine, and \write:           Shell escapes.       (line  28)
 * \pdfshellescape:                       Shell escapes.       (line  64)
-* \string, and '\input filenames':       \input filename caveats.
+* \string, and \input filenames:         \input filename caveats.
                                                               (line  29)
 * \tracingcharsubdef and MLTeX:          \tracingcharsubdef.  (line   6)
 * \tracinglostchars and MLTeX:           \tracingcharsubdef.  (line  11)
@@ -3727,7 +3727,7 @@
 * binaries, linking:                     Common options.      (line  77)
 * blank lines, in TCX files:             TCX files.           (line  66)
 * boxes, memory for:                     Runtime options.     (line  20)
-* braced filename for '\input':          \input braced filename.
+* braced filename for \input:            \input braced filename.
                                                               (line   6)
 * breakpoints, memory for:               Runtime options.     (line  20)
 * Breitenlohner, Peter:                  Introduction.        (line   8)
@@ -3741,9 +3741,9 @@
 * byte swapping:                         Hardware and memory dumps.
                                                               (line  13)
 * c-sources Makefile target:             Additional targets.  (line  12)
-* caveats for '\input' filenames:        \input filename caveats.
+* caveats for \input filenames:          \input filename caveats.
                                                               (line   6)
-* change files, and MFT:                 mft invocation.      (line  62)
+* change files, and MFT:                 mft invocation.      (line  63)
 * change files, and Tangle:              tangle invocation.   (line  11)
 * change files, and Weave:               weave invocation.    (line  14)
 * changing error messages style:         Common options.      (line  26)
@@ -3763,7 +3763,7 @@
                                                               (line  69)
 * cm.base:                               Initial Metafont.    (line  26)
 * cmbase.mf:                             Initial Metafont.    (line  26)
-* cmbase.mft:                            mft invocation.      (line  72)
+* cmbase.mft:                            mft invocation.      (line  73)
 * cmmf.base not recommended:             Initial Metafont.    (line  26)
 * color, in DVItoMP:                     dvitomp invocation.  (line  15)
 * comments, in TCX files:                TCX files.           (line  70)
@@ -3776,7 +3776,7 @@
                                                               (line   6)
 * Computer Modern fonts, and Troff:      mpost invocation.    (line  65)
 * Computer Modern macros:                Initial Metafont.    (line  26)
-* 'Computer Modern Typefaces', production of: mft invocation. (line  72)
+* Computer Modern Typefaces, production of: mft invocation.   (line  73)
 * configuration:                         Installation.        (line   6)
 * configuration file reading:            Path searching.      (line   6)
 * configuration file values:             Runtime options.     (line   6)
@@ -3842,12 +3842,12 @@
 * dx horizontal escapement <1>:          gftype invocation.   (line 106)
 * dy vertical escapement:                gftype invocation.   (line 106)
 * dynamic array allocation:              Runtime options.     (line  45)
-* dynamic Metafont mode definitions with 'smode': Modes.      (line  28)
+* dynamic Metafont mode definitions with smode: Modes.        (line  28)
 * dynamic packing variable:              pktype invocation.   (line  44)
 * e response at error prompt:            Editor invocation.   (line   6)
 * e-circumflex:                          \charsubdef.         (line  20)
 * e-TeX:                                 TeX extensions.      (line  10)
-* e.mft:                                 mft invocation.      (line  72)
+* e.mft:                                 mft invocation.      (line  73)
 * EC fonts:                              tex invocation.      (line  41)
 * EC fonts <1>:                          mf invocation.       (line  24)
 * editing of bitmap fonts:               Font utilities available elsewhere.
@@ -3875,7 +3875,7 @@
 * expanded plain format:                 Formats.             (line  54)
 * expand_depth:                          Runtime options.     (line  24)
 * expansion limit, recursive:            Runtime options.     (line  25)
-* expansion, and '\input' filenames:     \input filename caveats.
+* expansion, and \input filenames:       \input filename caveats.
                                                               (line   6)
 * extensions to TeX:                     TeX extensions.      (line   6)
 * extra_mem_bot:                         Runtime options.     (line  19)
@@ -3886,7 +3886,7 @@
 * file formats for fonts:                Font file formats.   (line   6)
 * file recorder:                         Common options.      (line  84)
 * filename conventions, in input files:  \input filenames.    (line   6)
-* filenames starting with '-':           Option conventions.  (line  19)
+* filenames starting with -:             Option conventions.  (line  19)
 * first line of the main input file:     Common options.      (line  98)
 * fixed-point arithmetic:                Compile-time options.
                                                               (line  21)
@@ -3950,7 +3950,7 @@
 * glue, memory for:                      Runtime options.     (line  20)
 * glyph substitutions:                   MLTeX.               (line   6)
 * gray font:                             gftodvi invocation.  (line  29)
-* group-delimited filename for '\input': \input braced filename.
+* group-delimited filename for \input:   \input braced filename.
                                                               (line   6)
 * Gruff, Billy Goat:                     Triptrap.            (line   6)
 * gsftopk:                               Font utilities available elsewhere.
@@ -4005,7 +4005,7 @@
 * install-formats Make target:           Additional targets.  (line  17)
 * install-mems Make target:              Additional targets.  (line  34)
 * installation:                          Installation.        (line   6)
-* interaction between TCX files and '-8bit'.: TCX files.      (line 104)
+* interaction between TCX files and -8bit.: TCX files.        (line 104)
 * interaction mode:                      Common options.      (line  50)
 * international characters:              TCX files.           (line   6)
 * introduction:                          Introduction.        (line   6)
@@ -4042,7 +4042,7 @@
 * literate programming:                  WEB.                 (line   6)
 * LittleEndian machines:                 Hardware and memory dumps.
                                                               (line   6)
-* location of 'texmf.cnf' in TeX Live:   Runtime options.     (line  56)
+* location of texmf.cnf in TeX Live:     Runtime options.     (line  56)
 * log file, BibTeX:                      bibtex invocation.   (line  14)
 * Lua:                                   TeX extensions.      (line  30)
 * LuaTeX:                                TeX extensions.      (line  30)
@@ -4098,7 +4098,7 @@
                                                               (line  15)
 * MetaPost input files:                  mpost invocation.    (line  30)
 * MetaPost invocation:                   mpost invocation.    (line   6)
-* MetaPost source, prettyprinting:       mft invocation.      (line  78)
+* MetaPost source, prettyprinting:       mft invocation.      (line  79)
 * MetaPost, initial:                     Initial MetaPost.    (line   6)
 * MetaPost, TeX, and Metafont:           Three programs.      (line   6)
 * metatype1:                             Font utilities available elsewhere.
@@ -4124,7 +4124,7 @@
 * modes.mf recommended modes file:       Modes.               (line  10)
 * mode_def:                              Modes.               (line  15)
 * mode_setup:                            Modes.               (line  15)
-* modifying 'texmf.cnf' in TeX Live:     Runtime options.     (line  56)
+* modifying texmf.cnf in TeX Live:       Runtime options.     (line  56)
 * Morgan, Tim:                           Introduction.        (line  42)
 * Morris, Bob:                           Introduction.        (line  53)
 * MPEDIT:                                Editor invocation.   (line  10)
@@ -4139,7 +4139,7 @@
 * mptrap.readme:                         Triptrap.            (line   6)
 * MPX files, converting from DVI files:  dvitomp invocation.  (line   6)
 * Multi-lingual TeX:                     MLTeX.               (line   6)
-* multiple spaces, and '\input' filenames: \input filename caveats.
+* multiple spaces, and \input filenames: \input filename caveats.
                                                               (line   6)
 * N tilde:                               \charsubdef.         (line  36)
 * new graphics support for Metafont:     Online Metafont graphics.
@@ -4181,7 +4181,7 @@
 * path searching:                        Path searching.      (line   6)
 * path searching debugging:              Common options.      (line  59)
 * PDF:                                   TeX extensions.      (line  22)
-* PDF, and '.mps' files:                 mpost invocation.    (line  86)
+* PDF, and .mps files:                   mpost invocation.    (line  86)
 * pdfTeX:                                TeX extensions.      (line  22)
 * permissions, legal:                    Legalisms.           (line   6)
 * PFA and PFB conversion:                Font utilities available elsewhere.
@@ -4214,7 +4214,7 @@
 * plain.bst:                             Basic BibTeX style files.
                                                               (line  11)
 * plain.fmt:                             Initial TeX.         (line  13)
-* plain.mft:                             mft invocation.      (line  66)
+* plain.mft:                             mft invocation.      (line  67)
 * pltotf:                                pltotf invocation.   (line   6)
 * pool file, writing:                    tangle invocation.   (line  16)
 * Poole, Simon:                          Online Metafont graphics.
@@ -4257,7 +4257,7 @@
 * PXL files, explained:                  Font file formats.   (line  39)
 * pxtoch:                                Font utilities available elsewhere.
                                                               (line  23)
-* quoted filename for '\input':          \input quoted filename.
+* quoted filename for \input:            \input quoted filename.
                                                               (line   6)
 * Raichle, Bernd:                        MLTeX.               (line   6)
 * reading, additional:                   Introduction.        (line  61)
@@ -4292,8 +4292,8 @@
                                                               (line  42)
 * security, and output files:            tex invocation.      (line  48)
 * security, and shell escapes:           Shell escapes.       (line   6)
-* security, and 'write':                 mpost invocation.    (line  92)
-* security, and '\openout':              tex invocation.      (line  48)
+* security, and write:                   mpost invocation.    (line  92)
+* security, and \openout:                tex invocation.      (line  48)
 * segmentation fault:                    Runtime options.     (line  25)
 * shapes:                                Metafont.            (line   6)
 * sharing memory dumps:                  Hardware and memory dumps.
@@ -4325,7 +4325,7 @@
 * string pool, writing:                  tangle invocation.   (line  16)
 * string representation:                 pooltype invocation. (line  30)
 * style design, for BibTeX:              bibtex invocation.   (line  49)
-* style files:                           mft invocation.      (line  66)
+* style files:                           mft invocation.      (line  67)
 * substitutions of font glyphs:          MLTeX.               (line   6)
 * sun:                                   Online Metafont graphics.
                                                               (line  42)
@@ -4342,7 +4342,7 @@
 * system C library function:             Shell escapes.       (line   6)
 * system command:                        Shell escapes.       (line   6)
 * T1 encoding and ISO input:             TCX files.           (line  48)
-* tabs, and '\input' filenames:          \input filename caveats.
+* tabs, and \input filenames:            \input filename caveats.
                                                               (line   6)
 * Tachikawa, Elizabeth:                  Font file formats.   (line  62)
 * tangle:                                tangle invocation.   (line   6)
@@ -4384,7 +4384,7 @@
                                                               (line  79)
 * TEXMFOUTPUT, used for reading:         Output file location.
                                                               (line  25)
-* TEXMFOUTPUT, used if '.' unwritable:   Output file location.
+* TEXMFOUTPUT, used if . unwritable:     Output file location.
                                                               (line  19)
 * texmf_casefold_search:                 Runtime options.     (line  42)
 * texput:                                tex invocation.      (line  33)
@@ -4399,7 +4399,7 @@
 * time and date, in memory dumps:        Hardware and memory dumps.
                                                               (line  30)
 * title font:                            gftodvi invocation.  (line  33)
-* tokenization, and '\input' filenames:  \input filename caveats.
+* tokenization, and \input filenames:    \input filename caveats.
                                                               (line   6)
 * toolkits, X:                           Online Metafont graphics.
                                                               (line  59)
@@ -4559,26 +4559,31 @@
 Node: bibtex invocation96426
 Node: Basic BibTeX style files98900
 Node: WEB100230
-Node: tangle invocation101471
-Node: weave invocation103594
-Node: pooltype invocation105001
-Node: DVI utilities106131
-Node: dvicopy invocation107065
-Node: dvitype invocation108350
-Node: dvitype output example110687
-Node: Font utilities113740
-Node: Font file formats114920
-Node: gftopk invocation118189
-Node: pktogf invocation119380
-Node: pktype invocation120546
-Node: gftype invocation123369
-Node: tftopl invocation127872
-Node: pltotf invocation132465
-Node: vftovp invocation133516
-Node: vptovf invocation135751
-Node: Font utilities available elsewhere136778
-Node: Legalisms139158
-Node: References140604
-Node: Index144692
+Node: tangle invocation101439
+Node: weave invocation103562
+Node: pooltype invocation104969
+Node: DVI utilities106099
+Node: dvicopy invocation107033
+Node: dvitype invocation108318
+Node: dvitype output example110649
+Node: Font utilities113702
+Node: Font file formats114882
+Node: gftopk invocation118151
+Node: pktogf invocation119342
+Node: pktype invocation120508
+Node: gftype invocation123331
+Node: tftopl invocation127834
+Node: pltotf invocation132427
+Node: vftovp invocation133478
+Node: vptovf invocation135713
+Node: Font utilities available elsewhere136740
+Node: Legalisms139120
+Node: References140566
+Node: Index144654
 
 End Tag Table
+
+
+Local Variables:
+coding: utf-8
+End:
Index: source/texk/web2c/lib/Makefile.in
===================================================================
--- source/texk/web2c/lib/Makefile.in	(revision 7398)
+++ source/texk/web2c/lib/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/web2c/luatexdir/am/luaharfbuzz.am
===================================================================
--- source/texk/web2c/luatexdir/am/luaharfbuzz.am	(revision 7398)
+++ source/texk/web2c/luatexdir/am/luaharfbuzz.am	(working copy)
@@ -28,6 +28,7 @@
 	luatexdir/luaharfbuzz/src/luaharfbuzz/direction.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/face.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/font.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/language.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.c \
Index: source/texk/web2c/luatexdir/lua/lpdflib.c
===================================================================
--- source/texk/web2c/luatexdir/lua/lpdflib.c	(revision 7398)
+++ source/texk/web2c/luatexdir/lua/lpdflib.c	(working copy)
@@ -116,8 +116,8 @@
         first_arg++;
         k = (int) lua_tointeger(L, 1);
         check_obj_type(static_pdf, obj_type_obj, k);
-        if (is_obj_scheduled(static_pdf, k) || obj_data_ptr(static_pdf, k) != 0)
-            luaL_error(L, "pdf.immediateobj() object in use");
+		if (is_obj_scheduled(static_pdf, k) || obj_data_ptr(static_pdf, k) != 0)
+			/* Amine luaL_error(L, "pdf.immediateobj() object in use");*/;
     } else {
         static_pdf->obj_count++;
         k = pdf_create_obj(static_pdf, obj_type_obj, static_pdf->obj_ptr + 1);
Index: source/texk/web2c/luatexdir/luaharfbuzz/luaharfbuzz-1.1.0-1.rockspec
===================================================================
--- source/texk/web2c/luatexdir/luaharfbuzz/luaharfbuzz-1.1.0-1.rockspec	(revision 7398)
+++ source/texk/web2c/luatexdir/luaharfbuzz/luaharfbuzz-1.1.0-1.rockspec	(working copy)
@@ -25,6 +25,7 @@
       "src/luaharfbuzz/font.c",
       "src/luaharfbuzz/buffer.c",
       "src/luaharfbuzz/feature.c",
+      "src/luaharfbuzz/variation.c",
       "src/luaharfbuzz/tag.c",
       "src/luaharfbuzz/ot.c",
       "src/luaharfbuzz/unicode.c",
Index: source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/buffer.c
===================================================================
--- source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/buffer.c	(revision 7398)
+++ source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/buffer.c	(working copy)
@@ -64,10 +64,20 @@
 
   unsigned int l = luaL_checkinteger(L, 2);
 
-  hb_buffer_set_flags(*b, l);
+  hb_buffer_set_flags(*b, (hb_buffer_flags_t)l);
   return 0;
 }
 
+static int buffer_set_justify(lua_State* L) {
+    Buffer* b = (Buffer*)luaL_checkudata(L, 1, "harfbuzz.Buffer");
+
+    int l = luaL_checknumber(L, 2);
+
+    hb_buffer_set_justify(*b, l);
+
+    return 0;
+}
+
 static int buffer_get_language(lua_State *L) {
   Buffer *b = (Buffer *)luaL_checkudata(L, 1, "harfbuzz.Buffer");
 
@@ -246,7 +256,7 @@
     lua_setfield(L, -2, "x_offset");
 
     lua_pushnumber(L, pos[i].y_offset);
-    lua_setfield(L, -2, "y_offset");
+    lua_setfield(L, -2, "y_offset");    
 
     flags = hb_glyph_info_get_glyph_flags(&(info[i]));
     if (flags & HB_GLYPH_FLAG_DEFINED) {
@@ -254,6 +264,15 @@
       lua_setfield(L, -2, "flags");
     }
 
+    lua_pushnumber(L, info[i].lefttatweel);
+    lua_setfield(L, -2, "lefttatweel");
+
+    lua_pushnumber(L, info[i].righttatweel);
+    lua_setfield(L, -2, "righttatweel");
+
+    lua_pushnumber(L, pos[i].base_codepoint);
+    lua_setfield(L, -2, "color");
+
     lua_settable(L, -3); // Add child table at index i+1 to parent table
   }
 
@@ -286,7 +305,7 @@
 
   unsigned int l = luaL_checkinteger(L, 2);
 
-  hb_buffer_set_cluster_level(*b, l);
+  hb_buffer_set_cluster_level(*b, (hb_buffer_cluster_level_t)l);
   return 0;
 }
 
@@ -325,6 +344,7 @@
   { "get_cluster_level", buffer_get_cluster_level },
   { "set_cluster_level", buffer_set_cluster_level },
   { "pre_allocate", buffer_pre_allocate },
+  { "set_justify", buffer_set_justify },  
   { NULL, NULL }
 };
 
Index: source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/face.c
===================================================================
--- source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/face.c	(revision 7398)
+++ source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/face.c	(working copy)
@@ -28,7 +28,7 @@
 static int face_new_from_blob(lua_State *L) {
   Face *f;
   hb_face_t *face;
-  Blob *blob = luaL_checkudata(L, 1, "harfbuzz.Blob");
+  Blob *blob = (Blob * )luaL_checkudata(L, 1, "harfbuzz.Blob");
   unsigned int face_index = (unsigned int) luaL_optinteger(L, 2, 0);
 
   face = hb_face_create(*blob, face_index);
@@ -66,7 +66,7 @@
     if (len < STATIC_ARRAY_SIZE) {
       lua_pushstring(L, name);
     } else {
-      char *name = malloc(len + 1);
+      char *name = (char*)malloc(len + 1);
       text_size = len + 1;
       hb_ot_name_get_utf8(*f, name_id, lang, &text_size, name);
       lua_pushstring(L, name);
Index: source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/font.c
===================================================================
--- source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/font.c	(revision 7398)
+++ source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/font.c	(working copy)
@@ -2,7 +2,7 @@
 
 static int font_new(lua_State *L) {
   Font *f;
-  Face *face = luaL_checkudata(L, 1, "harfbuzz.Face");
+  Face *face = (Face * )luaL_checkudata(L, 1, "harfbuzz.Face");
 
   f = (Font *)lua_newuserdata(L, sizeof(*f));
   luaL_getmetatable(L, "harfbuzz.Font");
@@ -141,7 +141,16 @@
   Font *f = (Font *)luaL_checkudata(L, 1, "harfbuzz.Font");
   hb_codepoint_t glyph = luaL_checkinteger(L, 2);
 
-  lua_pushinteger(L, hb_font_get_glyph_h_advance(*f, glyph));
+  hb_glyph_info_t info;
+  info.codepoint = glyph;
+  info.lefttatweel = 0.0;
+  info.righttatweel = 0.0;
+  hb_position_t advance;
+
+  hb_font_get_glyph_h_advances(*f, 1, &info.codepoint, 0, &advance, 0);
+
+
+  lua_pushinteger(L, advance);
   return 1;
 }
 
@@ -192,10 +201,52 @@
   return 1;
 }
 
+//Amine
+static int font_set_variations(lua_State* L) {
+    Font* font = (Font*)luaL_checkudata(L, 1, "harfbuzz.Font");
+    unsigned int i;
+    luaL_checktype(L, 2, LUA_TTABLE);
+
+    unsigned int variations_length = lua_rawlen(L, 2);
+    Variation* variations = (Variation*)malloc(variations_length * sizeof(hb_variation_t));    
+
+    for (i = 0; i != variations_length; ++i) {
+        lua_geti(L, 2, i + 1);
+        Variation* f = (hb_variation_t*)luaL_checkudata(L, -1, "harfbuzz.Variation");
+        variations[i] = *f;
+        lua_pop(L, 1);
+    }
+
+    hb_font_set_variations(*font, variations, variations_length);
+
+    free(variations);
+
+    return 1;
+}
+
+static int font_get_var_coords_normalized(lua_State* L) {
+    Font* f = (Font*)luaL_checkudata(L, 1, "harfbuzz.Font");
+
+    unsigned int length = 0;
+
+    const int* coord = hb_font_get_var_coords_normalized(*f, &length);
+
+    lua_newtable(L);
+    for (int i = 0; i < length; i++) {
+        lua_pushnumber(L, i + 1);
+        lua_pushnumber(L, coord[i]);
+        lua_settable(L, -3);
+    }
+
+    
+    return 1;
+}
+
 static const struct luaL_Reg font_methods[] = {
   { "__gc", font_destroy },
   { "set_scale", font_set_scale },
   { "get_scale", font_get_scale },
+  { "set_variations", font_set_variations },
   { "get_h_extents", font_get_h_extents },
   { "get_v_extents", font_get_v_extents },
   { "get_glyph_extents", font_get_glyph_extents },
@@ -205,6 +256,7 @@
   { "get_glyph_v_advance", font_get_glyph_v_advance },
   { "get_nominal_glyph", font_get_nominal_glyph },
   { "ot_color_glyph_get_png", font_ot_color_glyph_get_png },
+  { "get_var_coords_normalized", font_get_var_coords_normalized },
   { NULL, NULL }
 };
 
@@ -216,3 +268,4 @@
 int register_font(lua_State *L) {
   return register_class(L, "harfbuzz.Font", font_methods, font_functions, NULL);
 }
+
Index: source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.c
===================================================================
--- source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.c	(revision 7398)
+++ source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.c	(working copy)
@@ -91,6 +91,9 @@
   register_feature(L);
   lua_setfield(L, -2, "Feature");
 
+  register_variation(L);
+  lua_setfield(L, -2, "Variation");
+
   register_tag(L);
   lua_setfield(L, -2, "Tag");
 
Index: source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.h
===================================================================
--- source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.h	(revision 7398)
+++ source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.h	(working copy)
@@ -14,6 +14,7 @@
 typedef hb_font_t* Font;
 typedef hb_buffer_t* Buffer;
 typedef hb_feature_t Feature;
+typedef hb_variation_t Variation;
 typedef hb_tag_t Tag;
 typedef hb_script_t Script;
 typedef hb_direction_t Direction;
@@ -21,7 +22,7 @@
 
 typedef struct luahb_constant_t {
   const char *name;
-  int value;
+  unsigned int value;
 } luahb_constant_t;
 
 // Functions to create classes and push them onto the stack
@@ -31,6 +32,7 @@
 int register_font(lua_State *L);
 int register_buffer(lua_State *L);
 int register_feature(lua_State *L);
+int register_variation(lua_State* L);
 int register_tag(lua_State *L);
 int register_script(lua_State *L);
 int register_direction(lua_State *L);
Index: source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
===================================================================
--- source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c	(nonexistent)
+++ source/texk/web2c/luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c	(working copy)
@@ -0,0 +1,65 @@
+// harfbuzz.Feature
+#include "luaharfbuzz.h"
+
+static int variation_new(lua_State *L) {
+ 
+  Variation*fp = (Variation*)lua_newuserdata(L, sizeof(*fp));
+  luaL_getmetatable(L, "harfbuzz.Variation");
+  lua_setmetatable(L, -2);
+
+  return 1;
+}
+
+static const char *variation_tag_ptr;
+static const char *variation_value_ptr;
+
+static int variation_index(lua_State *L) {
+  Variation* f = (Variation*)luaL_checkudata(L, 1, "harfbuzz.Variation");
+  const char *key = lua_tostring(L, 2);
+
+  if (key == variation_tag_ptr) {
+    Tag *tag = (Tag *)lua_newuserdata(L, sizeof(*tag));
+    luaL_getmetatable(L, "harfbuzz.Tag");
+    lua_setmetatable(L, -2);
+    *tag = f->tag;
+  } else if (key == variation_value_ptr) {
+    lua_pushnumber(L, f->value);
+  } else {
+    lua_pushnil(L);
+  }
+  return 1;
+}
+
+static int variation_newindex(lua_State *L) {
+  Variation* f = (Variation*)luaL_checkudata(L, 1, "harfbuzz.Variation");
+  const char *key = lua_tostring(L, 2);
+
+  if (key == variation_tag_ptr) {
+    f->tag = *(Tag *)luaL_checkudata(L, 3, "harfbuzz.Tag");
+  } else if (key == variation_value_ptr) {
+    f->value = luaL_checknumber(L, 3);
+  } 
+  return 0;
+}
+
+static const struct luaL_Reg variation_methods[] = {
+  { "__index", variation_index },
+  { "__newindex", variation_newindex },
+  { NULL, NULL },
+};
+
+static const struct luaL_Reg variation_functions[] = {
+  { "new", variation_new },
+  { NULL,  NULL }
+};
+
+int register_variation(lua_State *L) {
+  lua_pushliteral(L, "tag");
+  variation_tag_ptr = lua_tostring(L, -1);
+  (void) luaL_ref (L, LUA_REGISTRYINDEX);
+  lua_pushliteral(L, "value");
+  variation_value_ptr = lua_tostring(L, -1);
+  (void) luaL_ref (L, LUA_REGISTRYINDEX);  
+
+  return register_class(L, "harfbuzz.Variation", variation_methods, variation_functions, NULL);
+}
Index: source/texk/web2c/luatexdir/luasocket/src/inet.h
===================================================================
--- source/texk/web2c/luatexdir/luasocket/src/inet.h	(revision 7398)
+++ source/texk/web2c/luatexdir/luasocket/src/inet.h	(working copy)
@@ -47,7 +47,7 @@
 #endif
 
 #ifdef LUASOCKET_INET_PTON
-const char *inet_ntop(int af, const void *src, char *dst, socklen_t cnt);
+// Amine const char *inet_ntop(int af, const void *src, char *dst, socklen_t cnt);
 int inet_pton(int af, const char *src, void *dst);
 #endif
 
Index: source/texk/web2c/luatexdir/pdf/pdftables.c
===================================================================
--- source/texk/web2c/luatexdir/pdf/pdftables.c	(revision 7398)
+++ source/texk/web2c/luatexdir/pdf/pdftables.c	(working copy)
@@ -216,8 +216,8 @@
     check_obj_exists(pdf, objnum);
     u = obj_type(pdf, objnum);
     if (t != u) {
-        formatted_error("pdf backend", "referenced object has wrong type %s; should be %s",
-            pdf_obj_typenames[u], pdf_obj_typenames[t]);
+        /* Amine formatted_error("pdf backend", "referenced object has wrong type %s; should be %s",
+            pdf_obj_typenames[u], pdf_obj_typenames[t]);*/
     }
 }
 
Index: source/texk/web2c/Makefile.in
===================================================================
--- source/texk/web2c/Makefile.in	(revision 7398)
+++ source/texk/web2c/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -589,6 +589,7 @@
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-direction.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-face.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-feature.$(OBJEXT) \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-font.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-language.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-luaharfbuzz.$(OBJEXT) \
@@ -614,6 +615,7 @@
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-direction.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-face.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-feature.$(OBJEXT) \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-font.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-language.$(OBJEXT) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-luaharfbuzz.$(OBJEXT) \
@@ -1885,6 +1887,7 @@
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-script.Po \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-tag.Po \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-unicode.Po \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Po \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-blob.Po \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-buffer.Po \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-class_utils.Po \
@@ -1898,6 +1901,7 @@
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-script.Po \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-tag.Po \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-unicode.Po \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Po \
 	luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5.Po \
 	luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5lib.Po \
 	luatexdir/luamd5/$(DEPDIR)/libluamisc_a-md5.Po \
@@ -2513,7 +2517,6 @@
   bases='$(TEST_LOGS)'; \
   bases=`for i in $$bases; do echo $$i; done | sed 's/\.log$$//'`; \
   bases=`echo $$bases`
-AM_TESTSUITE_SUMMARY_HEADER = ' for $(PACKAGE_STRING)'
 RECHECK_LOGS = $(TEST_LOGS)
 am__EXEEXT_43 = bibtex.test dvicopy.test dvitype.test gftodvi.test \
 	gftopk.test gftype.test mft.test patgen.test pktogf.test \
@@ -2631,8 +2634,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -4639,6 +4640,7 @@
 	luatexdir/luaharfbuzz/src/luaharfbuzz/direction.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/face.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/font.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/language.c \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/luaharfbuzz.c \
@@ -5334,6 +5336,9 @@
 luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-feature.$(OBJEXT):  \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(am__dirstamp) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/$(am__dirstamp)
+luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.$(OBJEXT):  \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/$(am__dirstamp) \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/$(am__dirstamp)
 luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-font.$(OBJEXT):  \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(am__dirstamp) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/$(am__dirstamp)
@@ -5383,6 +5388,9 @@
 luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-feature.$(OBJEXT):  \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(am__dirstamp) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/$(am__dirstamp)
+luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.$(OBJEXT):  \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/$(am__dirstamp) \
+	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/$(am__dirstamp)
 luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-font.$(OBJEXT):  \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(am__dirstamp) \
 	luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/$(am__dirstamp)
@@ -7484,6 +7492,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-script.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-tag.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-unicode.Po@am__quote@ # am--include-marker
+@AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-blob.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-buffer.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-class_utils.Po@am__quote@ # am--include-marker
@@ -7497,6 +7506,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-script.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-tag.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-unicode.Po@am__quote@ # am--include-marker
+@AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5lib.Po@am__quote@ # am--include-marker
 @AMDEP_TRUE@@am__include@ @am__quote@luatexdir/luamd5/$(DEPDIR)/libluamisc_a-md5.Po@am__quote@ # am--include-marker
@@ -8542,6 +8552,20 @@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluaharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluaharfbuzz_a_CFLAGS) $(CFLAGS) -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-feature.obj `if test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c'; then $(CYGPATH_W) 'luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c'; else $(CYGPATH_W) '$(srcdir)/luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c'; fi`
 
+luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.o: luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+@am__fastdepCC_TRUE@	$(AM_V_CC)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluaharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluaharfbuzz_a_CFLAGS) $(CFLAGS) -MT luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.o -MD -MP -MF luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Tpo -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.o `test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' || echo '$(srcdir)/'`luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+@am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Tpo luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' object='luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluaharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluaharfbuzz_a_CFLAGS) $(CFLAGS) -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.o `test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' || echo '$(srcdir)/'`luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+
+luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.obj: luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+@am__fastdepCC_TRUE@	$(AM_V_CC)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluaharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluaharfbuzz_a_CFLAGS) $(CFLAGS) -MT luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.obj -MD -MP -MF luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Tpo -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.obj `if test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; then $(CYGPATH_W) 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; else $(CYGPATH_W) '$(srcdir)/luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; fi`
+@am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Tpo luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' object='luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluaharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluaharfbuzz_a_CFLAGS) $(CFLAGS) -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-variation.obj `if test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; then $(CYGPATH_W) 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; else $(CYGPATH_W) '$(srcdir)/luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; fi`
+
 luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-font.o: luatexdir/luaharfbuzz/src/luaharfbuzz/font.c
 @am__fastdepCC_TRUE@	$(AM_V_CC)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluaharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluaharfbuzz_a_CFLAGS) $(CFLAGS) -MT luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-font.o -MD -MP -MF luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-font.Tpo -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluaharfbuzz_a-font.o `test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/font.c' || echo '$(srcdir)/'`luatexdir/luaharfbuzz/src/luaharfbuzz/font.c
 @am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-font.Tpo luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-font.Po
@@ -8780,6 +8804,20 @@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluajitharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluajitharfbuzz_a_CFLAGS) $(CFLAGS) -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-feature.obj `if test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c'; then $(CYGPATH_W) 'luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c'; else $(CYGPATH_W) '$(srcdir)/luatexdir/luaharfbuzz/src/luaharfbuzz/feature.c'; fi`
 
+luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.o: luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+@am__fastdepCC_TRUE@	$(AM_V_CC)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluajitharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluajitharfbuzz_a_CFLAGS) $(CFLAGS) -MT luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.o -MD -MP -MF luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Tpo -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.o `test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' || echo '$(srcdir)/'`luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+@am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Tpo luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' object='luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluajitharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluajitharfbuzz_a_CFLAGS) $(CFLAGS) -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.o `test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' || echo '$(srcdir)/'`luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+
+luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.obj: luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c
+@am__fastdepCC_TRUE@	$(AM_V_CC)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluajitharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluajitharfbuzz_a_CFLAGS) $(CFLAGS) -MT luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.obj -MD -MP -MF luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Tpo -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.obj `if test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; then $(CYGPATH_W) 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; else $(CYGPATH_W) '$(srcdir)/luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; fi`
+@am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Tpo luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c' object='luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluajitharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluajitharfbuzz_a_CFLAGS) $(CFLAGS) -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-variation.obj `if test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; then $(CYGPATH_W) 'luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; else $(CYGPATH_W) '$(srcdir)/luatexdir/luaharfbuzz/src/luaharfbuzz/variation.c'; fi`
+
 luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-font.o: luatexdir/luaharfbuzz/src/luaharfbuzz/font.c
 @am__fastdepCC_TRUE@	$(AM_V_CC)$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(libluajitharfbuzz_a_CPPFLAGS) $(CPPFLAGS) $(libluajitharfbuzz_a_CFLAGS) $(CFLAGS) -MT luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-font.o -MD -MP -MF luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-font.Tpo -c -o luatexdir/luaharfbuzz/src/luaharfbuzz/libluajitharfbuzz_a-font.o `test -f 'luatexdir/luaharfbuzz/src/luaharfbuzz/font.c' || echo '$(srcdir)/'`luatexdir/luaharfbuzz/src/luaharfbuzz/font.c
 @am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-font.Tpo luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-font.Po
@@ -16129,7 +16167,7 @@
 	  test x"$$VERBOSE" = x || cat $(TEST_SUITE_LOG);		\
 	fi;								\
 	echo "$${col}$$br$${std}"; 					\
-	echo "$${col}Testsuite summary"$(AM_TESTSUITE_SUMMARY_HEADER)"$${std}";	\
+	echo "$${col}Testsuite summary for $(PACKAGE_STRING)$${std}";	\
 	echo "$${col}$$br$${std}"; 					\
 	create_testsuite_report --maybe-color;				\
 	echo "$$col$$br$$std";						\
@@ -16341,7 +16379,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
@@ -16852,6 +16890,7 @@
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-script.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-tag.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-unicode.Po
+	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-blob.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-buffer.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-class_utils.Po
@@ -16865,6 +16904,7 @@
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-script.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-tag.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-unicode.Po
+	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Po
 	-rm -f luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5.Po
 	-rm -f luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5lib.Po
 	-rm -f luatexdir/luamd5/$(DEPDIR)/libluamisc_a-md5.Po
@@ -17504,6 +17544,7 @@
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-script.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-tag.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-unicode.Po
+	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluaharfbuzz_a-variation.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-blob.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-buffer.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-class_utils.Po
@@ -17517,6 +17558,7 @@
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-script.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-tag.Po
 	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-unicode.Po
+	-rm -f luatexdir/luaharfbuzz/src/luaharfbuzz/$(DEPDIR)/libluajitharfbuzz_a-variation.Po
 	-rm -f luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5.Po
 	-rm -f luatexdir/luamd5/$(DEPDIR)/libluajitmisc_a-md5lib.Po
 	-rm -f luatexdir/luamd5/$(DEPDIR)/libluamisc_a-md5.Po
Index: source/texk/web2c/man/Makefile.in
===================================================================
--- source/texk/web2c/man/Makefile.in	(revision 7398)
+++ source/texk/web2c/man/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
Index: source/texk/web2c/web2c/aclocal.m4
===================================================================
--- source/texk/web2c/web2c/aclocal.m4	(revision 7398)
+++ source/texk/web2c/web2c/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/web2c/web2c/configure
===================================================================
--- source/texk/web2c/web2c/configure	(revision 7398)
+++ source/texk/web2c/web2c/configure	(working copy)
@@ -2917,7 +2917,12 @@
 am_aux_dir=`cd "$ac_aux_dir" && pwd`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/texk/web2c/web2c/Makefile.in
===================================================================
--- source/texk/web2c/web2c/Makefile.in	(revision 7398)
+++ source/texk/web2c/web2c/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -262,8 +262,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -756,7 +754,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
@@ -814,8 +812,7 @@
 installdirs:
 install: $(BUILT_SOURCES)
 	$(MAKE) $(AM_MAKEFLAGS) install-am
-install-exec: $(BUILT_SOURCES)
-	$(MAKE) $(AM_MAKEFLAGS) install-exec-am
+install-exec: install-exec-am
 install-data: install-data-am
 uninstall: uninstall-am
 
@@ -936,7 +933,7 @@
 
 uninstall-am:
 
-.MAKE: all check install install-am install-exec install-strip
+.MAKE: all check install install-am install-strip
 
 .PHONY: CTAGS GTAGS TAGS all all-am am--depfiles am--refresh check \
 	check-am clean clean-cscope clean-generic clean-libtool \
Index: source/utils/aclocal.m4
===================================================================
--- source/utils/aclocal.m4	(revision 7398)
+++ source/utils/aclocal.m4	(working copy)
@@ -1,4 +1,4 @@
-# generated automatically by aclocal 1.16.3 -*- Autoconf -*-
+# generated automatically by aclocal 1.16.2 -*- Autoconf -*-
 
 # Copyright (C) 1996-2020 Free Software Foundation, Inc.
 
@@ -35,7 +35,7 @@
 [am__api_version='1.16'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.16.3], [],
+m4_if([$1], [1.16.2], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -51,7 +51,7 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.16.3])dnl
+[AM_AUTOMAKE_VERSION([1.16.2])dnl
 m4_ifndef([AC_AUTOCONF_VERSION],
   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
 _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])
@@ -739,7 +739,12 @@
 [AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
 AC_REQUIRE_AUX_FILE([missing])dnl
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/utils/configure
===================================================================
--- source/utils/configure	(revision 7398)
+++ source/utils/configure	(working copy)
@@ -4079,7 +4079,12 @@
 program_transform_name=`$as_echo "$program_transform_name" | sed "$ac_script"`
 
 if test x"${MISSING+set}" != xset; then
-  MISSING="\${SHELL} '$am_aux_dir/missing'"
+  case $am_aux_dir in
+  *\ * | *\	*)
+    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
+  *)
+    MISSING="\${SHELL} $am_aux_dir/missing" ;;
+  esac
 fi
 # Use eval to expand $SHELL
 if eval "$MISSING --is-lightweight"; then
Index: source/utils/Makefile.in
===================================================================
--- source/utils/Makefile.in	(revision 7398)
+++ source/utils/Makefile.in	(working copy)
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.16.3 from Makefile.am.
+# Makefile.in generated by automake 1.16.2 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994-2020 Free Software Foundation, Inc.
@@ -235,8 +235,6 @@
 DIST_ARCHIVES = $(distdir).tar.gz
 GZIP_ENV = --best
 DIST_TARGETS = dist-gzip
-# Exists only to be overridden by the user if desired.
-AM_DISTCHECK_DVI_TARGET = dvi
 distuninstallcheck_listfiles = find . -type f -print
 am__distuninstallcheck_listfiles = $(distuninstallcheck_listfiles) \
   | sed 's|^\./|$(prefix)/|' | grep -v '$(infodir)/dir$$'
@@ -662,7 +660,7 @@
 	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	    --srcdir=../.. --prefix="$$dc_install_base" \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) $(AM_DISTCHECK_DVI_TARGET) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
